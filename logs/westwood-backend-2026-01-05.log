2026-01-05 20:03:04.945  INFO [main] [] c.westwood.WestwoodBackendApplication    : Starting WestwoodBackendApplication using Java 17.0.10 with PID 82002 (/Users/baglan/repo/westwood-backend/target/classes started by baglan in /Users/baglan/repo/westwood-backend)
2026-01-05 20:03:05.005 DEBUG [main] [] c.westwood.WestwoodBackendApplication    : Running with Spring Boot v3.3.5, Spring v6.1.14
2026-01-05 20:03:05.005  INFO [main] [] c.westwood.WestwoodBackendApplication    : The following 1 profile is active: "dev"
2026-01-05 20:03:05.247  INFO [main] [] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2026-01-05 20:03:05.270  INFO [main] [] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 19 ms. Found 6 JPA repository interfaces.
2026-01-05 20:03:06.111  INFO [main] [] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-01-05 20:03:06.120  INFO [main] [] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-01-05 20:03:06.120  INFO [main] [] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.31]
2026-01-05 20:03:06.196  INFO [main] [] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2026-01-05 20:03:06.197  INFO [main] [] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1160 ms
2026-01-05 20:03:06.219  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-01-05 20:03:06.307  INFO [main] [] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:devdb user=SA
2026-01-05 20:03:06.308  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-01-05 20:03:06.312  INFO [main] [] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:devdb'
2026-01-05 20:03:06.424  INFO [main] [] org.flywaydb.core.FlywayExecutor         : Database: jdbc:h2:mem:devdb (H2 2.2)
2026-01-05 20:03:06.427  WARN [main] [] o.f.c.internal.database.base.Database    : Flyway upgrade recommended: H2 2.2.224 is newer than this version of Flyway and support has not been tested. The latest supported version of H2 is 2.2.220.
2026-01-05 20:03:06.437  INFO [main] [] o.f.c.i.s.JdbcTableSchemaHistory         : Schema history table "PUBLIC"."flyway_schema_history" does not exist yet
2026-01-05 20:03:06.438  INFO [main] [] o.f.core.internal.command.DbValidate     : Successfully validated 7 migrations (execution time 00:00.007s)
2026-01-05 20:03:06.441  INFO [main] [] o.f.c.i.s.JdbcTableSchemaHistory         : Creating Schema History table "PUBLIC"."flyway_schema_history" ...
2026-01-05 20:03:06.458  INFO [main] [] o.f.core.internal.command.DbMigrate      : Current version of schema "PUBLIC": << Empty Schema >>
2026-01-05 20:03:06.461  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "0 - create clients table"
2026-01-05 20:03:06.473  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "1 - create users table"
2026-01-05 20:03:06.478  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "2 - create payment transactions table"
2026-01-05 20:03:06.484  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "3 - create bonus events table"
2026-01-05 20:03:06.491  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "4 - create bonus configuration table"
2026-01-05 20:03:06.494  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "5 - create event store table"
2026-01-05 20:03:06.512  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "6 - add uuid to clients and users"
2026-01-05 20:03:06.542  INFO [main] [] o.f.core.internal.command.DbMigrate      : Successfully applied 7 migrations to schema "PUBLIC", now at version v6 (execution time 00:00.033s)
2026-01-05 20:03:06.587  INFO [main] [] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2026-01-05 20:03:06.613  INFO [main] [] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.5.3.Final
2026-01-05 20:03:06.630  INFO [main] [] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2026-01-05 20:03:06.787  INFO [main] [] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2026-01-05 20:03:06.817  WARN [main] [] org.hibernate.orm.deprecation            : HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2026-01-05 20:03:06.938  WARN [main] [] o.h.boot.model.internal.EntityBinder     : HHH000457: Joined inheritance hierarchy [com.westwood.domain.BonusEvent] defined explicit @DiscriminatorColumn.  Legacy Hibernate behavior was to ignore the @DiscriminatorColumn.  However, as part of issue HHH-6911 we now apply the explicit @DiscriminatorColumn.  If you would prefer the legacy behavior, enable the `hibernate.discriminator.ignore_explicit_for_joined` setting (hibernate.discriminator.ignore_explicit_for_joined=true)
2026-01-05 20:03:07.314  INFO [main] [] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2026-01-05 20:03:07.329 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists bonus_configurations 
       alter column description set data type TEXT
2026-01-05 20:03:07.330 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists bonus_events 
       alter column event_type set data type varchar(31)
2026-01-05 20:03:07.333 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists client_tags 
       alter column tag set data type varchar(255)
2026-01-05 20:03:07.335 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists clients 
       alter column notes set data type TEXT
2026-01-05 20:03:07.335 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists event_store 
       alter column aggregate_type set data type varchar(255)
2026-01-05 20:03:07.335 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists event_store 
       alter column event_data set data type TEXT
2026-01-05 20:03:07.336 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists payment_transactions 
       alter column notes set data type TEXT
2026-01-05 20:03:07.339 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists clients 
       drop constraint if exists idx_client_uuid
2026-01-05 20:03:07.339 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists clients 
       add constraint idx_client_uuid unique (uuid)
2026-01-05 20:03:07.340 DEBUG [main] [] org.hibernate.SQL                        : 
    create index idx_aggregate_id 
       on event_store (aggregate_id)
2026-01-05 20:03:07.341 DEBUG [main] [] org.hibernate.SQL                        : 
    create index idx_event_type 
       on event_store (event_type)
2026-01-05 20:03:07.341 DEBUG [main] [] org.hibernate.SQL                        : 
    create index idx_timestamp 
       on event_store (timestamp)
2026-01-05 20:03:07.342 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists users 
       drop constraint if exists idx_user_uuid
2026-01-05 20:03:07.343 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists users 
       add constraint idx_user_uuid unique (uuid)
2026-01-05 20:03:07.349  INFO [main] [] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2026-01-05 20:03:07.499 DEBUG [main] [] c.w.security.JwtAuthenticationFilter     : Filter 'jwtAuthenticationFilter' configured for use
2026-01-05 20:03:07.499 DEBUG [main] [] com.westwood.config.RequestIdFilter      : Filter 'requestIdFilter' configured for use
2026-01-05 20:03:07.520  INFO [main] [] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2026-01-05 20:03:07.858  INFO [main] [] eAuthenticationProviderManagerConfigurer : Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2026-01-05 20:03:07.858  WARN [main] [] r$InitializeUserDetailsManagerConfigurer : Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used for username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider.
2026-01-05 20:03:07.908  WARN [main] [] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2026-01-05 20:03:08.032 DEBUG [main] [] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2026-01-05 20:03:08.189  INFO [main] [] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2026-01-05 20:03:08.194  INFO [main] [] c.westwood.WestwoodBackendApplication    : Started WestwoodBackendApplication in 3.598 seconds (process running for 4.035)
2026-01-05 20:03:18.246  INFO [http-nio-8080-exec-2] [] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2026-01-05 20:03:18.247  INFO [http-nio-8080-exec-2] [] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2026-01-05 20:03:18.254  INFO [http-nio-8080-exec-2] [] o.s.web.servlet.DispatcherServlet        : Completed initialization in 7 ms
2026-01-05 20:03:18.295 DEBUG [http-nio-8080-exec-2] [bd1ab91b-3fe7-46d3-a35c-4d5ebcce19aa] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/auth/register
2026-01-05 20:03:18.366 ERROR [http-nio-8080-exec-2] [bd1ab91b-3fe7-46d3-a35c-4d5ebcce19aa] c.w.security.JwtAuthenticationFilter     : Cannot set user authentication: {}

io.jsonwebtoken.ExpiredJwtException: JWT expired 1029302365 milliseconds ago at 2025-12-24T21:08:16.000Z. Current time: 2026-01-05T19:03:18.365Z. Allowed clock skew: 0 milliseconds.
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:682)
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:362)
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:94)
	at io.jsonwebtoken.impl.io.AbstractParser.parse(AbstractParser.java:36)
	at io.jsonwebtoken.impl.io.AbstractParser.parse(AbstractParser.java:29)
	at io.jsonwebtoken.impl.DefaultJwtParser.parseSignedClaims(DefaultJwtParser.java:821)
	at com.westwood.util.jwt.JwtUtil.extractAllClaims(JwtUtil.java:47)
	at com.westwood.util.jwt.JwtUtil.extractClaim(JwtUtil.java:39)
	at com.westwood.util.jwt.JwtUtil.extractUsername(JwtUtil.java:31)
	at com.westwood.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at com.westwood.config.RequestIdFilter.doFilterInternal(RequestIdFilter.java:47)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:384)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:905)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)

2026-01-05 20:03:18.369 DEBUG [http-nio-8080-exec-2] [bd1ab91b-3fe7-46d3-a35c-4d5ebcce19aa] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2026-01-05 20:03:18.370 DEBUG [http-nio-8080-exec-2] [bd1ab91b-3fe7-46d3-a35c-4d5ebcce19aa] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/auth/register
2026-01-05 20:03:18.471 DEBUG [http-nio-8080-exec-2] [bd1ab91b-3fe7-46d3-a35c-4d5ebcce19aa] org.hibernate.SQL                        : 
    select
        u1_0.id 
    from
        users u1_0 
    where
        u1_0.username=? 
    fetch
        first ? rows only
2026-01-05 20:03:18.476 DEBUG [http-nio-8080-exec-2] [bd1ab91b-3fe7-46d3-a35c-4d5ebcce19aa] org.hibernate.SQL                        : 
    select
        u1_0.id 
    from
        users u1_0 
    where
        u1_0.email=? 
    fetch
        first ? rows only
2026-01-05 20:03:18.568 DEBUG [http-nio-8080-exec-2] [bd1ab91b-3fe7-46d3-a35c-4d5ebcce19aa] org.hibernate.SQL                        : 
    insert 
    into
        users
        (active, created_at, email, first_name, last_name, password, updated_at, username, uuid, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:03:18.591 DEBUG [http-nio-8080-exec-2] [bd1ab91b-3fe7-46d3-a35c-4d5ebcce19aa] org.hibernate.SQL                        : 
    insert 
    into
        user_roles
        (user_id, role) 
    values
        (?, ?)
2026-01-05 20:04:25.849 DEBUG [http-nio-8080-exec-5] [1c923f2c-b676-458b-b638-50fee655c1f0] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/users
2026-01-05 20:04:25.851 DEBUG [http-nio-8080-exec-5] [1c923f2c-b676-458b-b638-50fee655c1f0] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2026-01-05 20:04:25.862 DEBUG [http-nio-8080-exec-5] [1c923f2c-b676-458b-b638-50fee655c1f0] o.s.s.w.a.Http403ForbiddenEntryPoint     : Pre-authenticated entry point called. Rejecting access
2026-01-05 20:04:25.874 DEBUG [http-nio-8080-exec-5] [] o.s.security.web.FilterChainProxy        : Securing POST /error
2026-01-05 20:04:25.874 DEBUG [http-nio-8080-exec-5] [] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2026-01-05 20:04:25.875 DEBUG [http-nio-8080-exec-5] [] o.s.s.w.a.Http403ForbiddenEntryPoint     : Pre-authenticated entry point called. Rejecting access
2026-01-05 20:04:30.640 DEBUG [http-nio-8080-exec-6] [1d781431-0328-4994-ba8f-8f2350e569dc] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/auth/login
2026-01-05 20:04:30.641 DEBUG [http-nio-8080-exec-6] [1d781431-0328-4994-ba8f-8f2350e569dc] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2026-01-05 20:04:30.641 DEBUG [http-nio-8080-exec-6] [1d781431-0328-4994-ba8f-8f2350e569dc] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/auth/login
2026-01-05 20:04:30.793 DEBUG [http-nio-8080-exec-6] [1d781431-0328-4994-ba8f-8f2350e569dc] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 20:04:30.798 DEBUG [http-nio-8080-exec-6] [1d781431-0328-4994-ba8f-8f2350e569dc] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 20:04:30.887 DEBUG [http-nio-8080-exec-6] [1d781431-0328-4994-ba8f-8f2350e569dc] o.s.s.a.dao.DaoAuthenticationProvider    : Failed to authenticate since password does not match stored value
2026-01-05 20:04:45.098 DEBUG [http-nio-8080-exec-8] [26aa694c-d902-44cb-9961-246882c75c30] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/auth/login
2026-01-05 20:04:45.103 DEBUG [http-nio-8080-exec-8] [26aa694c-d902-44cb-9961-246882c75c30] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2026-01-05 20:04:45.103 DEBUG [http-nio-8080-exec-8] [26aa694c-d902-44cb-9961-246882c75c30] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/auth/login
2026-01-05 20:04:45.118 DEBUG [http-nio-8080-exec-8] [26aa694c-d902-44cb-9961-246882c75c30] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 20:04:45.120 DEBUG [http-nio-8080-exec-8] [26aa694c-d902-44cb-9961-246882c75c30] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 20:04:45.214 DEBUG [http-nio-8080-exec-8] [26aa694c-d902-44cb-9961-246882c75c30] o.s.s.a.dao.DaoAuthenticationProvider    : Authenticated user
2026-01-05 20:05:00.656 DEBUG [http-nio-8080-exec-9] [67624e6e-2f28-4b30-87df-0aa94a7ae221] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/users
2026-01-05 20:05:00.671 DEBUG [http-nio-8080-exec-9] [67624e6e-2f28-4b30-87df-0aa94a7ae221] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 20:05:00.673 DEBUG [http-nio-8080-exec-9] [67624e6e-2f28-4b30-87df-0aa94a7ae221] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 20:05:00.682 DEBUG [http-nio-8080-exec-9] [67624e6e-2f28-4b30-87df-0aa94a7ae221] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/users
2026-01-05 20:05:00.725 DEBUG [http-nio-8080-exec-9] [67624e6e-2f28-4b30-87df-0aa94a7ae221] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.UserController.createUser(com.westwood.common.dto.CreateUserRequest); target is of class [com.westwood.controller.UserController]
2026-01-05 20:05:00.751 DEBUG [http-nio-8080-exec-9] [67624e6e-2f28-4b30-87df-0aa94a7ae221] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.UserController.createUser(com.westwood.common.dto.CreateUserRequest); target is of class [com.westwood.controller.UserController]
2026-01-05 20:05:00.753 DEBUG [http-nio-8080-exec-9] [67624e6e-2f28-4b30-87df-0aa94a7ae221] org.hibernate.SQL                        : 
    select
        u1_0.id 
    from
        users u1_0 
    where
        u1_0.username=? 
    fetch
        first ? rows only
2026-01-05 20:05:00.754 DEBUG [http-nio-8080-exec-9] [67624e6e-2f28-4b30-87df-0aa94a7ae221] org.hibernate.SQL                        : 
    select
        u1_0.id 
    from
        users u1_0 
    where
        u1_0.email=? 
    fetch
        first ? rows only
2026-01-05 20:06:07.070 DEBUG [http-nio-8080-exec-10] [a124c933-8711-4294-9c07-e0d9406c7bcc] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/clients
2026-01-05 20:06:07.114 DEBUG [http-nio-8080-exec-10] [a124c933-8711-4294-9c07-e0d9406c7bcc] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 20:06:07.125 DEBUG [http-nio-8080-exec-10] [a124c933-8711-4294-9c07-e0d9406c7bcc] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 20:06:07.140 DEBUG [http-nio-8080-exec-10] [a124c933-8711-4294-9c07-e0d9406c7bcc] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/clients
2026-01-05 20:06:07.153 DEBUG [http-nio-8080-exec-10] [a124c933-8711-4294-9c07-e0d9406c7bcc] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.ClientController.createClient(com.westwood.common.dto.CreateClientRequest); target is of class [com.westwood.controller.ClientController]
2026-01-05 20:06:07.154 DEBUG [http-nio-8080-exec-10] [a124c933-8711-4294-9c07-e0d9406c7bcc] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.ClientController.createClient(com.westwood.common.dto.CreateClientRequest); target is of class [com.westwood.controller.ClientController]
2026-01-05 20:06:07.156 DEBUG [http-nio-8080-exec-10] [a124c933-8711-4294-9c07-e0d9406c7bcc] org.hibernate.SQL                        : 
    select
        c1_0.id 
    from
        clients c1_0 
    where
        c1_0.phone=? 
    fetch
        first ? rows only
2026-01-05 20:06:07.160 DEBUG [http-nio-8080-exec-10] [a124c933-8711-4294-9c07-e0d9406c7bcc] org.hibernate.SQL                        : 
    insert 
    into
        clients
        (client_type, created_at, name, notes, phone, surname, updated_at, uuid, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:07.162 DEBUG [http-nio-8080-exec-10] [a124c933-8711-4294-9c07-e0d9406c7bcc] org.hibernate.SQL                        : 
    insert 
    into
        client_tags
        (client_id, tag) 
    values
        (?, ?)
2026-01-05 20:06:07.162 DEBUG [http-nio-8080-exec-10] [a124c933-8711-4294-9c07-e0d9406c7bcc] org.hibernate.SQL                        : 
    insert 
    into
        client_tags
        (client_id, tag) 
    values
        (?, ?)
2026-01-05 20:06:24.847 DEBUG [http-nio-8080-exec-2] [b7a3ef53-f19b-46ab-a5d1-50fda1f8f208] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/payments
2026-01-05 20:06:24.856 DEBUG [http-nio-8080-exec-2] [b7a3ef53-f19b-46ab-a5d1-50fda1f8f208] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 20:06:24.862 DEBUG [http-nio-8080-exec-2] [b7a3ef53-f19b-46ab-a5d1-50fda1f8f208] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 20:06:24.865 DEBUG [http-nio-8080-exec-2] [b7a3ef53-f19b-46ab-a5d1-50fda1f8f208] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/payments
2026-01-05 20:06:24.888 DEBUG [http-nio-8080-exec-2] [b7a3ef53-f19b-46ab-a5d1-50fda1f8f208] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 20:06:24.890 DEBUG [http-nio-8080-exec-2] [b7a3ef53-f19b-46ab-a5d1-50fda1f8f208] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 20:06:24.893 DEBUG [http-nio-8080-exec-2] [b7a3ef53-f19b-46ab-a5d1-50fda1f8f208] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 20:06:24.896 DEBUG [http-nio-8080-exec-2] [b7a3ef53-f19b-46ab-a5d1-50fda1f8f208] org.hibernate.SQL                        : 
    select
        t1_0.client_id,
        t1_0.tag 
    from
        client_tags t1_0 
    where
        t1_0.client_id=?
2026-01-05 20:06:24.910 DEBUG [http-nio-8080-exec-2] [b7a3ef53-f19b-46ab-a5d1-50fda1f8f208] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        r1_0.user_id,
        r1_0.role,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    left join
        user_roles r1_0 
            on u1_0.id=r1_0.user_id 
    where
        u1_0.id=?
2026-01-05 20:06:24.914 DEBUG [http-nio-8080-exec-2] [b7a3ef53-f19b-46ab-a5d1-50fda1f8f208] org.hibernate.SQL                        : 
    insert 
    into
        payment_transactions
        (amount, client_id, created_at, entered_by_user_id, notes, status, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:24.928 DEBUG [http-nio-8080-exec-2] [b7a3ef53-f19b-46ab-a5d1-50fda1f8f208] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:24.940 DEBUG [http-nio-8080-exec-2] [b7a3ef53-f19b-46ab-a5d1-50fda1f8f208] org.hibernate.SQL                        : 
    select
        bc1_0.id,
        bc1_0.active,
        bc1_0.bonus_percentage,
        bc1_0.created_at,
        bc1_0.description,
        bc1_0.effective_from,
        bc1_0.effective_to,
        bc1_0.updated_at,
        bc1_0.version 
    from
        bonus_configurations bc1_0 
    where
        bc1_0.active=true 
        and (
            bc1_0.effective_to is null 
            or bc1_0.effective_to>?
        ) 
    order by
        bc1_0.effective_from desc
2026-01-05 20:06:34.907 DEBUG [http-nio-8080-exec-3] [943d0130-4985-4cbc-8322-c7eba4e96016] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/bonus-configuration?bonusPercentage=5.0
2026-01-05 20:06:34.929 DEBUG [http-nio-8080-exec-3] [943d0130-4985-4cbc-8322-c7eba4e96016] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 20:06:34.936 DEBUG [http-nio-8080-exec-3] [943d0130-4985-4cbc-8322-c7eba4e96016] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 20:06:34.955 DEBUG [http-nio-8080-exec-3] [943d0130-4985-4cbc-8322-c7eba4e96016] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/bonus-configuration?bonusPercentage=5.0
2026-01-05 20:06:34.997 DEBUG [http-nio-8080-exec-3] [943d0130-4985-4cbc-8322-c7eba4e96016] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.BonusConfigurationController.createConfiguration(java.math.BigDecimal,java.lang.String); target is of class [com.westwood.controller.BonusConfigurationController]
2026-01-05 20:06:34.998 DEBUG [http-nio-8080-exec-3] [943d0130-4985-4cbc-8322-c7eba4e96016] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.BonusConfigurationController.createConfiguration(java.math.BigDecimal,java.lang.String); target is of class [com.westwood.controller.BonusConfigurationController]
2026-01-05 20:06:35.014 DEBUG [http-nio-8080-exec-3] [943d0130-4985-4cbc-8322-c7eba4e96016] org.hibernate.SQL                        : 
    select
        bc1_0.id,
        bc1_0.active,
        bc1_0.bonus_percentage,
        bc1_0.created_at,
        bc1_0.description,
        bc1_0.effective_from,
        bc1_0.effective_to,
        bc1_0.updated_at,
        bc1_0.version 
    from
        bonus_configurations bc1_0
2026-01-05 20:06:35.036 DEBUG [http-nio-8080-exec-3] [943d0130-4985-4cbc-8322-c7eba4e96016] org.hibernate.SQL                        : 
    insert 
    into
        bonus_configurations
        (active, bonus_percentage, created_at, description, effective_from, effective_to, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:39.343 DEBUG [http-nio-8080-exec-4] [be1fbe55-d7e6-445b-801b-3f68895db880] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/payments
2026-01-05 20:06:39.363 DEBUG [http-nio-8080-exec-4] [be1fbe55-d7e6-445b-801b-3f68895db880] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 20:06:39.365 DEBUG [http-nio-8080-exec-4] [be1fbe55-d7e6-445b-801b-3f68895db880] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 20:06:39.369 DEBUG [http-nio-8080-exec-4] [be1fbe55-d7e6-445b-801b-3f68895db880] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/payments
2026-01-05 20:06:39.374 DEBUG [http-nio-8080-exec-4] [be1fbe55-d7e6-445b-801b-3f68895db880] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 20:06:39.375 DEBUG [http-nio-8080-exec-4] [be1fbe55-d7e6-445b-801b-3f68895db880] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 20:06:39.378 DEBUG [http-nio-8080-exec-4] [be1fbe55-d7e6-445b-801b-3f68895db880] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 20:06:39.380 DEBUG [http-nio-8080-exec-4] [be1fbe55-d7e6-445b-801b-3f68895db880] org.hibernate.SQL                        : 
    select
        t1_0.client_id,
        t1_0.tag 
    from
        client_tags t1_0 
    where
        t1_0.client_id=?
2026-01-05 20:06:39.381 DEBUG [http-nio-8080-exec-4] [be1fbe55-d7e6-445b-801b-3f68895db880] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        r1_0.user_id,
        r1_0.role,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    left join
        user_roles r1_0 
            on u1_0.id=r1_0.user_id 
    where
        u1_0.id=?
2026-01-05 20:06:39.383 DEBUG [http-nio-8080-exec-4] [be1fbe55-d7e6-445b-801b-3f68895db880] org.hibernate.SQL                        : 
    insert 
    into
        payment_transactions
        (amount, client_id, created_at, entered_by_user_id, notes, status, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:39.386 DEBUG [http-nio-8080-exec-4] [be1fbe55-d7e6-445b-801b-3f68895db880] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:39.391 DEBUG [http-nio-8080-exec-4] [be1fbe55-d7e6-445b-801b-3f68895db880] org.hibernate.SQL                        : 
    select
        bc1_0.id,
        bc1_0.active,
        bc1_0.bonus_percentage,
        bc1_0.created_at,
        bc1_0.description,
        bc1_0.effective_from,
        bc1_0.effective_to,
        bc1_0.updated_at,
        bc1_0.version 
    from
        bonus_configurations bc1_0 
    where
        bc1_0.active=true 
        and (
            bc1_0.effective_to is null 
            or bc1_0.effective_to>?
        ) 
    order by
        bc1_0.effective_from desc
2026-01-05 20:06:39.407 DEBUG [http-nio-8080-exec-4] [be1fbe55-d7e6-445b-801b-3f68895db880] org.hibernate.SQL                        : 
    insert 
    into
        bonus_events
        (bonus_amount, client_id, created_at, event_id, updated_at, version, event_type, id) 
    values
        (?, ?, ?, ?, ?, ?, 'GRANTED', default)
2026-01-05 20:06:39.410 DEBUG [http-nio-8080-exec-4] [be1fbe55-d7e6-445b-801b-3f68895db880] org.hibernate.SQL                        : 
    insert 
    into
        bonus_granted
        (bonus_percentage, payment_amount, payment_transaction_id, id) 
    values
        (?, ?, ?, ?)
2026-01-05 20:06:39.412 DEBUG [http-nio-8080-exec-4] [be1fbe55-d7e6-445b-801b-3f68895db880] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:40.184 DEBUG [http-nio-8080-exec-5] [e56e0ee5-8f08-406a-bd74-22fc0bf067d5] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/payments
2026-01-05 20:06:40.188 DEBUG [http-nio-8080-exec-5] [e56e0ee5-8f08-406a-bd74-22fc0bf067d5] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 20:06:40.189 DEBUG [http-nio-8080-exec-5] [e56e0ee5-8f08-406a-bd74-22fc0bf067d5] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 20:06:40.193 DEBUG [http-nio-8080-exec-5] [e56e0ee5-8f08-406a-bd74-22fc0bf067d5] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/payments
2026-01-05 20:06:40.197 DEBUG [http-nio-8080-exec-5] [e56e0ee5-8f08-406a-bd74-22fc0bf067d5] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 20:06:40.198 DEBUG [http-nio-8080-exec-5] [e56e0ee5-8f08-406a-bd74-22fc0bf067d5] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 20:06:40.201 DEBUG [http-nio-8080-exec-5] [e56e0ee5-8f08-406a-bd74-22fc0bf067d5] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 20:06:40.202 DEBUG [http-nio-8080-exec-5] [e56e0ee5-8f08-406a-bd74-22fc0bf067d5] org.hibernate.SQL                        : 
    select
        t1_0.client_id,
        t1_0.tag 
    from
        client_tags t1_0 
    where
        t1_0.client_id=?
2026-01-05 20:06:40.205 DEBUG [http-nio-8080-exec-5] [e56e0ee5-8f08-406a-bd74-22fc0bf067d5] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        r1_0.user_id,
        r1_0.role,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    left join
        user_roles r1_0 
            on u1_0.id=r1_0.user_id 
    where
        u1_0.id=?
2026-01-05 20:06:40.207 DEBUG [http-nio-8080-exec-5] [e56e0ee5-8f08-406a-bd74-22fc0bf067d5] org.hibernate.SQL                        : 
    insert 
    into
        payment_transactions
        (amount, client_id, created_at, entered_by_user_id, notes, status, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:40.209 DEBUG [http-nio-8080-exec-5] [e56e0ee5-8f08-406a-bd74-22fc0bf067d5] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:40.210 DEBUG [http-nio-8080-exec-5] [e56e0ee5-8f08-406a-bd74-22fc0bf067d5] org.hibernate.SQL                        : 
    select
        bc1_0.id,
        bc1_0.active,
        bc1_0.bonus_percentage,
        bc1_0.created_at,
        bc1_0.description,
        bc1_0.effective_from,
        bc1_0.effective_to,
        bc1_0.updated_at,
        bc1_0.version 
    from
        bonus_configurations bc1_0 
    where
        bc1_0.active=true 
        and (
            bc1_0.effective_to is null 
            or bc1_0.effective_to>?
        ) 
    order by
        bc1_0.effective_from desc
2026-01-05 20:06:40.211 DEBUG [http-nio-8080-exec-5] [e56e0ee5-8f08-406a-bd74-22fc0bf067d5] org.hibernate.SQL                        : 
    insert 
    into
        bonus_events
        (bonus_amount, client_id, created_at, event_id, updated_at, version, event_type, id) 
    values
        (?, ?, ?, ?, ?, ?, 'GRANTED', default)
2026-01-05 20:06:40.212 DEBUG [http-nio-8080-exec-5] [e56e0ee5-8f08-406a-bd74-22fc0bf067d5] org.hibernate.SQL                        : 
    insert 
    into
        bonus_granted
        (bonus_percentage, payment_amount, payment_transaction_id, id) 
    values
        (?, ?, ?, ?)
2026-01-05 20:06:40.215 DEBUG [http-nio-8080-exec-5] [e56e0ee5-8f08-406a-bd74-22fc0bf067d5] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:40.695 DEBUG [http-nio-8080-exec-6] [7873b49d-c33a-4b81-8736-991e59d80e04] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/payments
2026-01-05 20:06:40.698 DEBUG [http-nio-8080-exec-6] [7873b49d-c33a-4b81-8736-991e59d80e04] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 20:06:40.700 DEBUG [http-nio-8080-exec-6] [7873b49d-c33a-4b81-8736-991e59d80e04] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 20:06:40.703 DEBUG [http-nio-8080-exec-6] [7873b49d-c33a-4b81-8736-991e59d80e04] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/payments
2026-01-05 20:06:40.704 DEBUG [http-nio-8080-exec-6] [7873b49d-c33a-4b81-8736-991e59d80e04] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 20:06:40.705 DEBUG [http-nio-8080-exec-6] [7873b49d-c33a-4b81-8736-991e59d80e04] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 20:06:40.708 DEBUG [http-nio-8080-exec-6] [7873b49d-c33a-4b81-8736-991e59d80e04] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 20:06:40.710 DEBUG [http-nio-8080-exec-6] [7873b49d-c33a-4b81-8736-991e59d80e04] org.hibernate.SQL                        : 
    select
        t1_0.client_id,
        t1_0.tag 
    from
        client_tags t1_0 
    where
        t1_0.client_id=?
2026-01-05 20:06:40.712 DEBUG [http-nio-8080-exec-6] [7873b49d-c33a-4b81-8736-991e59d80e04] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        r1_0.user_id,
        r1_0.role,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    left join
        user_roles r1_0 
            on u1_0.id=r1_0.user_id 
    where
        u1_0.id=?
2026-01-05 20:06:40.714 DEBUG [http-nio-8080-exec-6] [7873b49d-c33a-4b81-8736-991e59d80e04] org.hibernate.SQL                        : 
    insert 
    into
        payment_transactions
        (amount, client_id, created_at, entered_by_user_id, notes, status, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:40.718 DEBUG [http-nio-8080-exec-6] [7873b49d-c33a-4b81-8736-991e59d80e04] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:40.719 DEBUG [http-nio-8080-exec-6] [7873b49d-c33a-4b81-8736-991e59d80e04] org.hibernate.SQL                        : 
    select
        bc1_0.id,
        bc1_0.active,
        bc1_0.bonus_percentage,
        bc1_0.created_at,
        bc1_0.description,
        bc1_0.effective_from,
        bc1_0.effective_to,
        bc1_0.updated_at,
        bc1_0.version 
    from
        bonus_configurations bc1_0 
    where
        bc1_0.active=true 
        and (
            bc1_0.effective_to is null 
            or bc1_0.effective_to>?
        ) 
    order by
        bc1_0.effective_from desc
2026-01-05 20:06:40.720 DEBUG [http-nio-8080-exec-6] [7873b49d-c33a-4b81-8736-991e59d80e04] org.hibernate.SQL                        : 
    insert 
    into
        bonus_events
        (bonus_amount, client_id, created_at, event_id, updated_at, version, event_type, id) 
    values
        (?, ?, ?, ?, ?, ?, 'GRANTED', default)
2026-01-05 20:06:40.721 DEBUG [http-nio-8080-exec-6] [7873b49d-c33a-4b81-8736-991e59d80e04] org.hibernate.SQL                        : 
    insert 
    into
        bonus_granted
        (bonus_percentage, payment_amount, payment_transaction_id, id) 
    values
        (?, ?, ?, ?)
2026-01-05 20:06:40.722 DEBUG [http-nio-8080-exec-6] [7873b49d-c33a-4b81-8736-991e59d80e04] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:41.022 DEBUG [http-nio-8080-exec-7] [7f026791-9f0c-4355-b2f8-d208958e7876] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/payments
2026-01-05 20:06:41.024 DEBUG [http-nio-8080-exec-7] [7f026791-9f0c-4355-b2f8-d208958e7876] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 20:06:41.025 DEBUG [http-nio-8080-exec-7] [7f026791-9f0c-4355-b2f8-d208958e7876] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 20:06:41.026 DEBUG [http-nio-8080-exec-7] [7f026791-9f0c-4355-b2f8-d208958e7876] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/payments
2026-01-05 20:06:41.027 DEBUG [http-nio-8080-exec-7] [7f026791-9f0c-4355-b2f8-d208958e7876] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 20:06:41.027 DEBUG [http-nio-8080-exec-7] [7f026791-9f0c-4355-b2f8-d208958e7876] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 20:06:41.028 DEBUG [http-nio-8080-exec-7] [7f026791-9f0c-4355-b2f8-d208958e7876] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 20:06:41.029 DEBUG [http-nio-8080-exec-7] [7f026791-9f0c-4355-b2f8-d208958e7876] org.hibernate.SQL                        : 
    select
        t1_0.client_id,
        t1_0.tag 
    from
        client_tags t1_0 
    where
        t1_0.client_id=?
2026-01-05 20:06:41.030 DEBUG [http-nio-8080-exec-7] [7f026791-9f0c-4355-b2f8-d208958e7876] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        r1_0.user_id,
        r1_0.role,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    left join
        user_roles r1_0 
            on u1_0.id=r1_0.user_id 
    where
        u1_0.id=?
2026-01-05 20:06:41.031 DEBUG [http-nio-8080-exec-7] [7f026791-9f0c-4355-b2f8-d208958e7876] org.hibernate.SQL                        : 
    insert 
    into
        payment_transactions
        (amount, client_id, created_at, entered_by_user_id, notes, status, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:41.032 DEBUG [http-nio-8080-exec-7] [7f026791-9f0c-4355-b2f8-d208958e7876] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:41.033 DEBUG [http-nio-8080-exec-7] [7f026791-9f0c-4355-b2f8-d208958e7876] org.hibernate.SQL                        : 
    select
        bc1_0.id,
        bc1_0.active,
        bc1_0.bonus_percentage,
        bc1_0.created_at,
        bc1_0.description,
        bc1_0.effective_from,
        bc1_0.effective_to,
        bc1_0.updated_at,
        bc1_0.version 
    from
        bonus_configurations bc1_0 
    where
        bc1_0.active=true 
        and (
            bc1_0.effective_to is null 
            or bc1_0.effective_to>?
        ) 
    order by
        bc1_0.effective_from desc
2026-01-05 20:06:41.034 DEBUG [http-nio-8080-exec-7] [7f026791-9f0c-4355-b2f8-d208958e7876] org.hibernate.SQL                        : 
    insert 
    into
        bonus_events
        (bonus_amount, client_id, created_at, event_id, updated_at, version, event_type, id) 
    values
        (?, ?, ?, ?, ?, ?, 'GRANTED', default)
2026-01-05 20:06:41.035 DEBUG [http-nio-8080-exec-7] [7f026791-9f0c-4355-b2f8-d208958e7876] org.hibernate.SQL                        : 
    insert 
    into
        bonus_granted
        (bonus_percentage, payment_amount, payment_transaction_id, id) 
    values
        (?, ?, ?, ?)
2026-01-05 20:06:41.035 DEBUG [http-nio-8080-exec-7] [7f026791-9f0c-4355-b2f8-d208958e7876] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:41.346 DEBUG [http-nio-8080-exec-8] [3e37983d-e337-4237-8d15-8ba087b5da31] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/payments
2026-01-05 20:06:41.350 DEBUG [http-nio-8080-exec-8] [3e37983d-e337-4237-8d15-8ba087b5da31] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 20:06:41.353 DEBUG [http-nio-8080-exec-8] [3e37983d-e337-4237-8d15-8ba087b5da31] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 20:06:41.356 DEBUG [http-nio-8080-exec-8] [3e37983d-e337-4237-8d15-8ba087b5da31] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/payments
2026-01-05 20:06:41.360 DEBUG [http-nio-8080-exec-8] [3e37983d-e337-4237-8d15-8ba087b5da31] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 20:06:41.361 DEBUG [http-nio-8080-exec-8] [3e37983d-e337-4237-8d15-8ba087b5da31] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 20:06:41.363 DEBUG [http-nio-8080-exec-8] [3e37983d-e337-4237-8d15-8ba087b5da31] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 20:06:41.364 DEBUG [http-nio-8080-exec-8] [3e37983d-e337-4237-8d15-8ba087b5da31] org.hibernate.SQL                        : 
    select
        t1_0.client_id,
        t1_0.tag 
    from
        client_tags t1_0 
    where
        t1_0.client_id=?
2026-01-05 20:06:41.367 DEBUG [http-nio-8080-exec-8] [3e37983d-e337-4237-8d15-8ba087b5da31] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        r1_0.user_id,
        r1_0.role,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    left join
        user_roles r1_0 
            on u1_0.id=r1_0.user_id 
    where
        u1_0.id=?
2026-01-05 20:06:41.369 DEBUG [http-nio-8080-exec-8] [3e37983d-e337-4237-8d15-8ba087b5da31] org.hibernate.SQL                        : 
    insert 
    into
        payment_transactions
        (amount, client_id, created_at, entered_by_user_id, notes, status, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:41.370 DEBUG [http-nio-8080-exec-8] [3e37983d-e337-4237-8d15-8ba087b5da31] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:41.371 DEBUG [http-nio-8080-exec-8] [3e37983d-e337-4237-8d15-8ba087b5da31] org.hibernate.SQL                        : 
    select
        bc1_0.id,
        bc1_0.active,
        bc1_0.bonus_percentage,
        bc1_0.created_at,
        bc1_0.description,
        bc1_0.effective_from,
        bc1_0.effective_to,
        bc1_0.updated_at,
        bc1_0.version 
    from
        bonus_configurations bc1_0 
    where
        bc1_0.active=true 
        and (
            bc1_0.effective_to is null 
            or bc1_0.effective_to>?
        ) 
    order by
        bc1_0.effective_from desc
2026-01-05 20:06:41.372 DEBUG [http-nio-8080-exec-8] [3e37983d-e337-4237-8d15-8ba087b5da31] org.hibernate.SQL                        : 
    insert 
    into
        bonus_events
        (bonus_amount, client_id, created_at, event_id, updated_at, version, event_type, id) 
    values
        (?, ?, ?, ?, ?, ?, 'GRANTED', default)
2026-01-05 20:06:41.373 DEBUG [http-nio-8080-exec-8] [3e37983d-e337-4237-8d15-8ba087b5da31] org.hibernate.SQL                        : 
    insert 
    into
        bonus_granted
        (bonus_percentage, payment_amount, payment_transaction_id, id) 
    values
        (?, ?, ?, ?)
2026-01-05 20:06:41.374 DEBUG [http-nio-8080-exec-8] [3e37983d-e337-4237-8d15-8ba087b5da31] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:41.894 DEBUG [http-nio-8080-exec-9] [2c6f6eca-0846-4926-9426-e0590df3c926] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/payments
2026-01-05 20:06:41.901 DEBUG [http-nio-8080-exec-9] [2c6f6eca-0846-4926-9426-e0590df3c926] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 20:06:41.904 DEBUG [http-nio-8080-exec-9] [2c6f6eca-0846-4926-9426-e0590df3c926] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 20:06:41.907 DEBUG [http-nio-8080-exec-9] [2c6f6eca-0846-4926-9426-e0590df3c926] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/payments
2026-01-05 20:06:41.911 DEBUG [http-nio-8080-exec-9] [2c6f6eca-0846-4926-9426-e0590df3c926] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 20:06:41.912 DEBUG [http-nio-8080-exec-9] [2c6f6eca-0846-4926-9426-e0590df3c926] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 20:06:41.913 DEBUG [http-nio-8080-exec-9] [2c6f6eca-0846-4926-9426-e0590df3c926] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 20:06:41.915 DEBUG [http-nio-8080-exec-9] [2c6f6eca-0846-4926-9426-e0590df3c926] org.hibernate.SQL                        : 
    select
        t1_0.client_id,
        t1_0.tag 
    from
        client_tags t1_0 
    where
        t1_0.client_id=?
2026-01-05 20:06:41.918 DEBUG [http-nio-8080-exec-9] [2c6f6eca-0846-4926-9426-e0590df3c926] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        r1_0.user_id,
        r1_0.role,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    left join
        user_roles r1_0 
            on u1_0.id=r1_0.user_id 
    where
        u1_0.id=?
2026-01-05 20:06:41.919 DEBUG [http-nio-8080-exec-9] [2c6f6eca-0846-4926-9426-e0590df3c926] org.hibernate.SQL                        : 
    insert 
    into
        payment_transactions
        (amount, client_id, created_at, entered_by_user_id, notes, status, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:41.920 DEBUG [http-nio-8080-exec-9] [2c6f6eca-0846-4926-9426-e0590df3c926] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:41.921 DEBUG [http-nio-8080-exec-9] [2c6f6eca-0846-4926-9426-e0590df3c926] org.hibernate.SQL                        : 
    select
        bc1_0.id,
        bc1_0.active,
        bc1_0.bonus_percentage,
        bc1_0.created_at,
        bc1_0.description,
        bc1_0.effective_from,
        bc1_0.effective_to,
        bc1_0.updated_at,
        bc1_0.version 
    from
        bonus_configurations bc1_0 
    where
        bc1_0.active=true 
        and (
            bc1_0.effective_to is null 
            or bc1_0.effective_to>?
        ) 
    order by
        bc1_0.effective_from desc
2026-01-05 20:06:41.922 DEBUG [http-nio-8080-exec-9] [2c6f6eca-0846-4926-9426-e0590df3c926] org.hibernate.SQL                        : 
    insert 
    into
        bonus_events
        (bonus_amount, client_id, created_at, event_id, updated_at, version, event_type, id) 
    values
        (?, ?, ?, ?, ?, ?, 'GRANTED', default)
2026-01-05 20:06:41.922 DEBUG [http-nio-8080-exec-9] [2c6f6eca-0846-4926-9426-e0590df3c926] org.hibernate.SQL                        : 
    insert 
    into
        bonus_granted
        (bonus_percentage, payment_amount, payment_transaction_id, id) 
    values
        (?, ?, ?, ?)
2026-01-05 20:06:41.923 DEBUG [http-nio-8080-exec-9] [2c6f6eca-0846-4926-9426-e0590df3c926] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:43.415 DEBUG [http-nio-8080-exec-1] [ccbfe471-4f16-4e0e-936b-438371e845b8] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/payments
2026-01-05 20:06:43.420 DEBUG [http-nio-8080-exec-1] [ccbfe471-4f16-4e0e-936b-438371e845b8] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 20:06:43.422 DEBUG [http-nio-8080-exec-1] [ccbfe471-4f16-4e0e-936b-438371e845b8] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 20:06:43.431 DEBUG [http-nio-8080-exec-1] [ccbfe471-4f16-4e0e-936b-438371e845b8] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/payments
2026-01-05 20:06:43.433 DEBUG [http-nio-8080-exec-1] [ccbfe471-4f16-4e0e-936b-438371e845b8] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 20:06:43.433 DEBUG [http-nio-8080-exec-1] [ccbfe471-4f16-4e0e-936b-438371e845b8] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 20:06:43.435 DEBUG [http-nio-8080-exec-1] [ccbfe471-4f16-4e0e-936b-438371e845b8] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 20:06:43.438 DEBUG [http-nio-8080-exec-1] [ccbfe471-4f16-4e0e-936b-438371e845b8] org.hibernate.SQL                        : 
    select
        t1_0.client_id,
        t1_0.tag 
    from
        client_tags t1_0 
    where
        t1_0.client_id=?
2026-01-05 20:06:43.438 DEBUG [http-nio-8080-exec-1] [ccbfe471-4f16-4e0e-936b-438371e845b8] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        r1_0.user_id,
        r1_0.role,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    left join
        user_roles r1_0 
            on u1_0.id=r1_0.user_id 
    where
        u1_0.id=?
2026-01-05 20:06:43.439 DEBUG [http-nio-8080-exec-1] [ccbfe471-4f16-4e0e-936b-438371e845b8] org.hibernate.SQL                        : 
    insert 
    into
        payment_transactions
        (amount, client_id, created_at, entered_by_user_id, notes, status, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:43.441 DEBUG [http-nio-8080-exec-1] [ccbfe471-4f16-4e0e-936b-438371e845b8] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:43.442 DEBUG [http-nio-8080-exec-1] [ccbfe471-4f16-4e0e-936b-438371e845b8] org.hibernate.SQL                        : 
    select
        bc1_0.id,
        bc1_0.active,
        bc1_0.bonus_percentage,
        bc1_0.created_at,
        bc1_0.description,
        bc1_0.effective_from,
        bc1_0.effective_to,
        bc1_0.updated_at,
        bc1_0.version 
    from
        bonus_configurations bc1_0 
    where
        bc1_0.active=true 
        and (
            bc1_0.effective_to is null 
            or bc1_0.effective_to>?
        ) 
    order by
        bc1_0.effective_from desc
2026-01-05 20:06:43.444 DEBUG [http-nio-8080-exec-1] [ccbfe471-4f16-4e0e-936b-438371e845b8] org.hibernate.SQL                        : 
    insert 
    into
        bonus_events
        (bonus_amount, client_id, created_at, event_id, updated_at, version, event_type, id) 
    values
        (?, ?, ?, ?, ?, ?, 'GRANTED', default)
2026-01-05 20:06:43.444 DEBUG [http-nio-8080-exec-1] [ccbfe471-4f16-4e0e-936b-438371e845b8] org.hibernate.SQL                        : 
    insert 
    into
        bonus_granted
        (bonus_percentage, payment_amount, payment_transaction_id, id) 
    values
        (?, ?, ?, ?)
2026-01-05 20:06:43.445 DEBUG [http-nio-8080-exec-1] [ccbfe471-4f16-4e0e-936b-438371e845b8] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:44.887 DEBUG [http-nio-8080-exec-10] [44d5d2d1-ff01-4452-b9e4-39d4243ca2e9] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/payments
2026-01-05 20:06:44.891 DEBUG [http-nio-8080-exec-10] [44d5d2d1-ff01-4452-b9e4-39d4243ca2e9] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 20:06:44.894 DEBUG [http-nio-8080-exec-10] [44d5d2d1-ff01-4452-b9e4-39d4243ca2e9] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 20:06:44.904 DEBUG [http-nio-8080-exec-10] [44d5d2d1-ff01-4452-b9e4-39d4243ca2e9] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/payments
2026-01-05 20:06:44.906 DEBUG [http-nio-8080-exec-10] [44d5d2d1-ff01-4452-b9e4-39d4243ca2e9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 20:06:44.906 DEBUG [http-nio-8080-exec-10] [44d5d2d1-ff01-4452-b9e4-39d4243ca2e9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 20:06:44.908 DEBUG [http-nio-8080-exec-10] [44d5d2d1-ff01-4452-b9e4-39d4243ca2e9] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 20:06:44.909 DEBUG [http-nio-8080-exec-10] [44d5d2d1-ff01-4452-b9e4-39d4243ca2e9] org.hibernate.SQL                        : 
    select
        t1_0.client_id,
        t1_0.tag 
    from
        client_tags t1_0 
    where
        t1_0.client_id=?
2026-01-05 20:06:44.916 DEBUG [http-nio-8080-exec-10] [44d5d2d1-ff01-4452-b9e4-39d4243ca2e9] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        r1_0.user_id,
        r1_0.role,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    left join
        user_roles r1_0 
            on u1_0.id=r1_0.user_id 
    where
        u1_0.id=?
2026-01-05 20:06:44.922 DEBUG [http-nio-8080-exec-10] [44d5d2d1-ff01-4452-b9e4-39d4243ca2e9] org.hibernate.SQL                        : 
    insert 
    into
        payment_transactions
        (amount, client_id, created_at, entered_by_user_id, notes, status, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:44.987 DEBUG [http-nio-8080-exec-10] [44d5d2d1-ff01-4452-b9e4-39d4243ca2e9] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:44.990 DEBUG [http-nio-8080-exec-10] [44d5d2d1-ff01-4452-b9e4-39d4243ca2e9] org.hibernate.SQL                        : 
    select
        bc1_0.id,
        bc1_0.active,
        bc1_0.bonus_percentage,
        bc1_0.created_at,
        bc1_0.description,
        bc1_0.effective_from,
        bc1_0.effective_to,
        bc1_0.updated_at,
        bc1_0.version 
    from
        bonus_configurations bc1_0 
    where
        bc1_0.active=true 
        and (
            bc1_0.effective_to is null 
            or bc1_0.effective_to>?
        ) 
    order by
        bc1_0.effective_from desc
2026-01-05 20:06:44.991 DEBUG [http-nio-8080-exec-10] [44d5d2d1-ff01-4452-b9e4-39d4243ca2e9] org.hibernate.SQL                        : 
    insert 
    into
        bonus_events
        (bonus_amount, client_id, created_at, event_id, updated_at, version, event_type, id) 
    values
        (?, ?, ?, ?, ?, ?, 'GRANTED', default)
2026-01-05 20:06:44.992 DEBUG [http-nio-8080-exec-10] [44d5d2d1-ff01-4452-b9e4-39d4243ca2e9] org.hibernate.SQL                        : 
    insert 
    into
        bonus_granted
        (bonus_percentage, payment_amount, payment_transaction_id, id) 
    values
        (?, ?, ?, ?)
2026-01-05 20:06:44.993 DEBUG [http-nio-8080-exec-10] [44d5d2d1-ff01-4452-b9e4-39d4243ca2e9] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:45.487 DEBUG [http-nio-8080-exec-2] [aedb4099-badf-4651-acec-cbf40c911e5a] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/payments
2026-01-05 20:06:45.493 DEBUG [http-nio-8080-exec-2] [aedb4099-badf-4651-acec-cbf40c911e5a] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 20:06:45.495 DEBUG [http-nio-8080-exec-2] [aedb4099-badf-4651-acec-cbf40c911e5a] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 20:06:45.500 DEBUG [http-nio-8080-exec-2] [aedb4099-badf-4651-acec-cbf40c911e5a] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/payments
2026-01-05 20:06:45.503 DEBUG [http-nio-8080-exec-2] [aedb4099-badf-4651-acec-cbf40c911e5a] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 20:06:45.504 DEBUG [http-nio-8080-exec-2] [aedb4099-badf-4651-acec-cbf40c911e5a] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 20:06:45.505 DEBUG [http-nio-8080-exec-2] [aedb4099-badf-4651-acec-cbf40c911e5a] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 20:06:45.508 DEBUG [http-nio-8080-exec-2] [aedb4099-badf-4651-acec-cbf40c911e5a] org.hibernate.SQL                        : 
    select
        t1_0.client_id,
        t1_0.tag 
    from
        client_tags t1_0 
    where
        t1_0.client_id=?
2026-01-05 20:06:45.509 DEBUG [http-nio-8080-exec-2] [aedb4099-badf-4651-acec-cbf40c911e5a] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        r1_0.user_id,
        r1_0.role,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    left join
        user_roles r1_0 
            on u1_0.id=r1_0.user_id 
    where
        u1_0.id=?
2026-01-05 20:06:45.511 DEBUG [http-nio-8080-exec-2] [aedb4099-badf-4651-acec-cbf40c911e5a] org.hibernate.SQL                        : 
    insert 
    into
        payment_transactions
        (amount, client_id, created_at, entered_by_user_id, notes, status, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:45.512 DEBUG [http-nio-8080-exec-2] [aedb4099-badf-4651-acec-cbf40c911e5a] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:45.513 DEBUG [http-nio-8080-exec-2] [aedb4099-badf-4651-acec-cbf40c911e5a] org.hibernate.SQL                        : 
    select
        bc1_0.id,
        bc1_0.active,
        bc1_0.bonus_percentage,
        bc1_0.created_at,
        bc1_0.description,
        bc1_0.effective_from,
        bc1_0.effective_to,
        bc1_0.updated_at,
        bc1_0.version 
    from
        bonus_configurations bc1_0 
    where
        bc1_0.active=true 
        and (
            bc1_0.effective_to is null 
            or bc1_0.effective_to>?
        ) 
    order by
        bc1_0.effective_from desc
2026-01-05 20:06:45.514 DEBUG [http-nio-8080-exec-2] [aedb4099-badf-4651-acec-cbf40c911e5a] org.hibernate.SQL                        : 
    insert 
    into
        bonus_events
        (bonus_amount, client_id, created_at, event_id, updated_at, version, event_type, id) 
    values
        (?, ?, ?, ?, ?, ?, 'GRANTED', default)
2026-01-05 20:06:45.514 DEBUG [http-nio-8080-exec-2] [aedb4099-badf-4651-acec-cbf40c911e5a] org.hibernate.SQL                        : 
    insert 
    into
        bonus_granted
        (bonus_percentage, payment_amount, payment_transaction_id, id) 
    values
        (?, ?, ?, ?)
2026-01-05 20:06:45.515 DEBUG [http-nio-8080-exec-2] [aedb4099-badf-4651-acec-cbf40c911e5a] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:49.716 DEBUG [http-nio-8080-exec-3] [2c2d098b-6be8-4ac6-9f96-896b6fc5241a] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/payments
2026-01-05 20:06:49.727 DEBUG [http-nio-8080-exec-3] [2c2d098b-6be8-4ac6-9f96-896b6fc5241a] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 20:06:49.736 DEBUG [http-nio-8080-exec-3] [2c2d098b-6be8-4ac6-9f96-896b6fc5241a] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 20:06:49.771 DEBUG [http-nio-8080-exec-3] [2c2d098b-6be8-4ac6-9f96-896b6fc5241a] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/payments
2026-01-05 20:06:49.780 DEBUG [http-nio-8080-exec-3] [2c2d098b-6be8-4ac6-9f96-896b6fc5241a] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 20:06:49.780 DEBUG [http-nio-8080-exec-3] [2c2d098b-6be8-4ac6-9f96-896b6fc5241a] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 20:06:49.781 DEBUG [http-nio-8080-exec-3] [2c2d098b-6be8-4ac6-9f96-896b6fc5241a] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 20:06:49.782 DEBUG [http-nio-8080-exec-3] [2c2d098b-6be8-4ac6-9f96-896b6fc5241a] org.hibernate.SQL                        : 
    select
        t1_0.client_id,
        t1_0.tag 
    from
        client_tags t1_0 
    where
        t1_0.client_id=?
2026-01-05 20:06:49.782 DEBUG [http-nio-8080-exec-3] [2c2d098b-6be8-4ac6-9f96-896b6fc5241a] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        r1_0.user_id,
        r1_0.role,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    left join
        user_roles r1_0 
            on u1_0.id=r1_0.user_id 
    where
        u1_0.id=?
2026-01-05 20:06:49.784 DEBUG [http-nio-8080-exec-3] [2c2d098b-6be8-4ac6-9f96-896b6fc5241a] org.hibernate.SQL                        : 
    insert 
    into
        payment_transactions
        (amount, client_id, created_at, entered_by_user_id, notes, status, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:49.786 DEBUG [http-nio-8080-exec-3] [2c2d098b-6be8-4ac6-9f96-896b6fc5241a] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:49.789 DEBUG [http-nio-8080-exec-3] [2c2d098b-6be8-4ac6-9f96-896b6fc5241a] org.hibernate.SQL                        : 
    select
        bc1_0.id,
        bc1_0.active,
        bc1_0.bonus_percentage,
        bc1_0.created_at,
        bc1_0.description,
        bc1_0.effective_from,
        bc1_0.effective_to,
        bc1_0.updated_at,
        bc1_0.version 
    from
        bonus_configurations bc1_0 
    where
        bc1_0.active=true 
        and (
            bc1_0.effective_to is null 
            or bc1_0.effective_to>?
        ) 
    order by
        bc1_0.effective_from desc
2026-01-05 20:06:49.790 DEBUG [http-nio-8080-exec-3] [2c2d098b-6be8-4ac6-9f96-896b6fc5241a] org.hibernate.SQL                        : 
    insert 
    into
        bonus_events
        (bonus_amount, client_id, created_at, event_id, updated_at, version, event_type, id) 
    values
        (?, ?, ?, ?, ?, ?, 'GRANTED', default)
2026-01-05 20:06:49.790 DEBUG [http-nio-8080-exec-3] [2c2d098b-6be8-4ac6-9f96-896b6fc5241a] org.hibernate.SQL                        : 
    insert 
    into
        bonus_granted
        (bonus_percentage, payment_amount, payment_transaction_id, id) 
    values
        (?, ?, ?, ?)
2026-01-05 20:06:49.790 DEBUG [http-nio-8080-exec-3] [2c2d098b-6be8-4ac6-9f96-896b6fc5241a] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:50.573 DEBUG [http-nio-8080-exec-4] [f31639a8-93ef-4d3a-aae1-b7f3bca7a70b] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/payments
2026-01-05 20:06:50.579 DEBUG [http-nio-8080-exec-4] [f31639a8-93ef-4d3a-aae1-b7f3bca7a70b] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 20:06:50.581 DEBUG [http-nio-8080-exec-4] [f31639a8-93ef-4d3a-aae1-b7f3bca7a70b] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 20:06:50.584 DEBUG [http-nio-8080-exec-4] [f31639a8-93ef-4d3a-aae1-b7f3bca7a70b] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/payments
2026-01-05 20:06:50.586 DEBUG [http-nio-8080-exec-4] [f31639a8-93ef-4d3a-aae1-b7f3bca7a70b] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 20:06:50.586 DEBUG [http-nio-8080-exec-4] [f31639a8-93ef-4d3a-aae1-b7f3bca7a70b] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 20:06:50.588 DEBUG [http-nio-8080-exec-4] [f31639a8-93ef-4d3a-aae1-b7f3bca7a70b] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 20:06:50.589 DEBUG [http-nio-8080-exec-4] [f31639a8-93ef-4d3a-aae1-b7f3bca7a70b] org.hibernate.SQL                        : 
    select
        t1_0.client_id,
        t1_0.tag 
    from
        client_tags t1_0 
    where
        t1_0.client_id=?
2026-01-05 20:06:50.589 DEBUG [http-nio-8080-exec-4] [f31639a8-93ef-4d3a-aae1-b7f3bca7a70b] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        r1_0.user_id,
        r1_0.role,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    left join
        user_roles r1_0 
            on u1_0.id=r1_0.user_id 
    where
        u1_0.id=?
2026-01-05 20:06:50.591 DEBUG [http-nio-8080-exec-4] [f31639a8-93ef-4d3a-aae1-b7f3bca7a70b] org.hibernate.SQL                        : 
    insert 
    into
        payment_transactions
        (amount, client_id, created_at, entered_by_user_id, notes, status, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:50.593 DEBUG [http-nio-8080-exec-4] [f31639a8-93ef-4d3a-aae1-b7f3bca7a70b] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:06:50.594 DEBUG [http-nio-8080-exec-4] [f31639a8-93ef-4d3a-aae1-b7f3bca7a70b] org.hibernate.SQL                        : 
    select
        bc1_0.id,
        bc1_0.active,
        bc1_0.bonus_percentage,
        bc1_0.created_at,
        bc1_0.description,
        bc1_0.effective_from,
        bc1_0.effective_to,
        bc1_0.updated_at,
        bc1_0.version 
    from
        bonus_configurations bc1_0 
    where
        bc1_0.active=true 
        and (
            bc1_0.effective_to is null 
            or bc1_0.effective_to>?
        ) 
    order by
        bc1_0.effective_from desc
2026-01-05 20:06:50.596 DEBUG [http-nio-8080-exec-4] [f31639a8-93ef-4d3a-aae1-b7f3bca7a70b] org.hibernate.SQL                        : 
    insert 
    into
        bonus_events
        (bonus_amount, client_id, created_at, event_id, updated_at, version, event_type, id) 
    values
        (?, ?, ?, ?, ?, ?, 'GRANTED', default)
2026-01-05 20:06:50.597 DEBUG [http-nio-8080-exec-4] [f31639a8-93ef-4d3a-aae1-b7f3bca7a70b] org.hibernate.SQL                        : 
    insert 
    into
        bonus_granted
        (bonus_percentage, payment_amount, payment_transaction_id, id) 
    values
        (?, ?, ?, ?)
2026-01-05 20:06:50.598 DEBUG [http-nio-8080-exec-4] [f31639a8-93ef-4d3a-aae1-b7f3bca7a70b] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:07:03.511 DEBUG [http-nio-8080-exec-5] [4312e5bf-08e3-4c38-ada5-a1d5e447c300] o.s.security.web.FilterChainProxy        : Securing GET /api/v1/bonuses/client/8ba20fc4-39bc-490d-9e8e-cb82308e1c69/balance
2026-01-05 20:07:03.516 DEBUG [http-nio-8080-exec-5] [4312e5bf-08e3-4c38-ada5-a1d5e447c300] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 20:07:03.518 DEBUG [http-nio-8080-exec-5] [4312e5bf-08e3-4c38-ada5-a1d5e447c300] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 20:07:03.523 DEBUG [http-nio-8080-exec-5] [4312e5bf-08e3-4c38-ada5-a1d5e447c300] o.s.security.web.FilterChainProxy        : Secured GET /api/v1/bonuses/client/8ba20fc4-39bc-490d-9e8e-cb82308e1c69/balance
2026-01-05 20:07:03.530 DEBUG [http-nio-8080-exec-5] [4312e5bf-08e3-4c38-ada5-a1d5e447c300] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.BonusController.getClientBonusBalance(java.util.UUID); target is of class [com.westwood.controller.BonusController]
2026-01-05 20:07:03.533 DEBUG [http-nio-8080-exec-5] [4312e5bf-08e3-4c38-ada5-a1d5e447c300] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.BonusController.getClientBonusBalance(java.util.UUID); target is of class [com.westwood.controller.BonusController]
2026-01-05 20:07:03.538 DEBUG [http-nio-8080-exec-5] [4312e5bf-08e3-4c38-ada5-a1d5e447c300] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 20:07:03.539 DEBUG [http-nio-8080-exec-5] [4312e5bf-08e3-4c38-ada5-a1d5e447c300] org.hibernate.SQL                        : 
    select
        t1_0.client_id,
        t1_0.tag 
    from
        client_tags t1_0 
    where
        t1_0.client_id=?
2026-01-05 20:07:03.554 DEBUG [http-nio-8080-exec-5] [4312e5bf-08e3-4c38-ada5-a1d5e447c300] org.hibernate.SQL                        : 
    select
        be1_0.id,
        be1_0.event_type,
        be1_0.bonus_amount,
        be1_0.client_id,
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version,
        be1_0.created_at,
        be1_0.event_id,
        be1_0.updated_at,
        be1_0.version,
        be1_1.bonus_percentage,
        be1_1.payment_amount,
        be1_1.payment_transaction_id,
        be1_2.final_payment_amount,
        be1_2.original_payment_amount,
        be1_2.payment_transaction_id 
    from
        bonus_events be1_0 
    left join
        bonus_granted be1_1 
            on be1_0.id=be1_1.id 
    left join
        bonus_used be1_2 
            on be1_0.id=be1_2.id 
    left join
        clients c1_0 
            on c1_0.id=be1_0.client_id 
    where
        be1_0.client_id=? 
    order by
        be1_0.created_at
2026-01-05 20:07:32.554 DEBUG [http-nio-8080-exec-6] [b26d7144-3ada-425d-8f80-36ba66f54942] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/bonuses/use
2026-01-05 20:07:32.585 DEBUG [http-nio-8080-exec-6] [b26d7144-3ada-425d-8f80-36ba66f54942] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 20:07:32.592 DEBUG [http-nio-8080-exec-6] [b26d7144-3ada-425d-8f80-36ba66f54942] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 20:07:32.615 DEBUG [http-nio-8080-exec-6] [b26d7144-3ada-425d-8f80-36ba66f54942] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/bonuses/use
2026-01-05 20:07:32.668 DEBUG [http-nio-8080-exec-6] [b26d7144-3ada-425d-8f80-36ba66f54942] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.BonusController.useBonus(com.westwood.common.dto.UseBonusRequest); target is of class [com.westwood.controller.BonusController]
2026-01-05 20:07:32.670 DEBUG [http-nio-8080-exec-6] [b26d7144-3ada-425d-8f80-36ba66f54942] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.BonusController.useBonus(com.westwood.common.dto.UseBonusRequest); target is of class [com.westwood.controller.BonusController]
2026-01-05 20:07:32.671 DEBUG [http-nio-8080-exec-6] [b26d7144-3ada-425d-8f80-36ba66f54942] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 20:07:32.672 DEBUG [http-nio-8080-exec-6] [b26d7144-3ada-425d-8f80-36ba66f54942] org.hibernate.SQL                        : 
    select
        t1_0.client_id,
        t1_0.tag 
    from
        client_tags t1_0 
    where
        t1_0.client_id=?
2026-01-05 20:07:32.675 DEBUG [http-nio-8080-exec-6] [b26d7144-3ada-425d-8f80-36ba66f54942] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        r1_0.user_id,
        r1_0.role,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    left join
        user_roles r1_0 
            on u1_0.id=r1_0.user_id 
    where
        u1_0.id=?
2026-01-05 20:07:32.678 DEBUG [http-nio-8080-exec-6] [b26d7144-3ada-425d-8f80-36ba66f54942] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 20:07:32.679 DEBUG [http-nio-8080-exec-6] [b26d7144-3ada-425d-8f80-36ba66f54942] org.hibernate.SQL                        : 
    select
        be1_0.id,
        be1_0.event_type,
        be1_0.bonus_amount,
        be1_0.client_id,
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version,
        be1_0.created_at,
        be1_0.event_id,
        be1_0.updated_at,
        be1_0.version,
        be1_1.bonus_percentage,
        be1_1.payment_amount,
        be1_1.payment_transaction_id,
        be1_2.final_payment_amount,
        be1_2.original_payment_amount,
        be1_2.payment_transaction_id 
    from
        bonus_events be1_0 
    left join
        bonus_granted be1_1 
            on be1_0.id=be1_1.id 
    left join
        bonus_used be1_2 
            on be1_0.id=be1_2.id 
    left join
        clients c1_0 
            on c1_0.id=be1_0.client_id 
    where
        be1_0.client_id=? 
    order by
        be1_0.created_at
2026-01-05 20:07:41.358 DEBUG [http-nio-8080-exec-8] [5f0052f2-c881-400f-a4b2-5d0de2e91921] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/bonuses/use
2026-01-05 20:07:41.361 DEBUG [http-nio-8080-exec-8] [5f0052f2-c881-400f-a4b2-5d0de2e91921] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 20:07:41.362 DEBUG [http-nio-8080-exec-8] [5f0052f2-c881-400f-a4b2-5d0de2e91921] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 20:07:41.365 DEBUG [http-nio-8080-exec-8] [5f0052f2-c881-400f-a4b2-5d0de2e91921] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/bonuses/use
2026-01-05 20:07:41.366 DEBUG [http-nio-8080-exec-8] [5f0052f2-c881-400f-a4b2-5d0de2e91921] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.BonusController.useBonus(com.westwood.common.dto.UseBonusRequest); target is of class [com.westwood.controller.BonusController]
2026-01-05 20:07:41.367 DEBUG [http-nio-8080-exec-8] [5f0052f2-c881-400f-a4b2-5d0de2e91921] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.BonusController.useBonus(com.westwood.common.dto.UseBonusRequest); target is of class [com.westwood.controller.BonusController]
2026-01-05 20:07:41.369 DEBUG [http-nio-8080-exec-8] [5f0052f2-c881-400f-a4b2-5d0de2e91921] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 20:07:41.374 DEBUG [http-nio-8080-exec-8] [5f0052f2-c881-400f-a4b2-5d0de2e91921] org.hibernate.SQL                        : 
    select
        t1_0.client_id,
        t1_0.tag 
    from
        client_tags t1_0 
    where
        t1_0.client_id=?
2026-01-05 20:07:41.375 DEBUG [http-nio-8080-exec-8] [5f0052f2-c881-400f-a4b2-5d0de2e91921] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        r1_0.user_id,
        r1_0.role,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    left join
        user_roles r1_0 
            on u1_0.id=r1_0.user_id 
    where
        u1_0.id=?
2026-01-05 20:07:41.378 DEBUG [http-nio-8080-exec-8] [5f0052f2-c881-400f-a4b2-5d0de2e91921] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 20:07:41.382 DEBUG [http-nio-8080-exec-8] [5f0052f2-c881-400f-a4b2-5d0de2e91921] org.hibernate.SQL                        : 
    select
        be1_0.id,
        be1_0.event_type,
        be1_0.bonus_amount,
        be1_0.client_id,
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version,
        be1_0.created_at,
        be1_0.event_id,
        be1_0.updated_at,
        be1_0.version,
        be1_1.bonus_percentage,
        be1_1.payment_amount,
        be1_1.payment_transaction_id,
        be1_2.final_payment_amount,
        be1_2.original_payment_amount,
        be1_2.payment_transaction_id 
    from
        bonus_events be1_0 
    left join
        bonus_granted be1_1 
            on be1_0.id=be1_1.id 
    left join
        bonus_used be1_2 
            on be1_0.id=be1_2.id 
    left join
        clients c1_0 
            on c1_0.id=be1_0.client_id 
    where
        be1_0.client_id=? 
    order by
        be1_0.created_at
2026-01-05 20:07:59.047 DEBUG [http-nio-8080-exec-1] [723ef2b1-04c8-40e7-a6d6-d9cbebb8b3b0] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/bonuses/use
2026-01-05 20:07:59.059 DEBUG [http-nio-8080-exec-1] [723ef2b1-04c8-40e7-a6d6-d9cbebb8b3b0] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 20:07:59.067 DEBUG [http-nio-8080-exec-1] [723ef2b1-04c8-40e7-a6d6-d9cbebb8b3b0] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 20:07:59.101 DEBUG [http-nio-8080-exec-1] [723ef2b1-04c8-40e7-a6d6-d9cbebb8b3b0] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/bonuses/use
2026-01-05 20:07:59.124 DEBUG [http-nio-8080-exec-1] [723ef2b1-04c8-40e7-a6d6-d9cbebb8b3b0] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.BonusController.useBonus(com.westwood.common.dto.UseBonusRequest); target is of class [com.westwood.controller.BonusController]
2026-01-05 20:07:59.124 DEBUG [http-nio-8080-exec-1] [723ef2b1-04c8-40e7-a6d6-d9cbebb8b3b0] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.BonusController.useBonus(com.westwood.common.dto.UseBonusRequest); target is of class [com.westwood.controller.BonusController]
2026-01-05 20:07:59.126 DEBUG [http-nio-8080-exec-1] [723ef2b1-04c8-40e7-a6d6-d9cbebb8b3b0] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 20:07:59.127 DEBUG [http-nio-8080-exec-1] [723ef2b1-04c8-40e7-a6d6-d9cbebb8b3b0] org.hibernate.SQL                        : 
    select
        t1_0.client_id,
        t1_0.tag 
    from
        client_tags t1_0 
    where
        t1_0.client_id=?
2026-01-05 20:07:59.130 DEBUG [http-nio-8080-exec-1] [723ef2b1-04c8-40e7-a6d6-d9cbebb8b3b0] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        r1_0.user_id,
        r1_0.role,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    left join
        user_roles r1_0 
            on u1_0.id=r1_0.user_id 
    where
        u1_0.id=?
2026-01-05 20:07:59.135 DEBUG [http-nio-8080-exec-1] [723ef2b1-04c8-40e7-a6d6-d9cbebb8b3b0] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 20:07:59.139 DEBUG [http-nio-8080-exec-1] [723ef2b1-04c8-40e7-a6d6-d9cbebb8b3b0] org.hibernate.SQL                        : 
    select
        be1_0.id,
        be1_0.event_type,
        be1_0.bonus_amount,
        be1_0.client_id,
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version,
        be1_0.created_at,
        be1_0.event_id,
        be1_0.updated_at,
        be1_0.version,
        be1_1.bonus_percentage,
        be1_1.payment_amount,
        be1_1.payment_transaction_id,
        be1_2.final_payment_amount,
        be1_2.original_payment_amount,
        be1_2.payment_transaction_id 
    from
        bonus_events be1_0 
    left join
        bonus_granted be1_1 
            on be1_0.id=be1_1.id 
    left join
        bonus_used be1_2 
            on be1_0.id=be1_2.id 
    left join
        clients c1_0 
            on c1_0.id=be1_0.client_id 
    where
        be1_0.client_id=? 
    order by
        be1_0.created_at
2026-01-05 20:07:59.146 DEBUG [http-nio-8080-exec-1] [723ef2b1-04c8-40e7-a6d6-d9cbebb8b3b0] org.hibernate.SQL                        : 
    insert 
    into
        payment_transactions
        (amount, client_id, created_at, entered_by_user_id, notes, status, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:07:59.149 DEBUG [http-nio-8080-exec-1] [723ef2b1-04c8-40e7-a6d6-d9cbebb8b3b0] org.hibernate.SQL                        : 
    insert 
    into
        bonus_events
        (bonus_amount, client_id, created_at, event_id, updated_at, version, event_type, id) 
    values
        (?, ?, ?, ?, ?, ?, 'USED', default)
2026-01-05 20:07:59.152 DEBUG [http-nio-8080-exec-1] [723ef2b1-04c8-40e7-a6d6-d9cbebb8b3b0] org.hibernate.SQL                        : 
    insert 
    into
        bonus_used
        (final_payment_amount, original_payment_amount, payment_transaction_id, id) 
    values
        (?, ?, ?, ?)
2026-01-05 20:07:59.161 DEBUG [http-nio-8080-exec-1] [723ef2b1-04c8-40e7-a6d6-d9cbebb8b3b0] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:07:59.162 DEBUG [http-nio-8080-exec-1] [723ef2b1-04c8-40e7-a6d6-d9cbebb8b3b0] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 20:08:25.617 DEBUG [http-nio-8080-exec-10] [2d18b813-e728-4a9e-a5a7-6115953b19ad] o.s.security.web.FilterChainProxy        : Securing GET /api/v1/payments/client/8ba20fc4-39bc-490d-9e8e-cb82308e1c69/total?from=2024-01-01T00:00:00&to=2026-12-31T23:59:59
2026-01-05 20:08:25.637 DEBUG [http-nio-8080-exec-10] [2d18b813-e728-4a9e-a5a7-6115953b19ad] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 20:08:25.643 DEBUG [http-nio-8080-exec-10] [2d18b813-e728-4a9e-a5a7-6115953b19ad] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 20:08:25.651 DEBUG [http-nio-8080-exec-10] [2d18b813-e728-4a9e-a5a7-6115953b19ad] o.s.security.web.FilterChainProxy        : Secured GET /api/v1/payments/client/8ba20fc4-39bc-490d-9e8e-cb82308e1c69/total?from=2024-01-01T00:00:00&to=2026-12-31T23:59:59
2026-01-05 20:08:25.699 DEBUG [http-nio-8080-exec-10] [2d18b813-e728-4a9e-a5a7-6115953b19ad] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.getTotalByClientAndTimeRange(java.util.UUID,java.time.LocalDateTime,java.time.LocalDateTime); target is of class [com.westwood.controller.PaymentController]
2026-01-05 20:08:25.701 DEBUG [http-nio-8080-exec-10] [2d18b813-e728-4a9e-a5a7-6115953b19ad] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.getTotalByClientAndTimeRange(java.util.UUID,java.time.LocalDateTime,java.time.LocalDateTime); target is of class [com.westwood.controller.PaymentController]
2026-01-05 20:08:25.703 DEBUG [http-nio-8080-exec-10] [2d18b813-e728-4a9e-a5a7-6115953b19ad] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 20:08:25.704 DEBUG [http-nio-8080-exec-10] [2d18b813-e728-4a9e-a5a7-6115953b19ad] org.hibernate.SQL                        : 
    select
        t1_0.client_id,
        t1_0.tag 
    from
        client_tags t1_0 
    where
        t1_0.client_id=?
2026-01-05 20:08:25.714 DEBUG [http-nio-8080-exec-10] [2d18b813-e728-4a9e-a5a7-6115953b19ad] org.hibernate.SQL                        : 
    select
        sum(pt1_0.amount) 
    from
        payment_transactions pt1_0 
    where
        pt1_0.client_id=? 
        and pt1_0.created_at between ? and ?
2026-01-05 20:09:02.112 DEBUG [http-nio-8080-exec-2] [cf81bcb1-a23c-437c-854a-ff8d031a8a27] o.s.security.web.FilterChainProxy        : Securing GET /api/v1/bonuses/client/8ba20fc4-39bc-490d-9e8e-cb82308e1c69/history
2026-01-05 20:09:02.162 DEBUG [http-nio-8080-exec-2] [cf81bcb1-a23c-437c-854a-ff8d031a8a27] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 20:09:02.170 DEBUG [http-nio-8080-exec-2] [cf81bcb1-a23c-437c-854a-ff8d031a8a27] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 20:09:02.174 DEBUG [http-nio-8080-exec-2] [cf81bcb1-a23c-437c-854a-ff8d031a8a27] o.s.security.web.FilterChainProxy        : Secured GET /api/v1/bonuses/client/8ba20fc4-39bc-490d-9e8e-cb82308e1c69/history
2026-01-05 20:09:02.179 DEBUG [http-nio-8080-exec-2] [cf81bcb1-a23c-437c-854a-ff8d031a8a27] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.BonusController.getClientBonusHistory(java.util.UUID); target is of class [com.westwood.controller.BonusController]
2026-01-05 20:09:02.186 DEBUG [http-nio-8080-exec-2] [cf81bcb1-a23c-437c-854a-ff8d031a8a27] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.BonusController.getClientBonusHistory(java.util.UUID); target is of class [com.westwood.controller.BonusController]
2026-01-05 20:09:02.189 DEBUG [http-nio-8080-exec-2] [cf81bcb1-a23c-437c-854a-ff8d031a8a27] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 20:09:02.190 DEBUG [http-nio-8080-exec-2] [cf81bcb1-a23c-437c-854a-ff8d031a8a27] org.hibernate.SQL                        : 
    select
        t1_0.client_id,
        t1_0.tag 
    from
        client_tags t1_0 
    where
        t1_0.client_id=?
2026-01-05 20:09:02.202 DEBUG [http-nio-8080-exec-2] [cf81bcb1-a23c-437c-854a-ff8d031a8a27] org.hibernate.SQL                        : 
    select
        be1_0.id,
        be1_0.event_type,
        be1_0.bonus_amount,
        be1_0.client_id,
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version,
        be1_0.created_at,
        be1_0.event_id,
        be1_0.updated_at,
        be1_0.version,
        be1_1.bonus_percentage,
        be1_1.payment_amount,
        be1_1.payment_transaction_id,
        be1_2.final_payment_amount,
        be1_2.original_payment_amount,
        be1_2.payment_transaction_id 
    from
        bonus_events be1_0 
    left join
        bonus_granted be1_1 
            on be1_0.id=be1_1.id 
    left join
        bonus_used be1_2 
            on be1_0.id=be1_2.id 
    left join
        clients c1_0 
            on c1_0.id=be1_0.client_id 
    where
        be1_0.client_id=? 
    order by
        be1_0.created_at desc
2026-01-05 20:50:52.356  INFO [SpringApplicationShutdownHook] [] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2026-01-05 20:50:52.401  INFO [SpringApplicationShutdownHook] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2026-01-05 20:50:52.409  INFO [SpringApplicationShutdownHook] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2026-01-05 20:53:18.139  INFO [main] [] c.westwood.WestwoodBackendApplication    : Starting WestwoodBackendApplication using Java 17.0.10 with PID 84213 (/Users/baglan/repo/westwood-backend/target/classes started by baglan in /Users/baglan/repo/westwood-backend)
2026-01-05 20:53:18.140 DEBUG [main] [] c.westwood.WestwoodBackendApplication    : Running with Spring Boot v3.3.5, Spring v6.1.14
2026-01-05 20:53:18.140  INFO [main] [] c.westwood.WestwoodBackendApplication    : The following 1 profile is active: "dev"
2026-01-05 20:53:18.334  INFO [main] [] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2026-01-05 20:53:18.352  INFO [main] [] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 15 ms. Found 6 JPA repository interfaces.
2026-01-05 20:53:18.678  INFO [main] [] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-01-05 20:53:18.684  INFO [main] [] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-01-05 20:53:18.685  INFO [main] [] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.31]
2026-01-05 20:53:18.708  INFO [main] [] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2026-01-05 20:53:18.708  INFO [main] [] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 550 ms
2026-01-05 20:53:18.729  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-01-05 20:53:18.819  INFO [main] [] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:devdb user=SA
2026-01-05 20:53:18.820  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-01-05 20:53:18.825  INFO [main] [] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:devdb'
2026-01-05 20:53:18.910  INFO [main] [] org.flywaydb.core.FlywayExecutor         : Database: jdbc:h2:mem:devdb (H2 2.2)
2026-01-05 20:53:18.912  WARN [main] [] o.f.c.internal.database.base.Database    : Flyway upgrade recommended: H2 2.2.224 is newer than this version of Flyway and support has not been tested. The latest supported version of H2 is 2.2.220.
2026-01-05 20:53:18.921  INFO [main] [] o.f.c.i.s.JdbcTableSchemaHistory         : Schema history table "PUBLIC"."flyway_schema_history" does not exist yet
2026-01-05 20:53:18.921  INFO [main] [] o.f.core.internal.command.DbValidate     : Successfully validated 8 migrations (execution time 00:00.005s)
2026-01-05 20:53:18.923  INFO [main] [] o.f.c.i.s.JdbcTableSchemaHistory         : Creating Schema History table "PUBLIC"."flyway_schema_history" ...
2026-01-05 20:53:18.935  INFO [main] [] o.f.core.internal.command.DbMigrate      : Current version of schema "PUBLIC": << Empty Schema >>
2026-01-05 20:53:18.937  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "0 - create clients table"
2026-01-05 20:53:18.946  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "1 - create users table"
2026-01-05 20:53:18.950  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "2 - create payment transactions table"
2026-01-05 20:53:18.953  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "3 - create bonus events table"
2026-01-05 20:53:18.958  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "4 - create bonus configuration table"
2026-01-05 20:53:18.960  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "5 - create event store table"
2026-01-05 20:53:18.964  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "6 - add uuid to clients and users"
2026-01-05 20:53:18.971  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "7 - add user activation fields"
2026-01-05 20:53:18.975 ERROR [main] [] o.f.core.internal.command.DbMigrate      : Migration of schema "PUBLIC" to version "7 - add user activation fields" failed! Please restore backups and roll back database and code!
2026-01-05 20:53:18.977 ERROR [main] [] o.s.b.web.embedded.tomcat.TomcatStarter  : Error starting Tomcat context. Exception: org.springframework.beans.factory.UnsatisfiedDependencyException. Message: Error creating bean with name 'jwtAuthenticationFilter' defined in file [/Users/baglan/repo/westwood-backend/target/classes/com/westwood/security/JwtAuthenticationFilter.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'userDetailsServiceImpl' defined in file [/Users/baglan/repo/westwood-backend/target/classes/com/westwood/security/UserDetailsServiceImpl.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'userRepository' defined in com.westwood.repository.UserRepository defined in @EnableJpaRepositories declared on JpaConfig: Cannot resolve reference to bean 'jpaSharedEM_entityManagerFactory' while setting bean property 'entityManager'
2026-01-05 20:53:18.986  INFO [main] [] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
2026-01-05 20:53:18.988  WARN [main] [] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Unable to start web server
2026-01-05 20:53:18.988  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2026-01-05 20:53:18.993  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2026-01-05 20:53:18.996  INFO [main] [] .s.b.a.l.ConditionEvaluationReportLogger : 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2026-01-05 20:53:19.001 ERROR [main] [] o.s.boot.SpringApplication               : Application run failed

org.springframework.context.ApplicationContextException: Unable to start web server
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:165)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:619)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:335)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1363)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1352)
	at com.westwood.WestwoodBackendApplication.main(WestwoodBackendApplication.java:10)
Caused by: org.springframework.boot.web.server.WebServerException: Unable to start embedded Tomcat
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.initialize(TomcatWebServer.java:147)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.<init>(TomcatWebServer.java:107)
	at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory.getTomcatWebServer(TomcatServletWebServerFactory.java:516)
	at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory.getWebServer(TomcatServletWebServerFactory.java:222)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.createWebServer(ServletWebServerApplicationContext.java:188)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:162)
	... 8 common frames omitted
Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'jwtAuthenticationFilter' defined in file [/Users/baglan/repo/westwood-backend/target/classes/com/westwood/security/JwtAuthenticationFilter.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'userDetailsServiceImpl' defined in file [/Users/baglan/repo/westwood-backend/target/classes/com/westwood/security/UserDetailsServiceImpl.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'userRepository' defined in com.westwood.repository.UserRepository defined in @EnableJpaRepositories declared on JpaConfig: Cannot resolve reference to bean 'jpaSharedEM_entityManagerFactory' while setting bean property 'entityManager'
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:795)
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:237)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1375)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1212)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:562)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:205)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.getOrderedBeansOfType(ServletContextInitializerBeans.java:211)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.addAsRegistrationBean(ServletContextInitializerBeans.java:174)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.addAsRegistrationBean(ServletContextInitializerBeans.java:169)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.addAdaptableBeans(ServletContextInitializerBeans.java:154)
	at org.springframework.boot.web.servlet.ServletContextInitializerBeans.<init>(ServletContextInitializerBeans.java:87)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.getServletContextInitializerBeans(ServletWebServerApplicationContext.java:266)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.selfInitialize(ServletWebServerApplicationContext.java:240)
	at org.springframework.boot.web.embedded.tomcat.TomcatStarter.onStartup(TomcatStarter.java:52)
	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:4412)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1203)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1193)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:749)
	at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:772)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1203)
	at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1193)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:145)
	at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:749)
	at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:203)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.StandardService.startInternal(StandardService.java:415)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:870)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:164)
	at org.apache.catalina.startup.Tomcat.start(Tomcat.java:437)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.initialize(TomcatWebServer.java:128)
	... 13 common frames omitted
Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'userDetailsServiceImpl' defined in file [/Users/baglan/repo/westwood-backend/target/classes/com/westwood/security/UserDetailsServiceImpl.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'userRepository' defined in com.westwood.repository.UserRepository defined in @EnableJpaRepositories declared on JpaConfig: Cannot resolve reference to bean 'jpaSharedEM_entityManagerFactory' while setting bean property 'entityManager'
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:795)
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:237)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1375)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1212)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:562)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200)
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1443)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1353)
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:904)
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:782)
	... 54 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'userRepository' defined in com.westwood.repository.UserRepository defined in @EnableJpaRepositories declared on JpaConfig: Cannot resolve reference to bean 'jpaSharedEM_entityManagerFactory' while setting bean property 'entityManager'
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:377)
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:135)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1705)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1454)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:599)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200)
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1443)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1353)
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:904)
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:782)
	... 68 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'jpaSharedEM_entityManagerFactory': Cannot resolve reference to bean 'entityManagerFactory' while setting constructor argument
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:377)
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:135)
	at org.springframework.beans.factory.support.ConstructorResolver.resolveConstructorArguments(ConstructorResolver.java:682)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:509)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1355)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1185)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:562)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200)
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:365)
	... 82 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'flywayInitializer' defined in class path resource [org/springframework/boot/autoconfigure/flyway/FlywayAutoConfiguration$FlywayConfiguration.class]: Migration V7__add_user_activation_fields.sql failed
---------------------------------------------------
SQL State  : 42000
Error Code : 42000
Message    :     SQL "-- Add account activation fields to users table\000aALTER TABLE users \000a    ADD COLUMN account_status VARCHAR(20) NOT NULL DEFAULT 'ACTIVE'[*],\000a    ADD COLUMN activation_token VARCHAR(255) UNIQUE,\000a    ADD COLUMN activation_token_expiry TIMESTAMP"
Syntax error in SQL statement "-- Add account activation fields to users table\000aALTER TABLE users \000a    ADD COLUMN account_status VARCHAR(20) NOT NULL DEFAULT 'ACTIVE'[*],\000a    ADD COLUMN activation_token VARCHAR(255) UNIQUE,\000a    ADD COLUMN activation_token_expiry TIMESTAMP"; SQL statement:
-- Add account activation fields to users table
ALTER TABLE users 
    ADD COLUMN account_status VARCHAR(20) NOT NULL DEFAULT 'ACTIVE',
    ADD COLUMN activation_token VARCHAR(255) UNIQUE,
    ADD COLUMN activation_token_expiry TIMESTAMP [42000-224]
Location   : db/migration/V7__add_user_activation_fields.sql (/Users/baglan/repo/westwood-backend/target/classes/db/migration/V7__add_user_activation_fields.sql)
Line       : 2
Statement  : -- Add account activation fields to users table
ALTER TABLE users 
    ADD COLUMN account_status VARCHAR(20) NOT NULL DEFAULT 'ACTIVE',
    ADD COLUMN activation_token VARCHAR(255) UNIQUE,
    ADD COLUMN activation_token_expiry TIMESTAMP

	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1806)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:600)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:313)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200)
	at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:365)
	... 94 common frames omitted
Caused by: org.flywaydb.core.internal.command.DbMigrate$FlywayMigrateException: Migration V7__add_user_activation_fields.sql failed
---------------------------------------------------
SQL State  : 42000
Error Code : 42000
Message    :     SQL "-- Add account activation fields to users table\000aALTER TABLE users \000a    ADD COLUMN account_status VARCHAR(20) NOT NULL DEFAULT 'ACTIVE'[*],\000a    ADD COLUMN activation_token VARCHAR(255) UNIQUE,\000a    ADD COLUMN activation_token_expiry TIMESTAMP"
Syntax error in SQL statement "-- Add account activation fields to users table\000aALTER TABLE users \000a    ADD COLUMN account_status VARCHAR(20) NOT NULL DEFAULT 'ACTIVE'[*],\000a    ADD COLUMN activation_token VARCHAR(255) UNIQUE,\000a    ADD COLUMN activation_token_expiry TIMESTAMP"; SQL statement:
-- Add account activation fields to users table
ALTER TABLE users 
    ADD COLUMN account_status VARCHAR(20) NOT NULL DEFAULT 'ACTIVE',
    ADD COLUMN activation_token VARCHAR(255) UNIQUE,
    ADD COLUMN activation_token_expiry TIMESTAMP [42000-224]
Location   : db/migration/V7__add_user_activation_fields.sql (/Users/baglan/repo/westwood-backend/target/classes/db/migration/V7__add_user_activation_fields.sql)
Line       : 2
Statement  : -- Add account activation fields to users table
ALTER TABLE users 
    ADD COLUMN account_status VARCHAR(20) NOT NULL DEFAULT 'ACTIVE',
    ADD COLUMN activation_token VARCHAR(255) UNIQUE,
    ADD COLUMN activation_token_expiry TIMESTAMP

	at org.flywaydb.core.internal.command.DbMigrate.doMigrateGroup(DbMigrate.java:382)
	at org.flywaydb.core.internal.command.DbMigrate.lambda$applyMigrations$1(DbMigrate.java:272)
	at org.flywaydb.core.internal.jdbc.TransactionalExecutionTemplate.execute(TransactionalExecutionTemplate.java:55)
	at org.flywaydb.core.internal.command.DbMigrate.applyMigrations(DbMigrate.java:271)
	at org.flywaydb.core.internal.command.DbMigrate.migrateGroup(DbMigrate.java:244)
	at org.flywaydb.core.internal.command.DbMigrate.lambda$migrateAll$0(DbMigrate.java:139)
	at org.flywaydb.core.internal.jdbc.TableLockingExecutionTemplate$1.call(TableLockingExecutionTemplate.java:36)
	at org.flywaydb.core.internal.jdbc.TransactionalExecutionTemplate.execute(TransactionalExecutionTemplate.java:55)
	at org.flywaydb.core.internal.jdbc.TableLockingExecutionTemplate.execute(TableLockingExecutionTemplate.java:31)
	at org.flywaydb.core.internal.database.base.Connection.lock(Connection.java:102)
	at org.flywaydb.core.internal.schemahistory.JdbcTableSchemaHistory.lock(JdbcTableSchemaHistory.java:145)
	at org.flywaydb.core.internal.command.DbMigrate.migrateAll(DbMigrate.java:139)
	at org.flywaydb.core.internal.command.DbMigrate.migrate(DbMigrate.java:97)
	at org.flywaydb.core.Flyway.lambda$migrate$0(Flyway.java:202)
	at org.flywaydb.core.FlywayExecutor.execute(FlywayExecutor.java:205)
	at org.flywaydb.core.Flyway.migrate(Flyway.java:147)
	at org.springframework.boot.autoconfigure.flyway.FlywayMigrationInitializer.afterPropertiesSet(FlywayMigrationInitializer.java:66)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1853)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1802)
	... 103 common frames omitted
Caused by: org.flywaydb.core.internal.sqlscript.FlywaySqlScriptException: Migration V7__add_user_activation_fields.sql failed
---------------------------------------------------
SQL State  : 42000
Error Code : 42000
Message    :     SQL "-- Add account activation fields to users table\000aALTER TABLE users \000a    ADD COLUMN account_status VARCHAR(20) NOT NULL DEFAULT 'ACTIVE'[*],\000a    ADD COLUMN activation_token VARCHAR(255) UNIQUE,\000a    ADD COLUMN activation_token_expiry TIMESTAMP"
Syntax error in SQL statement "-- Add account activation fields to users table\000aALTER TABLE users \000a    ADD COLUMN account_status VARCHAR(20) NOT NULL DEFAULT 'ACTIVE'[*],\000a    ADD COLUMN activation_token VARCHAR(255) UNIQUE,\000a    ADD COLUMN activation_token_expiry TIMESTAMP"; SQL statement:
-- Add account activation fields to users table
ALTER TABLE users 
    ADD COLUMN account_status VARCHAR(20) NOT NULL DEFAULT 'ACTIVE',
    ADD COLUMN activation_token VARCHAR(255) UNIQUE,
    ADD COLUMN activation_token_expiry TIMESTAMP [42000-224]
Location   : db/migration/V7__add_user_activation_fields.sql (/Users/baglan/repo/westwood-backend/target/classes/db/migration/V7__add_user_activation_fields.sql)
Line       : 2
Statement  : -- Add account activation fields to users table
ALTER TABLE users 
    ADD COLUMN account_status VARCHAR(20) NOT NULL DEFAULT 'ACTIVE',
    ADD COLUMN activation_token VARCHAR(255) UNIQUE,
    ADD COLUMN activation_token_expiry TIMESTAMP

	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.handleException(DefaultSqlScriptExecutor.java:252)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.executeStatement(DefaultSqlScriptExecutor.java:214)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.execute(DefaultSqlScriptExecutor.java:133)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.executeOnce(SqlMigrationExecutor.java:65)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.lambda$execute$0(SqlMigrationExecutor.java:57)
	at org.flywaydb.core.internal.database.DefaultExecutionStrategy.execute(DefaultExecutionStrategy.java:27)
	at org.flywaydb.core.internal.resolver.sql.SqlMigrationExecutor.execute(SqlMigrationExecutor.java:56)
	at org.flywaydb.core.internal.command.DbMigrate.doMigrateGroup(DbMigrate.java:374)
	... 121 common frames omitted
Caused by: org.h2.jdbc.JdbcSQLSyntaxErrorException:     SQL "-- Add account activation fields to users table\000aALTER TABLE users \000a    ADD COLUMN account_status VARCHAR(20) NOT NULL DEFAULT 'ACTIVE'[*],\000a    ADD COLUMN activation_token VARCHAR(255) UNIQUE,\000a    ADD COLUMN activation_token_expiry TIMESTAMP"
Syntax error in SQL statement "-- Add account activation fields to users table\000aALTER TABLE users \000a    ADD COLUMN account_status VARCHAR(20) NOT NULL DEFAULT 'ACTIVE'[*],\000a    ADD COLUMN activation_token VARCHAR(255) UNIQUE,\000a    ADD COLUMN activation_token_expiry TIMESTAMP"; SQL statement:
-- Add account activation fields to users table
ALTER TABLE users 
    ADD COLUMN account_status VARCHAR(20) NOT NULL DEFAULT 'ACTIVE',
    ADD COLUMN activation_token VARCHAR(255) UNIQUE,
    ADD COLUMN activation_token_expiry TIMESTAMP [42000-224]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:514)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.message.DbException.getSyntaxError(DbException.java:247)
	at org.h2.command.ParserBase.getSyntaxError(ParserBase.java:748)
	at org.h2.command.Parser.prepareCommand(Parser.java:486)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:639)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:559)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1166)
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:245)
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:94)
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
	at org.flywaydb.core.internal.jdbc.JdbcTemplate.executeStatement(JdbcTemplate.java:210)
	at org.flywaydb.core.internal.sqlscript.ParsedSqlStatement.execute(ParsedSqlStatement.java:89)
	at org.flywaydb.core.internal.sqlscript.DefaultSqlScriptExecutor.executeStatement(DefaultSqlScriptExecutor.java:206)
	... 127 common frames omitted

2026-01-05 20:55:09.066  INFO [main] [] c.westwood.WestwoodBackendApplication    : Starting WestwoodBackendApplication using Java 17.0.10 with PID 84291 (/Users/baglan/repo/westwood-backend/target/classes started by baglan in /Users/baglan/repo/westwood-backend)
2026-01-05 20:55:09.067 DEBUG [main] [] c.westwood.WestwoodBackendApplication    : Running with Spring Boot v3.3.5, Spring v6.1.14
2026-01-05 20:55:09.067  INFO [main] [] c.westwood.WestwoodBackendApplication    : The following 1 profile is active: "dev"
2026-01-05 20:55:09.258  INFO [main] [] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2026-01-05 20:55:09.277  INFO [main] [] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 14 ms. Found 6 JPA repository interfaces.
2026-01-05 20:55:09.581  INFO [main] [] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-01-05 20:55:09.585  INFO [main] [] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-01-05 20:55:09.586  INFO [main] [] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.31]
2026-01-05 20:55:09.606  INFO [main] [] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2026-01-05 20:55:09.606  INFO [main] [] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 521 ms
2026-01-05 20:55:09.627  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-01-05 20:55:09.696  INFO [main] [] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:devdb user=SA
2026-01-05 20:55:09.697  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-01-05 20:55:09.701  INFO [main] [] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:devdb'
2026-01-05 20:55:09.791  INFO [main] [] org.flywaydb.core.FlywayExecutor         : Database: jdbc:h2:mem:devdb (H2 2.2)
2026-01-05 20:55:09.795  WARN [main] [] o.f.c.internal.database.base.Database    : Flyway upgrade recommended: H2 2.2.224 is newer than this version of Flyway and support has not been tested. The latest supported version of H2 is 2.2.220.
2026-01-05 20:55:09.820  INFO [main] [] o.f.c.i.s.JdbcTableSchemaHistory         : Schema history table "PUBLIC"."flyway_schema_history" does not exist yet
2026-01-05 20:55:09.821  INFO [main] [] o.f.core.internal.command.DbValidate     : Successfully validated 8 migrations (execution time 00:00.008s)
2026-01-05 20:55:09.824  INFO [main] [] o.f.c.i.s.JdbcTableSchemaHistory         : Creating Schema History table "PUBLIC"."flyway_schema_history" ...
2026-01-05 20:55:09.837  INFO [main] [] o.f.core.internal.command.DbMigrate      : Current version of schema "PUBLIC": << Empty Schema >>
2026-01-05 20:55:09.840  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "0 - create clients table"
2026-01-05 20:55:09.848  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "1 - create users table"
2026-01-05 20:55:09.853  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "2 - create payment transactions table"
2026-01-05 20:55:09.856  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "3 - create bonus events table"
2026-01-05 20:55:09.861  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "4 - create bonus configuration table"
2026-01-05 20:55:09.863  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "5 - create event store table"
2026-01-05 20:55:09.865  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "6 - add uuid to clients and users"
2026-01-05 20:55:09.873  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "7 - add user activation fields"
2026-01-05 20:55:09.885  INFO [main] [] o.f.core.internal.command.DbMigrate      : Successfully applied 8 migrations to schema "PUBLIC", now at version v7 (execution time 00:00.025s)
2026-01-05 20:55:09.916  INFO [main] [] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2026-01-05 20:55:09.939  INFO [main] [] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.5.3.Final
2026-01-05 20:55:09.955  INFO [main] [] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2026-01-05 20:55:10.054  INFO [main] [] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2026-01-05 20:55:10.070  WARN [main] [] org.hibernate.orm.deprecation            : HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2026-01-05 20:55:10.123  WARN [main] [] o.h.boot.model.internal.EntityBinder     : HHH000457: Joined inheritance hierarchy [com.westwood.domain.BonusEvent] defined explicit @DiscriminatorColumn.  Legacy Hibernate behavior was to ignore the @DiscriminatorColumn.  However, as part of issue HHH-6911 we now apply the explicit @DiscriminatorColumn.  If you would prefer the legacy behavior, enable the `hibernate.discriminator.ignore_explicit_for_joined` setting (hibernate.discriminator.ignore_explicit_for_joined=true)
2026-01-05 20:55:10.467  INFO [main] [] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2026-01-05 20:55:10.479 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists bonus_configurations 
       alter column description set data type TEXT
2026-01-05 20:55:10.480 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists bonus_events 
       alter column event_type set data type varchar(31)
2026-01-05 20:55:10.480 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists client_tags 
       alter column tag set data type varchar(255)
2026-01-05 20:55:10.481 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists clients 
       alter column notes set data type TEXT
2026-01-05 20:55:10.481 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists event_store 
       alter column aggregate_type set data type varchar(255)
2026-01-05 20:55:10.481 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists event_store 
       alter column event_data set data type TEXT
2026-01-05 20:55:10.481 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists payment_transactions 
       alter column notes set data type TEXT
2026-01-05 20:55:10.482 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists clients 
       drop constraint if exists idx_client_uuid
2026-01-05 20:55:10.482 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists clients 
       add constraint idx_client_uuid unique (uuid)
2026-01-05 20:55:10.482 DEBUG [main] [] org.hibernate.SQL                        : 
    create index idx_aggregate_id 
       on event_store (aggregate_id)
2026-01-05 20:55:10.483 DEBUG [main] [] org.hibernate.SQL                        : 
    create index idx_event_type 
       on event_store (event_type)
2026-01-05 20:55:10.483 DEBUG [main] [] org.hibernate.SQL                        : 
    create index idx_timestamp 
       on event_store (timestamp)
2026-01-05 20:55:10.483 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists users 
       drop constraint if exists idx_user_uuid
2026-01-05 20:55:10.483 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists users 
       add constraint idx_user_uuid unique (uuid)
2026-01-05 20:55:10.486  INFO [main] [] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2026-01-05 20:55:10.614 DEBUG [main] [] c.w.security.JwtAuthenticationFilter     : Filter 'jwtAuthenticationFilter' configured for use
2026-01-05 20:55:10.614 DEBUG [main] [] com.westwood.config.RequestIdFilter      : Filter 'requestIdFilter' configured for use
2026-01-05 20:55:10.631  INFO [main] [] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2026-01-05 20:55:10.919  INFO [main] [] eAuthenticationProviderManagerConfigurer : Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2026-01-05 20:55:10.920  WARN [main] [] r$InitializeUserDetailsManagerConfigurer : Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used for username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider.
2026-01-05 20:55:10.967  WARN [main] [] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2026-01-05 20:55:11.078 DEBUG [main] [] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2026-01-05 20:55:11.198  INFO [main] [] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2026-01-05 20:55:11.202  INFO [main] [] c.westwood.WestwoodBackendApplication    : Started WestwoodBackendApplication in 2.315 seconds (process running for 2.466)
2026-01-05 20:56:23.605  INFO [http-nio-8080-exec-1] [] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2026-01-05 20:56:23.606  INFO [http-nio-8080-exec-1] [] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2026-01-05 20:56:23.612  INFO [http-nio-8080-exec-1] [] o.s.web.servlet.DispatcherServlet        : Completed initialization in 6 ms
2026-01-05 20:56:23.621 DEBUG [http-nio-8080-exec-1] [3d844d06-41e7-4c77-8a5e-eb20b0772258] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/auth/login
2026-01-05 20:56:23.624 DEBUG [http-nio-8080-exec-1] [3d844d06-41e7-4c77-8a5e-eb20b0772258] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2026-01-05 20:56:23.625 DEBUG [http-nio-8080-exec-1] [3d844d06-41e7-4c77-8a5e-eb20b0772258] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/auth/login
2026-01-05 20:56:23.763 DEBUG [http-nio-8080-exec-1] [3d844d06-41e7-4c77-8a5e-eb20b0772258] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 20:56:23.840 DEBUG [http-nio-8080-exec-1] [3d844d06-41e7-4c77-8a5e-eb20b0772258] o.s.s.a.dao.DaoAuthenticationProvider    : Failed to find user 'test'
2026-01-05 20:57:14.156  INFO [main] [] c.westwood.WestwoodBackendApplication    : Starting WestwoodBackendApplication using Java 17.0.10 with PID 84678 (/Users/baglan/repo/westwood-backend/target/classes started by baglan in /Users/baglan/repo/westwood-backend)
2026-01-05 20:57:14.158 DEBUG [main] [] c.westwood.WestwoodBackendApplication    : Running with Spring Boot v3.3.5, Spring v6.1.14
2026-01-05 20:57:14.158  INFO [main] [] c.westwood.WestwoodBackendApplication    : The following 1 profile is active: "dev"
2026-01-05 20:57:14.388  INFO [main] [] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2026-01-05 20:57:14.409  INFO [main] [] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 17 ms. Found 6 JPA repository interfaces.
2026-01-05 20:57:14.772  INFO [main] [] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-01-05 20:57:14.782  INFO [main] [] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-01-05 20:57:14.782  INFO [main] [] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.31]
2026-01-05 20:57:14.828  INFO [main] [] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2026-01-05 20:57:14.829  INFO [main] [] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 652 ms
2026-01-05 20:57:14.852  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-01-05 20:57:14.938  INFO [main] [] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:devdb user=SA
2026-01-05 20:57:14.939  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-01-05 20:57:14.944  INFO [main] [] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:devdb'
2026-01-05 20:57:15.039  INFO [main] [] org.flywaydb.core.FlywayExecutor         : Database: jdbc:h2:mem:devdb (H2 2.2)
2026-01-05 20:57:15.041  WARN [main] [] o.f.c.internal.database.base.Database    : Flyway upgrade recommended: H2 2.2.224 is newer than this version of Flyway and support has not been tested. The latest supported version of H2 is 2.2.220.
2026-01-05 20:57:15.051  INFO [main] [] o.f.c.i.s.JdbcTableSchemaHistory         : Schema history table "PUBLIC"."flyway_schema_history" does not exist yet
2026-01-05 20:57:15.052  INFO [main] [] o.f.core.internal.command.DbValidate     : Successfully validated 8 migrations (execution time 00:00.006s)
2026-01-05 20:57:15.055  INFO [main] [] o.f.c.i.s.JdbcTableSchemaHistory         : Creating Schema History table "PUBLIC"."flyway_schema_history" ...
2026-01-05 20:57:15.070  INFO [main] [] o.f.core.internal.command.DbMigrate      : Current version of schema "PUBLIC": << Empty Schema >>
2026-01-05 20:57:15.073  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "0 - create clients table"
2026-01-05 20:57:15.085  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "1 - create users table"
2026-01-05 20:57:15.090  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "2 - create payment transactions table"
2026-01-05 20:57:15.096  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "3 - create bonus events table"
2026-01-05 20:57:15.102  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "4 - create bonus configuration table"
2026-01-05 20:57:15.105  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "5 - create event store table"
2026-01-05 20:57:15.113  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "6 - add uuid to clients and users"
2026-01-05 20:57:15.126  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "7 - add user activation fields"
2026-01-05 20:57:15.142  INFO [main] [] o.f.core.internal.command.DbMigrate      : Successfully applied 8 migrations to schema "PUBLIC", now at version v7 (execution time 00:00.038s)
2026-01-05 20:57:15.249  INFO [main] [] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2026-01-05 20:57:15.290  INFO [main] [] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.5.3.Final
2026-01-05 20:57:15.305  INFO [main] [] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2026-01-05 20:57:15.437  INFO [main] [] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2026-01-05 20:57:15.454  WARN [main] [] org.hibernate.orm.deprecation            : HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2026-01-05 20:57:15.510  WARN [main] [] o.h.boot.model.internal.EntityBinder     : HHH000457: Joined inheritance hierarchy [com.westwood.domain.BonusEvent] defined explicit @DiscriminatorColumn.  Legacy Hibernate behavior was to ignore the @DiscriminatorColumn.  However, as part of issue HHH-6911 we now apply the explicit @DiscriminatorColumn.  If you would prefer the legacy behavior, enable the `hibernate.discriminator.ignore_explicit_for_joined` setting (hibernate.discriminator.ignore_explicit_for_joined=true)
2026-01-05 20:57:15.869  INFO [main] [] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2026-01-05 20:57:15.880 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists bonus_configurations 
       alter column description set data type TEXT
2026-01-05 20:57:15.880 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists bonus_events 
       alter column event_type set data type varchar(31)
2026-01-05 20:57:15.882 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists client_tags 
       alter column tag set data type varchar(255)
2026-01-05 20:57:15.883 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists clients 
       alter column notes set data type TEXT
2026-01-05 20:57:15.884 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists event_store 
       alter column aggregate_type set data type varchar(255)
2026-01-05 20:57:15.884 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists event_store 
       alter column event_data set data type TEXT
2026-01-05 20:57:15.884 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists payment_transactions 
       alter column notes set data type TEXT
2026-01-05 20:57:15.885 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists clients 
       drop constraint if exists idx_client_uuid
2026-01-05 20:57:15.885 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists clients 
       add constraint idx_client_uuid unique (uuid)
2026-01-05 20:57:15.886 DEBUG [main] [] org.hibernate.SQL                        : 
    create index idx_aggregate_id 
       on event_store (aggregate_id)
2026-01-05 20:57:15.886 DEBUG [main] [] org.hibernate.SQL                        : 
    create index idx_event_type 
       on event_store (event_type)
2026-01-05 20:57:15.886 DEBUG [main] [] org.hibernate.SQL                        : 
    create index idx_timestamp 
       on event_store (timestamp)
2026-01-05 20:57:15.886 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists users 
       drop constraint if exists idx_user_uuid
2026-01-05 20:57:15.886 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists users 
       add constraint idx_user_uuid unique (uuid)
2026-01-05 20:57:15.890  INFO [main] [] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2026-01-05 20:57:16.029 DEBUG [main] [] c.w.security.JwtAuthenticationFilter     : Filter 'jwtAuthenticationFilter' configured for use
2026-01-05 20:57:16.029 DEBUG [main] [] com.westwood.config.RequestIdFilter      : Filter 'requestIdFilter' configured for use
2026-01-05 20:57:16.051  INFO [main] [] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2026-01-05 20:57:16.376  INFO [main] [] eAuthenticationProviderManagerConfigurer : Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2026-01-05 20:57:16.376  WARN [main] [] r$InitializeUserDetailsManagerConfigurer : Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used for username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider.
2026-01-05 20:57:16.424  WARN [main] [] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2026-01-05 20:57:16.528 DEBUG [main] [] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2026-01-05 20:57:16.622  WARN [main] [] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'
2026-01-05 20:57:16.624  INFO [main] [] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2026-01-05 20:57:16.625  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2026-01-05 20:57:16.626  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2026-01-05 20:57:16.631  INFO [main] [] .s.b.a.l.ConditionEvaluationReportLogger : 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2026-01-05 20:57:16.636 ERROR [main] [] o.s.b.d.LoggingFailureAnalysisReporter   : 

***************************
APPLICATION FAILED TO START
***************************

Description:

Web server failed to start. Port 8080 was already in use.

Action:

Identify and stop the process that's listening on port 8080 or configure this application to listen on another port.

2026-01-05 20:57:26.192  INFO [main] [] c.westwood.WestwoodBackendApplication    : Starting WestwoodBackendApplication using Java 17.0.10 with PID 85196 (/Users/baglan/repo/westwood-backend/target/classes started by baglan in /Users/baglan/repo/westwood-backend)
2026-01-05 20:57:26.193 DEBUG [main] [] c.westwood.WestwoodBackendApplication    : Running with Spring Boot v3.3.5, Spring v6.1.14
2026-01-05 20:57:26.193  INFO [main] [] c.westwood.WestwoodBackendApplication    : The following 1 profile is active: "dev"
2026-01-05 20:57:26.404  INFO [main] [] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2026-01-05 20:57:26.425  INFO [main] [] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 15 ms. Found 6 JPA repository interfaces.
2026-01-05 20:57:26.758  INFO [main] [] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-01-05 20:57:26.763  INFO [main] [] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-01-05 20:57:26.764  INFO [main] [] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.31]
2026-01-05 20:57:26.791  INFO [main] [] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2026-01-05 20:57:26.792  INFO [main] [] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 583 ms
2026-01-05 20:57:26.811  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-01-05 20:57:26.885  INFO [main] [] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:devdb user=SA
2026-01-05 20:57:26.886  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-01-05 20:57:26.890  INFO [main] [] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:devdb'
2026-01-05 20:57:26.976  INFO [main] [] org.flywaydb.core.FlywayExecutor         : Database: jdbc:h2:mem:devdb (H2 2.2)
2026-01-05 20:57:26.978  WARN [main] [] o.f.c.internal.database.base.Database    : Flyway upgrade recommended: H2 2.2.224 is newer than this version of Flyway and support has not been tested. The latest supported version of H2 is 2.2.220.
2026-01-05 20:57:26.986  INFO [main] [] o.f.c.i.s.JdbcTableSchemaHistory         : Schema history table "PUBLIC"."flyway_schema_history" does not exist yet
2026-01-05 20:57:26.987  INFO [main] [] o.f.core.internal.command.DbValidate     : Successfully validated 8 migrations (execution time 00:00.006s)
2026-01-05 20:57:26.990  INFO [main] [] o.f.c.i.s.JdbcTableSchemaHistory         : Creating Schema History table "PUBLIC"."flyway_schema_history" ...
2026-01-05 20:57:27.005  INFO [main] [] o.f.core.internal.command.DbMigrate      : Current version of schema "PUBLIC": << Empty Schema >>
2026-01-05 20:57:27.011  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "0 - create clients table"
2026-01-05 20:57:27.023  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "1 - create users table"
2026-01-05 20:57:27.030  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "2 - create payment transactions table"
2026-01-05 20:57:27.036  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "3 - create bonus events table"
2026-01-05 20:57:27.042  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "4 - create bonus configuration table"
2026-01-05 20:57:27.045  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "5 - create event store table"
2026-01-05 20:57:27.048  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "6 - add uuid to clients and users"
2026-01-05 20:57:27.057  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "7 - add user activation fields"
2026-01-05 20:57:27.071  INFO [main] [] o.f.core.internal.command.DbMigrate      : Successfully applied 8 migrations to schema "PUBLIC", now at version v7 (execution time 00:00.033s)
2026-01-05 20:57:27.108  INFO [main] [] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2026-01-05 20:57:27.127  INFO [main] [] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.5.3.Final
2026-01-05 20:57:27.139  INFO [main] [] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2026-01-05 20:57:27.239  INFO [main] [] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2026-01-05 20:57:27.254  WARN [main] [] org.hibernate.orm.deprecation            : HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2026-01-05 20:57:27.307  WARN [main] [] o.h.boot.model.internal.EntityBinder     : HHH000457: Joined inheritance hierarchy [com.westwood.domain.BonusEvent] defined explicit @DiscriminatorColumn.  Legacy Hibernate behavior was to ignore the @DiscriminatorColumn.  However, as part of issue HHH-6911 we now apply the explicit @DiscriminatorColumn.  If you would prefer the legacy behavior, enable the `hibernate.discriminator.ignore_explicit_for_joined` setting (hibernate.discriminator.ignore_explicit_for_joined=true)
2026-01-05 20:57:27.661  INFO [main] [] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2026-01-05 20:57:27.673 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists bonus_configurations 
       alter column description set data type TEXT
2026-01-05 20:57:27.674 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists bonus_events 
       alter column event_type set data type varchar(31)
2026-01-05 20:57:27.675 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists client_tags 
       alter column tag set data type varchar(255)
2026-01-05 20:57:27.676 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists clients 
       alter column notes set data type TEXT
2026-01-05 20:57:27.676 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists event_store 
       alter column aggregate_type set data type varchar(255)
2026-01-05 20:57:27.676 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists event_store 
       alter column event_data set data type TEXT
2026-01-05 20:57:27.677 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists payment_transactions 
       alter column notes set data type TEXT
2026-01-05 20:57:27.678 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists clients 
       drop constraint if exists idx_client_uuid
2026-01-05 20:57:27.678 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists clients 
       add constraint idx_client_uuid unique (uuid)
2026-01-05 20:57:27.679 DEBUG [main] [] org.hibernate.SQL                        : 
    create index idx_aggregate_id 
       on event_store (aggregate_id)
2026-01-05 20:57:27.679 DEBUG [main] [] org.hibernate.SQL                        : 
    create index idx_event_type 
       on event_store (event_type)
2026-01-05 20:57:27.679 DEBUG [main] [] org.hibernate.SQL                        : 
    create index idx_timestamp 
       on event_store (timestamp)
2026-01-05 20:57:27.680 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists users 
       drop constraint if exists idx_user_uuid
2026-01-05 20:57:27.680 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists users 
       add constraint idx_user_uuid unique (uuid)
2026-01-05 20:57:27.684  INFO [main] [] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2026-01-05 20:57:27.828 DEBUG [main] [] c.w.security.JwtAuthenticationFilter     : Filter 'jwtAuthenticationFilter' configured for use
2026-01-05 20:57:27.828 DEBUG [main] [] com.westwood.config.RequestIdFilter      : Filter 'requestIdFilter' configured for use
2026-01-05 20:57:27.847  INFO [main] [] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2026-01-05 20:57:28.195  INFO [main] [] eAuthenticationProviderManagerConfigurer : Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2026-01-05 20:57:28.196  WARN [main] [] r$InitializeUserDetailsManagerConfigurer : Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used for username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider.
2026-01-05 20:57:28.258  WARN [main] [] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2026-01-05 20:57:28.362 DEBUG [main] [] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2026-01-05 20:57:28.462  WARN [main] [] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'
2026-01-05 20:57:28.464  INFO [main] [] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2026-01-05 20:57:28.465  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2026-01-05 20:57:28.465  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2026-01-05 20:57:28.473  INFO [main] [] .s.b.a.l.ConditionEvaluationReportLogger : 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2026-01-05 20:57:28.480 ERROR [main] [] o.s.b.d.LoggingFailureAnalysisReporter   : 

***************************
APPLICATION FAILED TO START
***************************

Description:

Web server failed to start. Port 8080 was already in use.

Action:

Identify and stop the process that's listening on port 8080 or configure this application to listen on another port.

2026-01-05 20:57:56.941  INFO [main] [] c.westwood.WestwoodBackendApplication    : Starting WestwoodBackendApplication using Java 17.0.10 with PID 85723 (/Users/baglan/repo/westwood-backend/target/classes started by baglan in /Users/baglan/repo/westwood-backend)
2026-01-05 20:57:56.942 DEBUG [main] [] c.westwood.WestwoodBackendApplication    : Running with Spring Boot v3.3.5, Spring v6.1.14
2026-01-05 20:57:56.942  INFO [main] [] c.westwood.WestwoodBackendApplication    : The following 1 profile is active: "dev"
2026-01-05 20:57:57.182  INFO [main] [] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2026-01-05 20:57:57.204  INFO [main] [] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 18 ms. Found 6 JPA repository interfaces.
2026-01-05 20:57:57.565  INFO [main] [] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-01-05 20:57:57.572  INFO [main] [] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-01-05 20:57:57.572  INFO [main] [] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.31]
2026-01-05 20:57:57.602  INFO [main] [] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2026-01-05 20:57:57.603  INFO [main] [] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 643 ms
2026-01-05 20:57:57.623  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-01-05 20:57:57.719  INFO [main] [] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:devdb user=SA
2026-01-05 20:57:57.720  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-01-05 20:57:57.725  INFO [main] [] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:devdb'
2026-01-05 20:57:57.819  INFO [main] [] org.flywaydb.core.FlywayExecutor         : Database: jdbc:h2:mem:devdb (H2 2.2)
2026-01-05 20:57:57.821  WARN [main] [] o.f.c.internal.database.base.Database    : Flyway upgrade recommended: H2 2.2.224 is newer than this version of Flyway and support has not been tested. The latest supported version of H2 is 2.2.220.
2026-01-05 20:57:57.830  INFO [main] [] o.f.c.i.s.JdbcTableSchemaHistory         : Schema history table "PUBLIC"."flyway_schema_history" does not exist yet
2026-01-05 20:57:57.831  INFO [main] [] o.f.core.internal.command.DbValidate     : Successfully validated 8 migrations (execution time 00:00.007s)
2026-01-05 20:57:57.834  INFO [main] [] o.f.c.i.s.JdbcTableSchemaHistory         : Creating Schema History table "PUBLIC"."flyway_schema_history" ...
2026-01-05 20:57:57.848  INFO [main] [] o.f.core.internal.command.DbMigrate      : Current version of schema "PUBLIC": << Empty Schema >>
2026-01-05 20:57:57.851  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "0 - create clients table"
2026-01-05 20:57:57.863  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "1 - create users table"
2026-01-05 20:57:57.868  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "2 - create payment transactions table"
2026-01-05 20:57:57.873  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "3 - create bonus events table"
2026-01-05 20:57:57.879  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "4 - create bonus configuration table"
2026-01-05 20:57:57.882  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "5 - create event store table"
2026-01-05 20:57:57.885  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "6 - add uuid to clients and users"
2026-01-05 20:57:57.895  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "7 - add user activation fields"
2026-01-05 20:57:57.908  INFO [main] [] o.f.core.internal.command.DbMigrate      : Successfully applied 8 migrations to schema "PUBLIC", now at version v7 (execution time 00:00.031s)
2026-01-05 20:57:57.944  INFO [main] [] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2026-01-05 20:57:57.974  INFO [main] [] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.5.3.Final
2026-01-05 20:57:57.989  INFO [main] [] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2026-01-05 20:57:58.099  INFO [main] [] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2026-01-05 20:57:58.116  WARN [main] [] org.hibernate.orm.deprecation            : HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2026-01-05 20:57:58.170  WARN [main] [] o.h.boot.model.internal.EntityBinder     : HHH000457: Joined inheritance hierarchy [com.westwood.domain.BonusEvent] defined explicit @DiscriminatorColumn.  Legacy Hibernate behavior was to ignore the @DiscriminatorColumn.  However, as part of issue HHH-6911 we now apply the explicit @DiscriminatorColumn.  If you would prefer the legacy behavior, enable the `hibernate.discriminator.ignore_explicit_for_joined` setting (hibernate.discriminator.ignore_explicit_for_joined=true)
2026-01-05 20:57:58.540  INFO [main] [] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2026-01-05 20:57:58.550 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists bonus_configurations 
       alter column description set data type TEXT
2026-01-05 20:57:58.551 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists bonus_events 
       alter column event_type set data type varchar(31)
2026-01-05 20:57:58.551 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists client_tags 
       alter column tag set data type varchar(255)
2026-01-05 20:57:58.552 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists clients 
       alter column notes set data type TEXT
2026-01-05 20:57:58.552 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists event_store 
       alter column aggregate_type set data type varchar(255)
2026-01-05 20:57:58.552 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists event_store 
       alter column event_data set data type TEXT
2026-01-05 20:57:58.552 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists payment_transactions 
       alter column notes set data type TEXT
2026-01-05 20:57:58.553 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists clients 
       drop constraint if exists idx_client_uuid
2026-01-05 20:57:58.553 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists clients 
       add constraint idx_client_uuid unique (uuid)
2026-01-05 20:57:58.554 DEBUG [main] [] org.hibernate.SQL                        : 
    create index idx_aggregate_id 
       on event_store (aggregate_id)
2026-01-05 20:57:58.554 DEBUG [main] [] org.hibernate.SQL                        : 
    create index idx_event_type 
       on event_store (event_type)
2026-01-05 20:57:58.554 DEBUG [main] [] org.hibernate.SQL                        : 
    create index idx_timestamp 
       on event_store (timestamp)
2026-01-05 20:57:58.554 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists users 
       drop constraint if exists idx_user_uuid
2026-01-05 20:57:58.554 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists users 
       add constraint idx_user_uuid unique (uuid)
2026-01-05 20:57:58.558  INFO [main] [] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2026-01-05 20:57:58.695 DEBUG [main] [] c.w.security.JwtAuthenticationFilter     : Filter 'jwtAuthenticationFilter' configured for use
2026-01-05 20:57:58.696 DEBUG [main] [] com.westwood.config.RequestIdFilter      : Filter 'requestIdFilter' configured for use
2026-01-05 20:57:58.719  INFO [main] [] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2026-01-05 20:57:59.041  INFO [main] [] eAuthenticationProviderManagerConfigurer : Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2026-01-05 20:57:59.041  WARN [main] [] r$InitializeUserDetailsManagerConfigurer : Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used for username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider.
2026-01-05 20:57:59.095  WARN [main] [] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2026-01-05 20:57:59.197 DEBUG [main] [] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2026-01-05 20:57:59.304  WARN [main] [] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'
2026-01-05 20:57:59.306  INFO [main] [] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2026-01-05 20:57:59.307  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2026-01-05 20:57:59.308  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2026-01-05 20:57:59.314  INFO [main] [] .s.b.a.l.ConditionEvaluationReportLogger : 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2026-01-05 20:57:59.320 ERROR [main] [] o.s.b.d.LoggingFailureAnalysisReporter   : 

***************************
APPLICATION FAILED TO START
***************************

Description:

Web server failed to start. Port 8080 was already in use.

Action:

Identify and stop the process that's listening on port 8080 or configure this application to listen on another port.

2026-01-05 20:58:50.576  INFO [main] [] c.westwood.WestwoodBackendApplication    : Starting WestwoodBackendApplication using Java 17.0.10 with PID 87277 (/Users/baglan/repo/westwood-backend/target/classes started by baglan in /Users/baglan/repo/westwood-backend)
2026-01-05 20:58:50.577 DEBUG [main] [] c.westwood.WestwoodBackendApplication    : Running with Spring Boot v3.3.5, Spring v6.1.14
2026-01-05 20:58:50.577  INFO [main] [] c.westwood.WestwoodBackendApplication    : The following 1 profile is active: "dev"
2026-01-05 20:58:50.831  INFO [main] [] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2026-01-05 20:58:50.853  INFO [main] [] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 18 ms. Found 6 JPA repository interfaces.
2026-01-05 20:58:51.217  INFO [main] [] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-01-05 20:58:51.223  INFO [main] [] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-01-05 20:58:51.223  INFO [main] [] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.31]
2026-01-05 20:58:51.255  INFO [main] [] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2026-01-05 20:58:51.256  INFO [main] [] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 660 ms
2026-01-05 20:58:51.275  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-01-05 20:58:51.362  INFO [main] [] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:devdb user=SA
2026-01-05 20:58:51.363  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-01-05 20:58:51.367  INFO [main] [] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:devdb'
2026-01-05 20:58:51.479  INFO [main] [] org.flywaydb.core.FlywayExecutor         : Database: jdbc:h2:mem:devdb (H2 2.2)
2026-01-05 20:58:51.482  WARN [main] [] o.f.c.internal.database.base.Database    : Flyway upgrade recommended: H2 2.2.224 is newer than this version of Flyway and support has not been tested. The latest supported version of H2 is 2.2.220.
2026-01-05 20:58:51.494  INFO [main] [] o.f.c.i.s.JdbcTableSchemaHistory         : Schema history table "PUBLIC"."flyway_schema_history" does not exist yet
2026-01-05 20:58:51.496  INFO [main] [] o.f.core.internal.command.DbValidate     : Successfully validated 8 migrations (execution time 00:00.008s)
2026-01-05 20:58:51.500  INFO [main] [] o.f.c.i.s.JdbcTableSchemaHistory         : Creating Schema History table "PUBLIC"."flyway_schema_history" ...
2026-01-05 20:58:51.523  INFO [main] [] o.f.core.internal.command.DbMigrate      : Current version of schema "PUBLIC": << Empty Schema >>
2026-01-05 20:58:51.526  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "0 - create clients table"
2026-01-05 20:58:51.536  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "1 - create users table"
2026-01-05 20:58:51.541  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "2 - create payment transactions table"
2026-01-05 20:58:51.547  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "3 - create bonus events table"
2026-01-05 20:58:51.552  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "4 - create bonus configuration table"
2026-01-05 20:58:51.555  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "5 - create event store table"
2026-01-05 20:58:51.558  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "6 - add uuid to clients and users"
2026-01-05 20:58:51.569  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "7 - add user activation fields"
2026-01-05 20:58:51.582  INFO [main] [] o.f.core.internal.command.DbMigrate      : Successfully applied 8 migrations to schema "PUBLIC", now at version v7 (execution time 00:00.032s)
2026-01-05 20:58:51.623  INFO [main] [] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2026-01-05 20:58:51.654  INFO [main] [] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.5.3.Final
2026-01-05 20:58:51.671  INFO [main] [] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2026-01-05 20:58:51.793  INFO [main] [] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2026-01-05 20:58:51.813  WARN [main] [] org.hibernate.orm.deprecation            : HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2026-01-05 20:58:51.869  WARN [main] [] o.h.boot.model.internal.EntityBinder     : HHH000457: Joined inheritance hierarchy [com.westwood.domain.BonusEvent] defined explicit @DiscriminatorColumn.  Legacy Hibernate behavior was to ignore the @DiscriminatorColumn.  However, as part of issue HHH-6911 we now apply the explicit @DiscriminatorColumn.  If you would prefer the legacy behavior, enable the `hibernate.discriminator.ignore_explicit_for_joined` setting (hibernate.discriminator.ignore_explicit_for_joined=true)
2026-01-05 20:58:52.226  INFO [main] [] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2026-01-05 20:58:52.237 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists bonus_configurations 
       alter column description set data type TEXT
2026-01-05 20:58:52.238 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists bonus_events 
       alter column event_type set data type varchar(31)
2026-01-05 20:58:52.239 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists client_tags 
       alter column tag set data type varchar(255)
2026-01-05 20:58:52.240 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists clients 
       alter column notes set data type TEXT
2026-01-05 20:58:52.243 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists event_store 
       alter column aggregate_type set data type varchar(255)
2026-01-05 20:58:52.244 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists event_store 
       alter column event_data set data type TEXT
2026-01-05 20:58:52.244 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists payment_transactions 
       alter column notes set data type TEXT
2026-01-05 20:58:52.245 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists clients 
       drop constraint if exists idx_client_uuid
2026-01-05 20:58:52.245 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists clients 
       add constraint idx_client_uuid unique (uuid)
2026-01-05 20:58:52.245 DEBUG [main] [] org.hibernate.SQL                        : 
    create index idx_aggregate_id 
       on event_store (aggregate_id)
2026-01-05 20:58:52.246 DEBUG [main] [] org.hibernate.SQL                        : 
    create index idx_event_type 
       on event_store (event_type)
2026-01-05 20:58:52.246 DEBUG [main] [] org.hibernate.SQL                        : 
    create index idx_timestamp 
       on event_store (timestamp)
2026-01-05 20:58:52.246 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists users 
       drop constraint if exists idx_user_uuid
2026-01-05 20:58:52.246 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists users 
       add constraint idx_user_uuid unique (uuid)
2026-01-05 20:58:52.250  INFO [main] [] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2026-01-05 20:58:52.383 DEBUG [main] [] c.w.security.JwtAuthenticationFilter     : Filter 'jwtAuthenticationFilter' configured for use
2026-01-05 20:58:52.383 DEBUG [main] [] com.westwood.config.RequestIdFilter      : Filter 'requestIdFilter' configured for use
2026-01-05 20:58:52.402  INFO [main] [] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2026-01-05 20:58:52.716  INFO [main] [] eAuthenticationProviderManagerConfigurer : Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2026-01-05 20:58:52.717  WARN [main] [] r$InitializeUserDetailsManagerConfigurer : Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used for username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider.
2026-01-05 20:58:52.812  WARN [main] [] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2026-01-05 20:58:52.920 DEBUG [main] [] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2026-01-05 20:58:53.025  WARN [main] [] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'
2026-01-05 20:58:53.027  INFO [main] [] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2026-01-05 20:58:53.028  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2026-01-05 20:58:53.029  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2026-01-05 20:58:53.035  INFO [main] [] .s.b.a.l.ConditionEvaluationReportLogger : 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2026-01-05 20:58:53.040 ERROR [main] [] o.s.b.d.LoggingFailureAnalysisReporter   : 

***************************
APPLICATION FAILED TO START
***************************

Description:

Web server failed to start. Port 8080 was already in use.

Action:

Identify and stop the process that's listening on port 8080 or configure this application to listen on another port.

2026-01-05 21:01:32.700  INFO [main] [] c.westwood.WestwoodBackendApplication    : Starting WestwoodBackendApplication using Java 17.0.10 with PID 87672 (/Users/baglan/repo/westwood-backend/target/classes started by baglan in /Users/baglan/repo/westwood-backend)
2026-01-05 21:01:32.701 DEBUG [main] [] c.westwood.WestwoodBackendApplication    : Running with Spring Boot v3.3.5, Spring v6.1.14
2026-01-05 21:01:32.702  INFO [main] [] c.westwood.WestwoodBackendApplication    : The following 1 profile is active: "dev"
2026-01-05 21:01:32.932  INFO [main] [] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2026-01-05 21:01:32.954  INFO [main] [] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 18 ms. Found 6 JPA repository interfaces.
2026-01-05 21:01:33.326  INFO [main] [] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-01-05 21:01:33.331  INFO [main] [] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-01-05 21:01:33.332  INFO [main] [] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.31]
2026-01-05 21:01:33.356  INFO [main] [] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2026-01-05 21:01:33.357  INFO [main] [] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 635 ms
2026-01-05 21:01:33.376  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-01-05 21:01:33.453  INFO [main] [] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:devdb user=SA
2026-01-05 21:01:33.454  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-01-05 21:01:33.458  INFO [main] [] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:devdb'
2026-01-05 21:01:33.548  INFO [main] [] org.flywaydb.core.FlywayExecutor         : Database: jdbc:h2:mem:devdb (H2 2.2)
2026-01-05 21:01:33.550  WARN [main] [] o.f.c.internal.database.base.Database    : Flyway upgrade recommended: H2 2.2.224 is newer than this version of Flyway and support has not been tested. The latest supported version of H2 is 2.2.220.
2026-01-05 21:01:33.558  INFO [main] [] o.f.c.i.s.JdbcTableSchemaHistory         : Schema history table "PUBLIC"."flyway_schema_history" does not exist yet
2026-01-05 21:01:33.560  INFO [main] [] o.f.core.internal.command.DbValidate     : Successfully validated 8 migrations (execution time 00:00.006s)
2026-01-05 21:01:33.563  INFO [main] [] o.f.c.i.s.JdbcTableSchemaHistory         : Creating Schema History table "PUBLIC"."flyway_schema_history" ...
2026-01-05 21:01:33.578  INFO [main] [] o.f.core.internal.command.DbMigrate      : Current version of schema "PUBLIC": << Empty Schema >>
2026-01-05 21:01:33.582  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "0 - create clients table"
2026-01-05 21:01:33.593  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "1 - create users table"
2026-01-05 21:01:33.600  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "2 - create payment transactions table"
2026-01-05 21:01:33.605  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "3 - create bonus events table"
2026-01-05 21:01:33.611  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "4 - create bonus configuration table"
2026-01-05 21:01:33.615  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "5 - create event store table"
2026-01-05 21:01:33.618  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "6 - add uuid to clients and users"
2026-01-05 21:01:33.627  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "7 - add user activation fields"
2026-01-05 21:01:33.642  INFO [main] [] o.f.core.internal.command.DbMigrate      : Successfully applied 8 migrations to schema "PUBLIC", now at version v7 (execution time 00:00.034s)
2026-01-05 21:01:33.678  INFO [main] [] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2026-01-05 21:01:33.705  INFO [main] [] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.5.3.Final
2026-01-05 21:01:33.719  INFO [main] [] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2026-01-05 21:01:33.836  INFO [main] [] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2026-01-05 21:01:33.854  WARN [main] [] org.hibernate.orm.deprecation            : HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2026-01-05 21:01:33.910  WARN [main] [] o.h.boot.model.internal.EntityBinder     : HHH000457: Joined inheritance hierarchy [com.westwood.domain.BonusEvent] defined explicit @DiscriminatorColumn.  Legacy Hibernate behavior was to ignore the @DiscriminatorColumn.  However, as part of issue HHH-6911 we now apply the explicit @DiscriminatorColumn.  If you would prefer the legacy behavior, enable the `hibernate.discriminator.ignore_explicit_for_joined` setting (hibernate.discriminator.ignore_explicit_for_joined=true)
2026-01-05 21:01:34.275  INFO [main] [] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2026-01-05 21:01:34.286 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists bonus_configurations 
       alter column description set data type TEXT
2026-01-05 21:01:34.287 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists bonus_events 
       alter column event_type set data type varchar(31)
2026-01-05 21:01:34.287 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists client_tags 
       alter column tag set data type varchar(255)
2026-01-05 21:01:34.289 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists clients 
       alter column notes set data type TEXT
2026-01-05 21:01:34.291 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists event_store 
       alter column aggregate_type set data type varchar(255)
2026-01-05 21:01:34.291 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists event_store 
       alter column event_data set data type TEXT
2026-01-05 21:01:34.291 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists payment_transactions 
       alter column notes set data type TEXT
2026-01-05 21:01:34.292 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists clients 
       drop constraint if exists idx_client_uuid
2026-01-05 21:01:34.293 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists clients 
       add constraint idx_client_uuid unique (uuid)
2026-01-05 21:01:34.293 DEBUG [main] [] org.hibernate.SQL                        : 
    create index idx_aggregate_id 
       on event_store (aggregate_id)
2026-01-05 21:01:34.293 DEBUG [main] [] org.hibernate.SQL                        : 
    create index idx_event_type 
       on event_store (event_type)
2026-01-05 21:01:34.293 DEBUG [main] [] org.hibernate.SQL                        : 
    create index idx_timestamp 
       on event_store (timestamp)
2026-01-05 21:01:34.294 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists users 
       drop constraint if exists idx_user_uuid
2026-01-05 21:01:34.294 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists users 
       add constraint idx_user_uuid unique (uuid)
2026-01-05 21:01:34.299  INFO [main] [] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2026-01-05 21:01:34.455 DEBUG [main] [] c.w.security.JwtAuthenticationFilter     : Filter 'jwtAuthenticationFilter' configured for use
2026-01-05 21:01:34.455 DEBUG [main] [] com.westwood.config.RequestIdFilter      : Filter 'requestIdFilter' configured for use
2026-01-05 21:01:34.475  INFO [main] [] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2026-01-05 21:01:34.813  INFO [main] [] eAuthenticationProviderManagerConfigurer : Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2026-01-05 21:01:34.813  WARN [main] [] r$InitializeUserDetailsManagerConfigurer : Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used for username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider.
2026-01-05 21:01:34.865  WARN [main] [] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2026-01-05 21:01:34.964 DEBUG [main] [] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2026-01-05 21:01:35.071  INFO [main] [] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2026-01-05 21:01:35.076  INFO [main] [] c.westwood.WestwoodBackendApplication    : Started WestwoodBackendApplication in 2.651 seconds (process running for 2.869)
2026-01-05 21:05:11.824  INFO [http-nio-8080-exec-1] [] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2026-01-05 21:05:11.825  INFO [http-nio-8080-exec-1] [] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2026-01-05 21:05:11.836  INFO [http-nio-8080-exec-1] [] o.s.web.servlet.DispatcherServlet        : Completed initialization in 11 ms
2026-01-05 21:05:11.859 DEBUG [http-nio-8080-exec-1] [a4ef7b89-576a-4bb9-a02f-7f007122948b] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/auth/login
2026-01-05 21:05:11.866 DEBUG [http-nio-8080-exec-1] [a4ef7b89-576a-4bb9-a02f-7f007122948b] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2026-01-05 21:05:11.869 DEBUG [http-nio-8080-exec-1] [a4ef7b89-576a-4bb9-a02f-7f007122948b] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/auth/login
2026-01-05 21:05:12.098 DEBUG [http-nio-8080-exec-1] [a4ef7b89-576a-4bb9-a02f-7f007122948b] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 21:05:12.176 DEBUG [http-nio-8080-exec-1] [a4ef7b89-576a-4bb9-a02f-7f007122948b] o.s.s.a.dao.DaoAuthenticationProvider    : Failed to find user 'admin'
2026-01-05 21:05:16.209 DEBUG [http-nio-8080-exec-3] [8d42912e-3e3f-4617-aec6-968b61fa0d41] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/auth/register
2026-01-05 21:05:16.211 DEBUG [http-nio-8080-exec-3] [8d42912e-3e3f-4617-aec6-968b61fa0d41] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2026-01-05 21:05:16.212 DEBUG [http-nio-8080-exec-3] [8d42912e-3e3f-4617-aec6-968b61fa0d41] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/auth/register
2026-01-05 21:05:16.269 DEBUG [http-nio-8080-exec-3] [8d42912e-3e3f-4617-aec6-968b61fa0d41] org.hibernate.SQL                        : 
    select
        u1_0.id 
    from
        users u1_0 
    where
        u1_0.username=? 
    fetch
        first ? rows only
2026-01-05 21:05:16.272 DEBUG [http-nio-8080-exec-3] [8d42912e-3e3f-4617-aec6-968b61fa0d41] org.hibernate.SQL                        : 
    select
        u1_0.id 
    from
        users u1_0 
    where
        u1_0.email=? 
    fetch
        first ? rows only
2026-01-05 21:05:16.366 DEBUG [http-nio-8080-exec-3] [8d42912e-3e3f-4617-aec6-968b61fa0d41] org.hibernate.SQL                        : 
    insert 
    into
        users
        (account_status, activation_token, activation_token_expiry, active, created_at, email, first_name, last_name, password, updated_at, username, uuid, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 21:05:16.427 DEBUG [http-nio-8080-exec-3] [8d42912e-3e3f-4617-aec6-968b61fa0d41] org.hibernate.SQL                        : 
    insert 
    into
        user_roles
        (user_id, role) 
    values
        (?, ?)
2026-01-05 21:06:39.421 DEBUG [http-nio-8080-exec-6] [16ff10d0-a61e-4bc6-8994-0b3480f70f57] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/users/invite
2026-01-05 21:06:39.495 DEBUG [http-nio-8080-exec-6] [16ff10d0-a61e-4bc6-8994-0b3480f70f57] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 21:06:39.508 DEBUG [http-nio-8080-exec-6] [16ff10d0-a61e-4bc6-8994-0b3480f70f57] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 21:06:39.513 DEBUG [http-nio-8080-exec-6] [16ff10d0-a61e-4bc6-8994-0b3480f70f57] o.s.s.w.access.AccessDeniedHandlerImpl   : Responding with 403 status code
2026-01-05 21:06:39.519 DEBUG [http-nio-8080-exec-6] [] o.s.security.web.FilterChainProxy        : Securing POST /error
2026-01-05 21:06:39.519 DEBUG [http-nio-8080-exec-6] [] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2026-01-05 21:06:39.519 DEBUG [http-nio-8080-exec-6] [] o.s.s.w.a.Http403ForbiddenEntryPoint     : Pre-authenticated entry point called. Rejecting access
2026-01-05 21:06:54.150 DEBUG [http-nio-8080-exec-8] [56d349bb-aa9e-42db-8b97-b96444557242] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/auth/login
2026-01-05 21:06:54.165 DEBUG [http-nio-8080-exec-8] [56d349bb-aa9e-42db-8b97-b96444557242] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 21:06:54.171 DEBUG [http-nio-8080-exec-8] [56d349bb-aa9e-42db-8b97-b96444557242] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 21:06:54.180 DEBUG [http-nio-8080-exec-8] [56d349bb-aa9e-42db-8b97-b96444557242] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/auth/login
2026-01-05 21:06:54.203 DEBUG [http-nio-8080-exec-8] [56d349bb-aa9e-42db-8b97-b96444557242] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 21:06:54.205 DEBUG [http-nio-8080-exec-8] [56d349bb-aa9e-42db-8b97-b96444557242] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 21:06:54.303 DEBUG [http-nio-8080-exec-8] [56d349bb-aa9e-42db-8b97-b96444557242] o.s.s.a.dao.DaoAuthenticationProvider    : Authenticated user
2026-01-05 21:07:09.926 DEBUG [http-nio-8080-exec-9] [d81d3e07-7e33-4910-8624-2f26f7f40b2e] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/users/invite
2026-01-05 21:07:09.943 DEBUG [http-nio-8080-exec-9] [d81d3e07-7e33-4910-8624-2f26f7f40b2e] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 21:07:09.949 DEBUG [http-nio-8080-exec-9] [d81d3e07-7e33-4910-8624-2f26f7f40b2e] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 21:07:09.970 DEBUG [http-nio-8080-exec-9] [d81d3e07-7e33-4910-8624-2f26f7f40b2e] o.s.s.w.access.AccessDeniedHandlerImpl   : Responding with 403 status code
2026-01-05 21:07:09.973 DEBUG [http-nio-8080-exec-9] [] o.s.security.web.FilterChainProxy        : Securing POST /error
2026-01-05 21:07:09.974 DEBUG [http-nio-8080-exec-9] [] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2026-01-05 21:07:09.975 DEBUG [http-nio-8080-exec-9] [] o.s.s.w.a.Http403ForbiddenEntryPoint     : Pre-authenticated entry point called. Rejecting access
2026-01-05 21:07:41.070 DEBUG [http-nio-8080-exec-10] [4768ae69-8f0d-4365-97a7-8d53a6e96986] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/users/invite
2026-01-05 21:07:41.085 DEBUG [http-nio-8080-exec-10] [4768ae69-8f0d-4365-97a7-8d53a6e96986] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 21:07:41.089 DEBUG [http-nio-8080-exec-10] [4768ae69-8f0d-4365-97a7-8d53a6e96986] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 21:07:41.097 DEBUG [http-nio-8080-exec-10] [4768ae69-8f0d-4365-97a7-8d53a6e96986] o.s.s.w.access.AccessDeniedHandlerImpl   : Responding with 403 status code
2026-01-05 21:07:41.098 DEBUG [http-nio-8080-exec-10] [] o.s.security.web.FilterChainProxy        : Securing POST /error
2026-01-05 21:07:41.099 DEBUG [http-nio-8080-exec-10] [] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2026-01-05 21:07:41.099 DEBUG [http-nio-8080-exec-10] [] o.s.s.w.a.Http403ForbiddenEntryPoint     : Pre-authenticated entry point called. Rejecting access
2026-01-05 21:08:27.906 DEBUG [http-nio-8080-exec-2] [37a10581-11b5-4990-be13-5f1c74438454] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/bonus-configuration?bonusPercentage=10.0
2026-01-05 21:08:27.918 DEBUG [http-nio-8080-exec-2] [37a10581-11b5-4990-be13-5f1c74438454] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 21:08:27.921 DEBUG [http-nio-8080-exec-2] [37a10581-11b5-4990-be13-5f1c74438454] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 21:08:27.938 DEBUG [http-nio-8080-exec-2] [37a10581-11b5-4990-be13-5f1c74438454] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/bonus-configuration?bonusPercentage=10.0
2026-01-05 21:08:27.958 DEBUG [http-nio-8080-exec-2] [37a10581-11b5-4990-be13-5f1c74438454] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.BonusConfigurationController.createConfiguration(java.math.BigDecimal,java.lang.String); target is of class [com.westwood.controller.BonusConfigurationController]
2026-01-05 21:08:27.999 DEBUG [http-nio-8080-exec-2] [37a10581-11b5-4990-be13-5f1c74438454] horizationManagerBeforeMethodInterceptor : Failed to authorize ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.BonusConfigurationController.createConfiguration(java.math.BigDecimal,java.lang.String); target is of class [com.westwood.controller.BonusConfigurationController] with authorization manager org.springframework.security.authorization.method.PreAuthorizeAuthorizationManager@1e2a0f76 and decision ExpressionAuthorizationDecision [granted=false, expressionAttribute=hasAnyRole('SUDO', 'ADMIN')]
2026-01-05 21:09:04.627 DEBUG [http-nio-8080-exec-1] [07aac740-0930-4ff3-9210-f917522948cc] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/auth/register
2026-01-05 21:09:04.648 DEBUG [http-nio-8080-exec-1] [07aac740-0930-4ff3-9210-f917522948cc] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 21:09:04.651 DEBUG [http-nio-8080-exec-1] [07aac740-0930-4ff3-9210-f917522948cc] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 21:09:04.670 DEBUG [http-nio-8080-exec-1] [07aac740-0930-4ff3-9210-f917522948cc] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/auth/register
2026-01-05 21:09:40.239 DEBUG [http-nio-8080-exec-3] [0cd0e15d-009d-4f19-8e42-cc721b899456] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/auth/register
2026-01-05 21:09:40.258 DEBUG [http-nio-8080-exec-3] [0cd0e15d-009d-4f19-8e42-cc721b899456] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 21:09:40.260 DEBUG [http-nio-8080-exec-3] [0cd0e15d-009d-4f19-8e42-cc721b899456] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 21:09:40.264 DEBUG [http-nio-8080-exec-3] [0cd0e15d-009d-4f19-8e42-cc721b899456] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/auth/register
2026-01-05 21:09:40.294 DEBUG [http-nio-8080-exec-3] [0cd0e15d-009d-4f19-8e42-cc721b899456] org.hibernate.SQL                        : 
    select
        u1_0.id 
    from
        users u1_0 
    where
        u1_0.username=? 
    fetch
        first ? rows only
2026-01-05 21:09:40.296 DEBUG [http-nio-8080-exec-3] [0cd0e15d-009d-4f19-8e42-cc721b899456] org.hibernate.SQL                        : 
    select
        u1_0.id 
    from
        users u1_0 
    where
        u1_0.email=? 
    fetch
        first ? rows only
2026-01-05 21:09:40.366 DEBUG [http-nio-8080-exec-3] [0cd0e15d-009d-4f19-8e42-cc721b899456] org.hibernate.SQL                        : 
    insert 
    into
        users
        (account_status, activation_token, activation_token_expiry, active, created_at, email, first_name, last_name, password, updated_at, username, uuid, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 21:09:40.368 DEBUG [http-nio-8080-exec-3] [0cd0e15d-009d-4f19-8e42-cc721b899456] org.hibernate.SQL                        : 
    insert 
    into
        user_roles
        (user_id, role) 
    values
        (?, ?)
2026-01-05 21:09:40.368 DEBUG [http-nio-8080-exec-3] [0cd0e15d-009d-4f19-8e42-cc721b899456] org.hibernate.SQL                        : 
    insert 
    into
        user_roles
        (user_id, role) 
    values
        (?, ?)
2026-01-05 21:09:57.900 DEBUG [http-nio-8080-exec-7] [a101cb8a-62ed-4805-8d3f-09153de08fc9] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/bonus-configuration?bonusPercentage=10.0
2026-01-05 21:09:57.928 DEBUG [http-nio-8080-exec-7] [a101cb8a-62ed-4805-8d3f-09153de08fc9] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 21:09:57.933 DEBUG [http-nio-8080-exec-7] [a101cb8a-62ed-4805-8d3f-09153de08fc9] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 21:09:57.951 DEBUG [http-nio-8080-exec-7] [a101cb8a-62ed-4805-8d3f-09153de08fc9] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/bonus-configuration?bonusPercentage=10.0
2026-01-05 21:09:57.958 DEBUG [http-nio-8080-exec-7] [a101cb8a-62ed-4805-8d3f-09153de08fc9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.BonusConfigurationController.createConfiguration(java.math.BigDecimal,java.lang.String); target is of class [com.westwood.controller.BonusConfigurationController]
2026-01-05 21:09:57.962 DEBUG [http-nio-8080-exec-7] [a101cb8a-62ed-4805-8d3f-09153de08fc9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.BonusConfigurationController.createConfiguration(java.math.BigDecimal,java.lang.String); target is of class [com.westwood.controller.BonusConfigurationController]
2026-01-05 21:09:57.979 DEBUG [http-nio-8080-exec-7] [a101cb8a-62ed-4805-8d3f-09153de08fc9] org.hibernate.SQL                        : 
    select
        bc1_0.id,
        bc1_0.active,
        bc1_0.bonus_percentage,
        bc1_0.created_at,
        bc1_0.description,
        bc1_0.effective_from,
        bc1_0.effective_to,
        bc1_0.updated_at,
        bc1_0.version 
    from
        bonus_configurations bc1_0
2026-01-05 21:09:57.984 DEBUG [http-nio-8080-exec-7] [a101cb8a-62ed-4805-8d3f-09153de08fc9] org.hibernate.SQL                        : 
    insert 
    into
        bonus_configurations
        (active, bonus_percentage, created_at, description, effective_from, effective_to, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 21:10:02.873 DEBUG [http-nio-8080-exec-6] [08692981-de78-471f-b650-afa12bcef9ce] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/users/invite
2026-01-05 21:10:02.893 DEBUG [http-nio-8080-exec-6] [08692981-de78-471f-b650-afa12bcef9ce] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 21:10:02.898 DEBUG [http-nio-8080-exec-6] [08692981-de78-471f-b650-afa12bcef9ce] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 21:10:02.906 DEBUG [http-nio-8080-exec-6] [08692981-de78-471f-b650-afa12bcef9ce] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/users/invite
2026-01-05 21:10:02.943 DEBUG [http-nio-8080-exec-6] [08692981-de78-471f-b650-afa12bcef9ce] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.InvitationController.inviteUser(com.westwood.common.dto.InviteUserRequest); target is of class [com.westwood.controller.InvitationController]
2026-01-05 21:10:02.944 DEBUG [http-nio-8080-exec-6] [08692981-de78-471f-b650-afa12bcef9ce] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.InvitationController.inviteUser(com.westwood.common.dto.InviteUserRequest); target is of class [com.westwood.controller.InvitationController]
2026-01-05 21:10:02.947 DEBUG [http-nio-8080-exec-6] [08692981-de78-471f-b650-afa12bcef9ce] org.hibernate.SQL                        : 
    select
        u1_0.id 
    from
        users u1_0 
    where
        u1_0.email=? 
    fetch
        first ? rows only
2026-01-05 21:10:02.948 DEBUG [http-nio-8080-exec-6] [08692981-de78-471f-b650-afa12bcef9ce] org.hibernate.SQL                        : 
    select
        u1_0.id 
    from
        users u1_0 
    where
        u1_0.username=? 
    fetch
        first ? rows only
2026-01-05 21:10:03.016 DEBUG [http-nio-8080-exec-6] [08692981-de78-471f-b650-afa12bcef9ce] org.hibernate.SQL                        : 
    insert 
    into
        users
        (account_status, activation_token, activation_token_expiry, active, created_at, email, first_name, last_name, password, updated_at, username, uuid, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 21:10:03.018  INFO [http-nio-8080-exec-6] [08692981-de78-471f-b650-afa12bcef9ce] c.w.service.impl.InvitationServiceImpl   : User invited: email=baglansagidulladev@gmail.com, username=baglansagidulladev
2026-01-05 21:10:03.090 ERROR [http-nio-8080-exec-6] [08692981-de78-471f-b650-afa12bcef9ce] c.w.service.impl.EmailServiceImpl        : Unexpected error while sending invitation email to: baglansagidulladev@gmail.com

org.springframework.mail.MailAuthenticationException: Authentication failed
	at org.springframework.mail.javamail.JavaMailSenderImpl.doSend(JavaMailSenderImpl.java:402)
	at org.springframework.mail.javamail.JavaMailSenderImpl.send(JavaMailSenderImpl.java:350)
	at org.springframework.mail.javamail.JavaMailSender.send(JavaMailSender.java:101)
	at com.westwood.service.impl.EmailServiceImpl.sendInvitationEmail(EmailServiceImpl.java:49)
	at com.westwood.service.impl.InvitationServiceImpl.inviteUser(InvitationServiceImpl.java:89)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:355)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:379)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:720)
	at com.westwood.service.impl.InvitationServiceImpl$$SpringCGLIB$$0.inviteUser(<generated>)
	at com.westwood.controller.InvitationController.inviteUser(InvitationController.java:33)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:355)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768)
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.proceed(AuthorizationManagerBeforeMethodInterceptor.java:269)
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.attemptAuthorization(AuthorizationManagerBeforeMethodInterceptor.java:264)
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.invoke(AuthorizationManagerBeforeMethodInterceptor.java:197)
	at org.springframework.security.config.annotation.method.configuration.DeferringMethodInterceptor.invoke(DeferringMethodInterceptor.java:44)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:720)
	at com.westwood.controller.InvitationController$$SpringCGLIB$$0.inviteUser(<generated>)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:255)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:188)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:926)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:831)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:110)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:365)
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:100)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:131)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:85)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at com.westwood.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:61)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at com.westwood.config.RequestIdFilter.doFilterInternal(RequestIdFilter.java:47)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:384)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:905)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: jakarta.mail.AuthenticationFailedException: failed to connect, no password specified?
	at jakarta.mail.Service.connect(Service.java:379)
	at org.springframework.mail.javamail.JavaMailSenderImpl.connectTransport(JavaMailSenderImpl.java:480)
	at org.springframework.mail.javamail.JavaMailSenderImpl.doSend(JavaMailSenderImpl.java:399)
	... 139 common frames omitted

2026-01-05 21:11:00.491  INFO [SpringApplicationShutdownHook] [] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2026-01-05 21:11:00.505  INFO [SpringApplicationShutdownHook] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2026-01-05 21:11:00.507  INFO [SpringApplicationShutdownHook] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2026-01-05 21:11:01.352  INFO [main] [] c.westwood.WestwoodBackendApplication    : Starting WestwoodBackendApplication using Java 17.0.10 with PID 88252 (/Users/baglan/repo/westwood-backend/target/classes started by baglan in /Users/baglan/repo/westwood-backend)
2026-01-05 21:11:01.353 DEBUG [main] [] c.westwood.WestwoodBackendApplication    : Running with Spring Boot v3.3.5, Spring v6.1.14
2026-01-05 21:11:01.354  INFO [main] [] c.westwood.WestwoodBackendApplication    : The following 1 profile is active: "dev"
2026-01-05 21:11:01.597  INFO [main] [] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2026-01-05 21:11:01.618  INFO [main] [] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 18 ms. Found 6 JPA repository interfaces.
2026-01-05 21:11:02.003  INFO [main] [] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-01-05 21:11:02.010  INFO [main] [] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-01-05 21:11:02.010  INFO [main] [] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.31]
2026-01-05 21:11:02.041  INFO [main] [] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2026-01-05 21:11:02.042  INFO [main] [] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 670 ms
2026-01-05 21:11:02.064  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-01-05 21:11:02.145  INFO [main] [] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:devdb user=SA
2026-01-05 21:11:02.146  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-01-05 21:11:02.150  INFO [main] [] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:devdb'
2026-01-05 21:11:02.252  INFO [main] [] org.flywaydb.core.FlywayExecutor         : Database: jdbc:h2:mem:devdb (H2 2.2)
2026-01-05 21:11:02.254  WARN [main] [] o.f.c.internal.database.base.Database    : Flyway upgrade recommended: H2 2.2.224 is newer than this version of Flyway and support has not been tested. The latest supported version of H2 is 2.2.220.
2026-01-05 21:11:02.264  INFO [main] [] o.f.c.i.s.JdbcTableSchemaHistory         : Schema history table "PUBLIC"."flyway_schema_history" does not exist yet
2026-01-05 21:11:02.265  INFO [main] [] o.f.core.internal.command.DbValidate     : Successfully validated 8 migrations (execution time 00:00.006s)
2026-01-05 21:11:02.268  INFO [main] [] o.f.c.i.s.JdbcTableSchemaHistory         : Creating Schema History table "PUBLIC"."flyway_schema_history" ...
2026-01-05 21:11:02.283  INFO [main] [] o.f.core.internal.command.DbMigrate      : Current version of schema "PUBLIC": << Empty Schema >>
2026-01-05 21:11:02.286  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "0 - create clients table"
2026-01-05 21:11:02.296  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "1 - create users table"
2026-01-05 21:11:02.301  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "2 - create payment transactions table"
2026-01-05 21:11:02.307  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "3 - create bonus events table"
2026-01-05 21:11:02.313  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "4 - create bonus configuration table"
2026-01-05 21:11:02.315  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "5 - create event store table"
2026-01-05 21:11:02.318  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "6 - add uuid to clients and users"
2026-01-05 21:11:02.328  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "7 - add user activation fields"
2026-01-05 21:11:02.343  INFO [main] [] o.f.core.internal.command.DbMigrate      : Successfully applied 8 migrations to schema "PUBLIC", now at version v7 (execution time 00:00.032s)
2026-01-05 21:11:02.381  INFO [main] [] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2026-01-05 21:11:02.404  INFO [main] [] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.5.3.Final
2026-01-05 21:11:02.420  INFO [main] [] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2026-01-05 21:11:02.531  INFO [main] [] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2026-01-05 21:11:02.548  WARN [main] [] org.hibernate.orm.deprecation            : HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2026-01-05 21:11:02.604  WARN [main] [] o.h.boot.model.internal.EntityBinder     : HHH000457: Joined inheritance hierarchy [com.westwood.domain.BonusEvent] defined explicit @DiscriminatorColumn.  Legacy Hibernate behavior was to ignore the @DiscriminatorColumn.  However, as part of issue HHH-6911 we now apply the explicit @DiscriminatorColumn.  If you would prefer the legacy behavior, enable the `hibernate.discriminator.ignore_explicit_for_joined` setting (hibernate.discriminator.ignore_explicit_for_joined=true)
2026-01-05 21:11:02.967  INFO [main] [] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2026-01-05 21:11:02.978 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists bonus_configurations 
       alter column description set data type TEXT
2026-01-05 21:11:02.978 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists bonus_events 
       alter column event_type set data type varchar(31)
2026-01-05 21:11:02.978 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists client_tags 
       alter column tag set data type varchar(255)
2026-01-05 21:11:02.982 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists clients 
       alter column notes set data type TEXT
2026-01-05 21:11:02.982 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists event_store 
       alter column aggregate_type set data type varchar(255)
2026-01-05 21:11:02.982 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists event_store 
       alter column event_data set data type TEXT
2026-01-05 21:11:02.982 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists payment_transactions 
       alter column notes set data type TEXT
2026-01-05 21:11:02.983 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists clients 
       drop constraint if exists idx_client_uuid
2026-01-05 21:11:02.984 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists clients 
       add constraint idx_client_uuid unique (uuid)
2026-01-05 21:11:02.984 DEBUG [main] [] org.hibernate.SQL                        : 
    create index idx_aggregate_id 
       on event_store (aggregate_id)
2026-01-05 21:11:02.984 DEBUG [main] [] org.hibernate.SQL                        : 
    create index idx_event_type 
       on event_store (event_type)
2026-01-05 21:11:02.984 DEBUG [main] [] org.hibernate.SQL                        : 
    create index idx_timestamp 
       on event_store (timestamp)
2026-01-05 21:11:02.985 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists users 
       drop constraint if exists idx_user_uuid
2026-01-05 21:11:02.985 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists users 
       add constraint idx_user_uuid unique (uuid)
2026-01-05 21:11:02.988  INFO [main] [] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2026-01-05 21:11:03.182 DEBUG [main] [] c.w.security.JwtAuthenticationFilter     : Filter 'jwtAuthenticationFilter' configured for use
2026-01-05 21:11:03.183 DEBUG [main] [] com.westwood.config.RequestIdFilter      : Filter 'requestIdFilter' configured for use
2026-01-05 21:11:03.227  INFO [main] [] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2026-01-05 21:11:03.816  INFO [main] [] eAuthenticationProviderManagerConfigurer : Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2026-01-05 21:11:03.817  WARN [main] [] r$InitializeUserDetailsManagerConfigurer : Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used for username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider.
2026-01-05 21:11:03.907  WARN [main] [] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2026-01-05 21:11:04.025 DEBUG [main] [] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2026-01-05 21:11:04.152  INFO [main] [] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2026-01-05 21:11:04.157  INFO [main] [] c.westwood.WestwoodBackendApplication    : Started WestwoodBackendApplication in 3.047 seconds (process running for 3.293)
2026-01-05 21:11:10.126  INFO [http-nio-8080-exec-2] [] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2026-01-05 21:11:10.126  INFO [http-nio-8080-exec-2] [] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2026-01-05 21:11:10.134  INFO [http-nio-8080-exec-2] [] o.s.web.servlet.DispatcherServlet        : Completed initialization in 8 ms
2026-01-05 21:11:10.153 DEBUG [http-nio-8080-exec-2] [48d66ab7-e26d-4cbc-8fab-86384f3172d9] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/auth/register
2026-01-05 21:11:10.311 DEBUG [http-nio-8080-exec-2] [48d66ab7-e26d-4cbc-8fab-86384f3172d9] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 21:11:10.317 ERROR [http-nio-8080-exec-2] [48d66ab7-e26d-4cbc-8fab-86384f3172d9] c.w.security.JwtAuthenticationFilter     : Cannot set user authentication: {}

org.springframework.security.core.userdetails.UsernameNotFoundException: User not found with username: test
	at com.westwood.security.UserDetailsServiceImpl.lambda$loadUserByUsername$0(UserDetailsServiceImpl.java:23)
	at java.base/java.util.Optional.orElseThrow(Optional.java:403)
	at com.westwood.security.UserDetailsServiceImpl.loadUserByUsername(UserDetailsServiceImpl.java:23)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:355)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:379)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:720)
	at com.westwood.security.UserDetailsServiceImpl$$SpringCGLIB$$0.loadUserByUsername(<generated>)
	at com.westwood.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:45)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at com.westwood.config.RequestIdFilter.doFilterInternal(RequestIdFilter.java:47)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:384)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:905)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)

2026-01-05 21:11:10.321 DEBUG [http-nio-8080-exec-2] [48d66ab7-e26d-4cbc-8fab-86384f3172d9] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2026-01-05 21:11:10.326 DEBUG [http-nio-8080-exec-2] [48d66ab7-e26d-4cbc-8fab-86384f3172d9] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/auth/register
2026-01-05 21:11:10.377 DEBUG [http-nio-8080-exec-2] [48d66ab7-e26d-4cbc-8fab-86384f3172d9] org.hibernate.SQL                        : 
    select
        u1_0.id 
    from
        users u1_0 
    where
        u1_0.username=? 
    fetch
        first ? rows only
2026-01-05 21:11:10.378 DEBUG [http-nio-8080-exec-2] [48d66ab7-e26d-4cbc-8fab-86384f3172d9] org.hibernate.SQL                        : 
    select
        u1_0.id 
    from
        users u1_0 
    where
        u1_0.email=? 
    fetch
        first ? rows only
2026-01-05 21:11:10.468 DEBUG [http-nio-8080-exec-2] [48d66ab7-e26d-4cbc-8fab-86384f3172d9] org.hibernate.SQL                        : 
    insert 
    into
        users
        (account_status, activation_token, activation_token_expiry, active, created_at, email, first_name, last_name, password, updated_at, username, uuid, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 21:11:10.493 DEBUG [http-nio-8080-exec-2] [48d66ab7-e26d-4cbc-8fab-86384f3172d9] org.hibernate.SQL                        : 
    insert 
    into
        user_roles
        (user_id, role) 
    values
        (?, ?)
2026-01-05 21:11:10.494 DEBUG [http-nio-8080-exec-2] [48d66ab7-e26d-4cbc-8fab-86384f3172d9] org.hibernate.SQL                        : 
    insert 
    into
        user_roles
        (user_id, role) 
    values
        (?, ?)
2026-01-05 21:12:15.756 DEBUG [http-nio-8080-exec-5] [0ad04520-2747-469b-968a-561eb5c6f276] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/auth/login
2026-01-05 21:12:15.761 DEBUG [http-nio-8080-exec-5] [0ad04520-2747-469b-968a-561eb5c6f276] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2026-01-05 21:12:15.761 DEBUG [http-nio-8080-exec-5] [0ad04520-2747-469b-968a-561eb5c6f276] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/auth/login
2026-01-05 21:12:15.902 DEBUG [http-nio-8080-exec-5] [0ad04520-2747-469b-968a-561eb5c6f276] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 21:12:15.966 DEBUG [http-nio-8080-exec-5] [0ad04520-2747-469b-968a-561eb5c6f276] o.s.s.a.dao.DaoAuthenticationProvider    : Failed to find user 'newuser'
2026-01-05 21:12:21.771 DEBUG [http-nio-8080-exec-7] [ac45a964-5f3b-4c11-a2fc-3c69631dec9f] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/auth/login
2026-01-05 21:12:21.772 DEBUG [http-nio-8080-exec-7] [ac45a964-5f3b-4c11-a2fc-3c69631dec9f] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2026-01-05 21:12:21.773 DEBUG [http-nio-8080-exec-7] [ac45a964-5f3b-4c11-a2fc-3c69631dec9f] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/auth/login
2026-01-05 21:12:21.779 DEBUG [http-nio-8080-exec-7] [ac45a964-5f3b-4c11-a2fc-3c69631dec9f] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 21:12:21.814 DEBUG [http-nio-8080-exec-7] [ac45a964-5f3b-4c11-a2fc-3c69631dec9f] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 21:12:21.898 DEBUG [http-nio-8080-exec-7] [ac45a964-5f3b-4c11-a2fc-3c69631dec9f] o.s.s.a.dao.DaoAuthenticationProvider    : Authenticated user
2026-01-05 21:12:36.452 DEBUG [http-nio-8080-exec-8] [57901a58-f2f3-46fa-8aa4-d9bfa1546c49] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/users/invite
2026-01-05 21:12:36.473 DEBUG [http-nio-8080-exec-8] [57901a58-f2f3-46fa-8aa4-d9bfa1546c49] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 21:12:36.482 DEBUG [http-nio-8080-exec-8] [57901a58-f2f3-46fa-8aa4-d9bfa1546c49] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 21:12:36.490 DEBUG [http-nio-8080-exec-8] [57901a58-f2f3-46fa-8aa4-d9bfa1546c49] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/users/invite
2026-01-05 21:12:36.536 DEBUG [http-nio-8080-exec-8] [57901a58-f2f3-46fa-8aa4-d9bfa1546c49] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.InvitationController.inviteUser(com.westwood.common.dto.InviteUserRequest); target is of class [com.westwood.controller.InvitationController]
2026-01-05 21:12:36.611 DEBUG [http-nio-8080-exec-8] [57901a58-f2f3-46fa-8aa4-d9bfa1546c49] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.InvitationController.inviteUser(com.westwood.common.dto.InviteUserRequest); target is of class [com.westwood.controller.InvitationController]
2026-01-05 21:12:36.614 DEBUG [http-nio-8080-exec-8] [57901a58-f2f3-46fa-8aa4-d9bfa1546c49] org.hibernate.SQL                        : 
    select
        u1_0.id 
    from
        users u1_0 
    where
        u1_0.email=? 
    fetch
        first ? rows only
2026-01-05 21:12:36.616 DEBUG [http-nio-8080-exec-8] [57901a58-f2f3-46fa-8aa4-d9bfa1546c49] org.hibernate.SQL                        : 
    select
        u1_0.id 
    from
        users u1_0 
    where
        u1_0.username=? 
    fetch
        first ? rows only
2026-01-05 21:12:36.684 DEBUG [http-nio-8080-exec-8] [57901a58-f2f3-46fa-8aa4-d9bfa1546c49] org.hibernate.SQL                        : 
    insert 
    into
        users
        (account_status, activation_token, activation_token_expiry, active, created_at, email, first_name, last_name, password, updated_at, username, uuid, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 21:12:36.685  INFO [http-nio-8080-exec-8] [57901a58-f2f3-46fa-8aa4-d9bfa1546c49] c.w.service.impl.InvitationServiceImpl   : User invited: email=baglansagidulladev@gmail.com, username=baglansagidulladev
2026-01-05 21:12:38.308  INFO [http-nio-8080-exec-8] [57901a58-f2f3-46fa-8aa4-d9bfa1546c49] c.w.service.impl.EmailServiceImpl        : Invitation email sent successfully to: baglansagidulladev@gmail.com
2026-01-05 21:12:38.310 DEBUG [http-nio-8080-exec-8] [57901a58-f2f3-46fa-8aa4-d9bfa1546c49] org.hibernate.SQL                        : 
    insert 
    into
        user_roles
        (user_id, role) 
    values
        (?, ?)
2026-01-05 22:02:26.407 DEBUG [http-nio-8080-exec-1] [dff8788f-ab75-4a5e-b1d8-367affdb591c] o.s.security.web.FilterChainProxy        : Securing GET /api/v1/analytics/clients/value
2026-01-05 22:02:26.532 DEBUG [http-nio-8080-exec-1] [dff8788f-ab75-4a5e-b1d8-367affdb591c] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 22:02:26.574 DEBUG [http-nio-8080-exec-1] [dff8788f-ab75-4a5e-b1d8-367affdb591c] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 22:02:26.586 DEBUG [http-nio-8080-exec-1] [dff8788f-ab75-4a5e-b1d8-367affdb591c] o.s.security.web.FilterChainProxy        : Secured GET /api/v1/analytics/clients/value
2026-01-05 22:02:26.622 DEBUG [http-nio-8080-exec-1] [dff8788f-ab75-4a5e-b1d8-367affdb591c] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.AnalyticsController.getClientValueRankings(); target is of class [com.westwood.controller.AnalyticsController]
2026-01-05 22:02:26.637 DEBUG [http-nio-8080-exec-1] [dff8788f-ab75-4a5e-b1d8-367affdb591c] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.AnalyticsController.getClientValueRankings(); target is of class [com.westwood.controller.AnalyticsController]
2026-01-05 22:02:26.712 DEBUG [http-nio-8080-exec-1] [dff8788f-ab75-4a5e-b1d8-367affdb591c] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0
2026-01-05 22:02:28.132  WARN [HikariPool-1 housekeeper] [] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=5m25s300ms).
2026-01-05 22:20:55.428  WARN [HikariPool-1 housekeeper] [] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=10m57s201ms).
2026-01-05 22:42:43.967  WARN [HikariPool-1 housekeeper] [] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=19m18s506ms).
2026-01-05 23:10:07.569  WARN [HikariPool-1 housekeeper] [] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=24m53s572ms).
2026-01-05 23:33:19.831  WARN [HikariPool-1 housekeeper] [] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=20m42s225ms).
2026-01-05 23:45:12.841  INFO [SpringApplicationShutdownHook] [] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2026-01-05 23:45:12.868  INFO [SpringApplicationShutdownHook] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2026-01-05 23:45:12.874  INFO [SpringApplicationShutdownHook] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2026-01-05 23:45:13.715  INFO [main] [] c.westwood.WestwoodBackendApplication    : Starting WestwoodBackendApplication using Java 17.0.10 with PID 91098 (/Users/baglan/repo/westwood-backend/target/classes started by baglan in /Users/baglan/repo/westwood-backend)
2026-01-05 23:45:13.716 DEBUG [main] [] c.westwood.WestwoodBackendApplication    : Running with Spring Boot v3.3.5, Spring v6.1.14
2026-01-05 23:45:13.717  INFO [main] [] c.westwood.WestwoodBackendApplication    : The following 1 profile is active: "dev"
2026-01-05 23:45:13.956  INFO [main] [] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2026-01-05 23:45:13.978  INFO [main] [] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 19 ms. Found 6 JPA repository interfaces.
2026-01-05 23:45:14.397  INFO [main] [] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2026-01-05 23:45:14.403  INFO [main] [] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2026-01-05 23:45:14.404  INFO [main] [] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.31]
2026-01-05 23:45:14.436  INFO [main] [] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2026-01-05 23:45:14.437  INFO [main] [] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 703 ms
2026-01-05 23:45:14.459  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-01-05 23:45:14.535  INFO [main] [] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:devdb user=SA
2026-01-05 23:45:14.535  INFO [main] [] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-01-05 23:45:14.540  INFO [main] [] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:devdb'
2026-01-05 23:45:14.622  INFO [main] [] org.flywaydb.core.FlywayExecutor         : Database: jdbc:h2:mem:devdb (H2 2.2)
2026-01-05 23:45:14.624  WARN [main] [] o.f.c.internal.database.base.Database    : Flyway upgrade recommended: H2 2.2.224 is newer than this version of Flyway and support has not been tested. The latest supported version of H2 is 2.2.220.
2026-01-05 23:45:14.631  INFO [main] [] o.f.c.i.s.JdbcTableSchemaHistory         : Schema history table "PUBLIC"."flyway_schema_history" does not exist yet
2026-01-05 23:45:14.632  INFO [main] [] o.f.core.internal.command.DbValidate     : Successfully validated 8 migrations (execution time 00:00.005s)
2026-01-05 23:45:14.635  INFO [main] [] o.f.c.i.s.JdbcTableSchemaHistory         : Creating Schema History table "PUBLIC"."flyway_schema_history" ...
2026-01-05 23:45:14.649  INFO [main] [] o.f.core.internal.command.DbMigrate      : Current version of schema "PUBLIC": << Empty Schema >>
2026-01-05 23:45:14.653  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "0 - create clients table"
2026-01-05 23:45:14.667  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "1 - create users table"
2026-01-05 23:45:14.673  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "2 - create payment transactions table"
2026-01-05 23:45:14.678  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "3 - create bonus events table"
2026-01-05 23:45:14.684  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "4 - create bonus configuration table"
2026-01-05 23:45:14.687  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "5 - create event store table"
2026-01-05 23:45:14.691  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "6 - add uuid to clients and users"
2026-01-05 23:45:14.700  INFO [main] [] o.f.core.internal.command.DbMigrate      : Migrating schema "PUBLIC" to version "7 - add user activation fields"
2026-01-05 23:45:14.715  INFO [main] [] o.f.core.internal.command.DbMigrate      : Successfully applied 8 migrations to schema "PUBLIC", now at version v7 (execution time 00:00.031s)
2026-01-05 23:45:14.749  INFO [main] [] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2026-01-05 23:45:14.774  INFO [main] [] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.5.3.Final
2026-01-05 23:45:14.794  INFO [main] [] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2026-01-05 23:45:14.911  INFO [main] [] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2026-01-05 23:45:14.927  WARN [main] [] org.hibernate.orm.deprecation            : HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2026-01-05 23:45:14.989  WARN [main] [] o.h.boot.model.internal.EntityBinder     : HHH000457: Joined inheritance hierarchy [com.westwood.domain.BonusEvent] defined explicit @DiscriminatorColumn.  Legacy Hibernate behavior was to ignore the @DiscriminatorColumn.  However, as part of issue HHH-6911 we now apply the explicit @DiscriminatorColumn.  If you would prefer the legacy behavior, enable the `hibernate.discriminator.ignore_explicit_for_joined` setting (hibernate.discriminator.ignore_explicit_for_joined=true)
2026-01-05 23:45:15.388  INFO [main] [] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2026-01-05 23:45:15.399 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists bonus_configurations 
       alter column description set data type TEXT
2026-01-05 23:45:15.399 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists bonus_events 
       alter column event_type set data type varchar(31)
2026-01-05 23:45:15.402 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists client_tags 
       alter column tag set data type varchar(255)
2026-01-05 23:45:15.404 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists clients 
       alter column notes set data type TEXT
2026-01-05 23:45:15.404 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists event_store 
       alter column aggregate_type set data type varchar(255)
2026-01-05 23:45:15.404 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists event_store 
       alter column event_data set data type TEXT
2026-01-05 23:45:15.404 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists payment_transactions 
       alter column notes set data type TEXT
2026-01-05 23:45:15.405 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists clients 
       drop constraint if exists idx_client_uuid
2026-01-05 23:45:15.406 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists clients 
       add constraint idx_client_uuid unique (uuid)
2026-01-05 23:45:15.406 DEBUG [main] [] org.hibernate.SQL                        : 
    create index idx_aggregate_id 
       on event_store (aggregate_id)
2026-01-05 23:45:15.406 DEBUG [main] [] org.hibernate.SQL                        : 
    create index idx_event_type 
       on event_store (event_type)
2026-01-05 23:45:15.406 DEBUG [main] [] org.hibernate.SQL                        : 
    create index idx_timestamp 
       on event_store (timestamp)
2026-01-05 23:45:15.407 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists users 
       drop constraint if exists idx_user_uuid
2026-01-05 23:45:15.407 DEBUG [main] [] org.hibernate.SQL                        : 
    alter table if exists users 
       add constraint idx_user_uuid unique (uuid)
2026-01-05 23:45:15.411  INFO [main] [] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2026-01-05 23:45:15.564 DEBUG [main] [] c.w.security.JwtAuthenticationFilter     : Filter 'jwtAuthenticationFilter' configured for use
2026-01-05 23:45:15.564 DEBUG [main] [] com.westwood.config.RequestIdFilter      : Filter 'requestIdFilter' configured for use
2026-01-05 23:45:15.584  INFO [main] [] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2026-01-05 23:45:15.917  INFO [main] [] eAuthenticationProviderManagerConfigurer : Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2026-01-05 23:45:15.917  WARN [main] [] r$InitializeUserDetailsManagerConfigurer : Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used for username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider.
2026-01-05 23:45:15.968  WARN [main] [] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2026-01-05 23:45:16.068 DEBUG [main] [] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2026-01-05 23:45:16.182  INFO [main] [] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2026-01-05 23:45:16.189  INFO [main] [] c.westwood.WestwoodBackendApplication    : Started WestwoodBackendApplication in 2.71 seconds (process running for 2.918)
2026-01-05 23:45:27.968  INFO [http-nio-8080-exec-1] [] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2026-01-05 23:45:27.968  INFO [http-nio-8080-exec-1] [] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2026-01-05 23:45:27.974  INFO [http-nio-8080-exec-1] [] o.s.web.servlet.DispatcherServlet        : Completed initialization in 5 ms
2026-01-05 23:45:27.991 DEBUG [http-nio-8080-exec-1] [eb5b9459-0e53-498c-8242-b04e08f251e4] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/auth/register
2026-01-05 23:45:28.122 DEBUG [http-nio-8080-exec-1] [eb5b9459-0e53-498c-8242-b04e08f251e4] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 23:45:28.127 ERROR [http-nio-8080-exec-1] [eb5b9459-0e53-498c-8242-b04e08f251e4] c.w.security.JwtAuthenticationFilter     : Cannot set user authentication: {}

org.springframework.security.core.userdetails.UsernameNotFoundException: User not found with username: test
	at com.westwood.security.UserDetailsServiceImpl.lambda$loadUserByUsername$0(UserDetailsServiceImpl.java:23)
	at java.base/java.util.Optional.orElseThrow(Optional.java:403)
	at com.westwood.security.UserDetailsServiceImpl.loadUserByUsername(UserDetailsServiceImpl.java:23)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:355)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:379)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:720)
	at com.westwood.security.UserDetailsServiceImpl$$SpringCGLIB$$0.loadUserByUsername(<generated>)
	at com.westwood.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:45)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at com.westwood.config.RequestIdFilter.doFilterInternal(RequestIdFilter.java:47)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:384)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:905)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)

2026-01-05 23:45:28.130 DEBUG [http-nio-8080-exec-1] [eb5b9459-0e53-498c-8242-b04e08f251e4] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2026-01-05 23:45:28.131 DEBUG [http-nio-8080-exec-1] [eb5b9459-0e53-498c-8242-b04e08f251e4] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/auth/register
2026-01-05 23:45:28.185 DEBUG [http-nio-8080-exec-1] [eb5b9459-0e53-498c-8242-b04e08f251e4] org.hibernate.SQL                        : 
    select
        u1_0.id 
    from
        users u1_0 
    where
        u1_0.username=? 
    fetch
        first ? rows only
2026-01-05 23:45:28.190 DEBUG [http-nio-8080-exec-1] [eb5b9459-0e53-498c-8242-b04e08f251e4] org.hibernate.SQL                        : 
    select
        u1_0.id 
    from
        users u1_0 
    where
        u1_0.email=? 
    fetch
        first ? rows only
2026-01-05 23:45:28.278 DEBUG [http-nio-8080-exec-1] [eb5b9459-0e53-498c-8242-b04e08f251e4] org.hibernate.SQL                        : 
    insert 
    into
        users
        (account_status, activation_token, activation_token_expiry, active, created_at, email, first_name, last_name, password, updated_at, username, uuid, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 23:45:28.298 DEBUG [http-nio-8080-exec-1] [eb5b9459-0e53-498c-8242-b04e08f251e4] org.hibernate.SQL                        : 
    insert 
    into
        user_roles
        (user_id, role) 
    values
        (?, ?)
2026-01-05 23:45:28.299 DEBUG [http-nio-8080-exec-1] [eb5b9459-0e53-498c-8242-b04e08f251e4] org.hibernate.SQL                        : 
    insert 
    into
        user_roles
        (user_id, role) 
    values
        (?, ?)
2026-01-05 23:45:30.258 DEBUG [http-nio-8080-exec-3] [511ba51a-6222-4c46-b870-0466d9091c39] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/auth/login
2026-01-05 23:45:30.273 DEBUG [http-nio-8080-exec-3] [511ba51a-6222-4c46-b870-0466d9091c39] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 23:45:30.314 DEBUG [http-nio-8080-exec-3] [511ba51a-6222-4c46-b870-0466d9091c39] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 23:45:30.324 DEBUG [http-nio-8080-exec-3] [511ba51a-6222-4c46-b870-0466d9091c39] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/auth/login
2026-01-05 23:45:30.419 DEBUG [http-nio-8080-exec-3] [511ba51a-6222-4c46-b870-0466d9091c39] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 23:45:30.419 DEBUG [http-nio-8080-exec-3] [511ba51a-6222-4c46-b870-0466d9091c39] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 23:45:30.483 DEBUG [http-nio-8080-exec-3] [511ba51a-6222-4c46-b870-0466d9091c39] o.s.s.a.dao.DaoAuthenticationProvider    : Authenticated user
2026-01-05 23:45:46.747 DEBUG [http-nio-8080-exec-4] [69138ff4-95c5-406c-8d9c-13d92a20548d] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/bonus-configuration?bonusPercentage=10.0
2026-01-05 23:45:46.754 DEBUG [http-nio-8080-exec-4] [69138ff4-95c5-406c-8d9c-13d92a20548d] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 23:45:46.757 DEBUG [http-nio-8080-exec-4] [69138ff4-95c5-406c-8d9c-13d92a20548d] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 23:45:46.761 DEBUG [http-nio-8080-exec-4] [69138ff4-95c5-406c-8d9c-13d92a20548d] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/bonus-configuration?bonusPercentage=10.0
2026-01-05 23:45:46.774 DEBUG [http-nio-8080-exec-4] [69138ff4-95c5-406c-8d9c-13d92a20548d] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.BonusConfigurationController.createConfiguration(java.math.BigDecimal,java.lang.String); target is of class [com.westwood.controller.BonusConfigurationController]
2026-01-05 23:45:46.894 DEBUG [http-nio-8080-exec-4] [69138ff4-95c5-406c-8d9c-13d92a20548d] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.BonusConfigurationController.createConfiguration(java.math.BigDecimal,java.lang.String); target is of class [com.westwood.controller.BonusConfigurationController]
2026-01-05 23:45:46.896 DEBUG [http-nio-8080-exec-4] [69138ff4-95c5-406c-8d9c-13d92a20548d] org.hibernate.SQL                        : 
    select
        bc1_0.id,
        bc1_0.active,
        bc1_0.bonus_percentage,
        bc1_0.created_at,
        bc1_0.description,
        bc1_0.effective_from,
        bc1_0.effective_to,
        bc1_0.updated_at,
        bc1_0.version 
    from
        bonus_configurations bc1_0
2026-01-05 23:45:46.897 DEBUG [http-nio-8080-exec-4] [69138ff4-95c5-406c-8d9c-13d92a20548d] org.hibernate.SQL                        : 
    insert 
    into
        bonus_configurations
        (active, bonus_percentage, created_at, description, effective_from, effective_to, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 23:45:54.147 DEBUG [http-nio-8080-exec-5] [5a36b449-e3c3-4e0e-b53b-7f887e045c89] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/payments
2026-01-05 23:45:54.179 DEBUG [http-nio-8080-exec-5] [5a36b449-e3c3-4e0e-b53b-7f887e045c89] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 23:45:54.184 DEBUG [http-nio-8080-exec-5] [5a36b449-e3c3-4e0e-b53b-7f887e045c89] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 23:45:54.193 DEBUG [http-nio-8080-exec-5] [5a36b449-e3c3-4e0e-b53b-7f887e045c89] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/payments
2026-01-05 23:45:54.968 DEBUG [http-nio-8080-exec-7] [7820cff9-82b5-4e30-95d5-4deb63a6d3a1] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/payments
2026-01-05 23:45:54.973 DEBUG [http-nio-8080-exec-7] [7820cff9-82b5-4e30-95d5-4deb63a6d3a1] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 23:45:54.982 DEBUG [http-nio-8080-exec-7] [7820cff9-82b5-4e30-95d5-4deb63a6d3a1] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 23:45:54.985 DEBUG [http-nio-8080-exec-7] [7820cff9-82b5-4e30-95d5-4deb63a6d3a1] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/payments
2026-01-05 23:46:08.233 DEBUG [http-nio-8080-exec-9] [79b7a04c-8424-4d71-97bb-c5135777f59a] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/clients
2026-01-05 23:46:08.255 DEBUG [http-nio-8080-exec-9] [79b7a04c-8424-4d71-97bb-c5135777f59a] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 23:46:08.261 DEBUG [http-nio-8080-exec-9] [79b7a04c-8424-4d71-97bb-c5135777f59a] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 23:46:08.269 DEBUG [http-nio-8080-exec-9] [79b7a04c-8424-4d71-97bb-c5135777f59a] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/clients
2026-01-05 23:46:25.098 DEBUG [http-nio-8080-exec-2] [847b2ede-0298-455a-8cab-3ceca4250b9f] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/clients
2026-01-05 23:46:25.116 DEBUG [http-nio-8080-exec-2] [847b2ede-0298-455a-8cab-3ceca4250b9f] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 23:46:25.119 DEBUG [http-nio-8080-exec-2] [847b2ede-0298-455a-8cab-3ceca4250b9f] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 23:46:25.124 DEBUG [http-nio-8080-exec-2] [847b2ede-0298-455a-8cab-3ceca4250b9f] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/clients
2026-01-05 23:46:38.709 DEBUG [http-nio-8080-exec-3] [63a52415-2f92-4bc9-98a7-b0d1369bb3a6] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/clients
2026-01-05 23:46:38.716 DEBUG [http-nio-8080-exec-3] [63a52415-2f92-4bc9-98a7-b0d1369bb3a6] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 23:46:38.718 DEBUG [http-nio-8080-exec-3] [63a52415-2f92-4bc9-98a7-b0d1369bb3a6] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 23:46:38.723 DEBUG [http-nio-8080-exec-3] [63a52415-2f92-4bc9-98a7-b0d1369bb3a6] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/clients
2026-01-05 23:46:38.726 DEBUG [http-nio-8080-exec-3] [63a52415-2f92-4bc9-98a7-b0d1369bb3a6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.ClientController.createClient(com.westwood.common.dto.CreateClientRequest); target is of class [com.westwood.controller.ClientController]
2026-01-05 23:46:38.727 DEBUG [http-nio-8080-exec-3] [63a52415-2f92-4bc9-98a7-b0d1369bb3a6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.ClientController.createClient(com.westwood.common.dto.CreateClientRequest); target is of class [com.westwood.controller.ClientController]
2026-01-05 23:46:38.728 DEBUG [http-nio-8080-exec-3] [63a52415-2f92-4bc9-98a7-b0d1369bb3a6] org.hibernate.SQL                        : 
    select
        c1_0.id 
    from
        clients c1_0 
    where
        c1_0.phone=? 
    fetch
        first ? rows only
2026-01-05 23:46:38.733 DEBUG [http-nio-8080-exec-3] [63a52415-2f92-4bc9-98a7-b0d1369bb3a6] org.hibernate.SQL                        : 
    insert 
    into
        clients
        (client_type, created_at, name, notes, phone, surname, updated_at, uuid, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 23:46:38.735 DEBUG [http-nio-8080-exec-3] [63a52415-2f92-4bc9-98a7-b0d1369bb3a6] org.hibernate.SQL                        : 
    insert 
    into
        client_tags
        (client_id, tag) 
    values
        (?, ?)
2026-01-05 23:46:38.736 DEBUG [http-nio-8080-exec-3] [63a52415-2f92-4bc9-98a7-b0d1369bb3a6] org.hibernate.SQL                        : 
    insert 
    into
        client_tags
        (client_id, tag) 
    values
        (?, ?)
2026-01-05 23:46:55.388 DEBUG [http-nio-8080-exec-4] [0a31e17c-6bfe-445e-aa6c-fc760163e703] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/payments
2026-01-05 23:46:55.414 DEBUG [http-nio-8080-exec-4] [0a31e17c-6bfe-445e-aa6c-fc760163e703] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 23:46:55.418 DEBUG [http-nio-8080-exec-4] [0a31e17c-6bfe-445e-aa6c-fc760163e703] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 23:46:55.425 DEBUG [http-nio-8080-exec-4] [0a31e17c-6bfe-445e-aa6c-fc760163e703] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/payments
2026-01-05 23:46:55.433 DEBUG [http-nio-8080-exec-4] [0a31e17c-6bfe-445e-aa6c-fc760163e703] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 23:46:55.438 DEBUG [http-nio-8080-exec-4] [0a31e17c-6bfe-445e-aa6c-fc760163e703] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 23:46:55.468 DEBUG [http-nio-8080-exec-4] [0a31e17c-6bfe-445e-aa6c-fc760163e703] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 23:46:55.472 DEBUG [http-nio-8080-exec-4] [0a31e17c-6bfe-445e-aa6c-fc760163e703] org.hibernate.SQL                        : 
    select
        t1_0.client_id,
        t1_0.tag 
    from
        client_tags t1_0 
    where
        t1_0.client_id=?
2026-01-05 23:46:55.501 DEBUG [http-nio-8080-exec-4] [0a31e17c-6bfe-445e-aa6c-fc760163e703] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        r1_0.user_id,
        r1_0.role,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    left join
        user_roles r1_0 
            on u1_0.id=r1_0.user_id 
    where
        u1_0.id=?
2026-01-05 23:46:55.506 DEBUG [http-nio-8080-exec-4] [0a31e17c-6bfe-445e-aa6c-fc760163e703] org.hibernate.SQL                        : 
    insert 
    into
        payment_transactions
        (amount, client_id, created_at, entered_by_user_id, notes, status, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 23:46:55.512 DEBUG [http-nio-8080-exec-4] [0a31e17c-6bfe-445e-aa6c-fc760163e703] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 23:46:55.525 DEBUG [http-nio-8080-exec-4] [0a31e17c-6bfe-445e-aa6c-fc760163e703] org.hibernate.SQL                        : 
    select
        bc1_0.id,
        bc1_0.active,
        bc1_0.bonus_percentage,
        bc1_0.created_at,
        bc1_0.description,
        bc1_0.effective_from,
        bc1_0.effective_to,
        bc1_0.updated_at,
        bc1_0.version 
    from
        bonus_configurations bc1_0 
    where
        bc1_0.active=true 
        and (
            bc1_0.effective_to is null 
            or bc1_0.effective_to>?
        ) 
    order by
        bc1_0.effective_from desc
2026-01-05 23:46:55.529 DEBUG [http-nio-8080-exec-4] [0a31e17c-6bfe-445e-aa6c-fc760163e703] org.hibernate.SQL                        : 
    insert 
    into
        bonus_events
        (bonus_amount, client_id, created_at, event_id, updated_at, version, event_type, id) 
    values
        (?, ?, ?, ?, ?, ?, 'GRANTED', default)
2026-01-05 23:46:55.531 DEBUG [http-nio-8080-exec-4] [0a31e17c-6bfe-445e-aa6c-fc760163e703] org.hibernate.SQL                        : 
    insert 
    into
        bonus_granted
        (bonus_percentage, payment_amount, payment_transaction_id, id) 
    values
        (?, ?, ?, ?)
2026-01-05 23:46:55.533 DEBUG [http-nio-8080-exec-4] [0a31e17c-6bfe-445e-aa6c-fc760163e703] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 23:47:22.534 DEBUG [http-nio-8080-exec-5] [b2d53481-e7f8-4014-a1b6-b8e06bb161c1] o.s.security.web.FilterChainProxy        : Securing GET /api/v1/bonuses/client/bebf6b39-8b6d-4eaf-a1ae-e8b9d36589f2/balance
2026-01-05 23:47:22.546 DEBUG [http-nio-8080-exec-5] [b2d53481-e7f8-4014-a1b6-b8e06bb161c1] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 23:47:22.551 DEBUG [http-nio-8080-exec-5] [b2d53481-e7f8-4014-a1b6-b8e06bb161c1] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 23:47:22.554 DEBUG [http-nio-8080-exec-5] [b2d53481-e7f8-4014-a1b6-b8e06bb161c1] o.s.security.web.FilterChainProxy        : Secured GET /api/v1/bonuses/client/bebf6b39-8b6d-4eaf-a1ae-e8b9d36589f2/balance
2026-01-05 23:47:22.562 DEBUG [http-nio-8080-exec-5] [b2d53481-e7f8-4014-a1b6-b8e06bb161c1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.BonusController.getClientBonusBalance(java.util.UUID); target is of class [com.westwood.controller.BonusController]
2026-01-05 23:47:22.585 DEBUG [http-nio-8080-exec-5] [b2d53481-e7f8-4014-a1b6-b8e06bb161c1] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.BonusController.getClientBonusBalance(java.util.UUID); target is of class [com.westwood.controller.BonusController]
2026-01-05 23:47:22.610 DEBUG [http-nio-8080-exec-5] [b2d53481-e7f8-4014-a1b6-b8e06bb161c1] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 23:47:22.611 DEBUG [http-nio-8080-exec-5] [b2d53481-e7f8-4014-a1b6-b8e06bb161c1] org.hibernate.SQL                        : 
    select
        t1_0.client_id,
        t1_0.tag 
    from
        client_tags t1_0 
    where
        t1_0.client_id=?
2026-01-05 23:47:22.633 DEBUG [http-nio-8080-exec-5] [b2d53481-e7f8-4014-a1b6-b8e06bb161c1] org.hibernate.SQL                        : 
    select
        be1_0.id,
        be1_0.event_type,
        be1_0.bonus_amount,
        be1_0.client_id,
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version,
        be1_0.created_at,
        be1_0.event_id,
        be1_0.updated_at,
        be1_0.version,
        be1_1.bonus_percentage,
        be1_1.payment_amount,
        be1_1.payment_transaction_id,
        be1_2.final_payment_amount,
        be1_2.original_payment_amount,
        be1_2.payment_transaction_id 
    from
        bonus_events be1_0 
    left join
        bonus_granted be1_1 
            on be1_0.id=be1_1.id 
    left join
        bonus_used be1_2 
            on be1_0.id=be1_2.id 
    left join
        clients c1_0 
            on c1_0.id=be1_0.client_id 
    where
        be1_0.client_id=? 
    order by
        be1_0.created_at
2026-01-05 23:47:36.784 DEBUG [http-nio-8080-exec-6] [52c16c01-94bf-4926-8040-2ff82d5c2174] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/payments
2026-01-05 23:47:36.799 DEBUG [http-nio-8080-exec-6] [52c16c01-94bf-4926-8040-2ff82d5c2174] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 23:47:36.802 DEBUG [http-nio-8080-exec-6] [52c16c01-94bf-4926-8040-2ff82d5c2174] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 23:47:36.806 DEBUG [http-nio-8080-exec-6] [52c16c01-94bf-4926-8040-2ff82d5c2174] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/payments
2026-01-05 23:47:36.808 DEBUG [http-nio-8080-exec-6] [52c16c01-94bf-4926-8040-2ff82d5c2174] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 23:47:36.810 DEBUG [http-nio-8080-exec-6] [52c16c01-94bf-4926-8040-2ff82d5c2174] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 23:47:36.811 DEBUG [http-nio-8080-exec-6] [52c16c01-94bf-4926-8040-2ff82d5c2174] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 23:47:36.812 DEBUG [http-nio-8080-exec-6] [52c16c01-94bf-4926-8040-2ff82d5c2174] org.hibernate.SQL                        : 
    select
        t1_0.client_id,
        t1_0.tag 
    from
        client_tags t1_0 
    where
        t1_0.client_id=?
2026-01-05 23:47:36.813 DEBUG [http-nio-8080-exec-6] [52c16c01-94bf-4926-8040-2ff82d5c2174] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        r1_0.user_id,
        r1_0.role,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    left join
        user_roles r1_0 
            on u1_0.id=r1_0.user_id 
    where
        u1_0.id=?
2026-01-05 23:47:36.816 DEBUG [http-nio-8080-exec-6] [52c16c01-94bf-4926-8040-2ff82d5c2174] org.hibernate.SQL                        : 
    insert 
    into
        payment_transactions
        (amount, client_id, created_at, entered_by_user_id, notes, status, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 23:47:36.819 DEBUG [http-nio-8080-exec-6] [52c16c01-94bf-4926-8040-2ff82d5c2174] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 23:47:36.849 DEBUG [http-nio-8080-exec-6] [52c16c01-94bf-4926-8040-2ff82d5c2174] org.hibernate.SQL                        : 
    select
        bc1_0.id,
        bc1_0.active,
        bc1_0.bonus_percentage,
        bc1_0.created_at,
        bc1_0.description,
        bc1_0.effective_from,
        bc1_0.effective_to,
        bc1_0.updated_at,
        bc1_0.version 
    from
        bonus_configurations bc1_0 
    where
        bc1_0.active=true 
        and (
            bc1_0.effective_to is null 
            or bc1_0.effective_to>?
        ) 
    order by
        bc1_0.effective_from desc
2026-01-05 23:47:36.854 DEBUG [http-nio-8080-exec-6] [52c16c01-94bf-4926-8040-2ff82d5c2174] org.hibernate.SQL                        : 
    insert 
    into
        bonus_events
        (bonus_amount, client_id, created_at, event_id, updated_at, version, event_type, id) 
    values
        (?, ?, ?, ?, ?, ?, 'GRANTED', default)
2026-01-05 23:47:36.855 DEBUG [http-nio-8080-exec-6] [52c16c01-94bf-4926-8040-2ff82d5c2174] org.hibernate.SQL                        : 
    insert 
    into
        bonus_granted
        (bonus_percentage, payment_amount, payment_transaction_id, id) 
    values
        (?, ?, ?, ?)
2026-01-05 23:47:36.856 DEBUG [http-nio-8080-exec-6] [52c16c01-94bf-4926-8040-2ff82d5c2174] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 23:47:38.235 DEBUG [http-nio-8080-exec-7] [9f3e7786-b621-4914-be0f-b95ad9074f39] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/payments
2026-01-05 23:47:38.239 DEBUG [http-nio-8080-exec-7] [9f3e7786-b621-4914-be0f-b95ad9074f39] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 23:47:38.240 DEBUG [http-nio-8080-exec-7] [9f3e7786-b621-4914-be0f-b95ad9074f39] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 23:47:38.245 DEBUG [http-nio-8080-exec-7] [9f3e7786-b621-4914-be0f-b95ad9074f39] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/payments
2026-01-05 23:47:38.249 DEBUG [http-nio-8080-exec-7] [9f3e7786-b621-4914-be0f-b95ad9074f39] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 23:47:38.250 DEBUG [http-nio-8080-exec-7] [9f3e7786-b621-4914-be0f-b95ad9074f39] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 23:47:38.253 DEBUG [http-nio-8080-exec-7] [9f3e7786-b621-4914-be0f-b95ad9074f39] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 23:47:38.257 DEBUG [http-nio-8080-exec-7] [9f3e7786-b621-4914-be0f-b95ad9074f39] org.hibernate.SQL                        : 
    select
        t1_0.client_id,
        t1_0.tag 
    from
        client_tags t1_0 
    where
        t1_0.client_id=?
2026-01-05 23:47:38.258 DEBUG [http-nio-8080-exec-7] [9f3e7786-b621-4914-be0f-b95ad9074f39] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        r1_0.user_id,
        r1_0.role,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    left join
        user_roles r1_0 
            on u1_0.id=r1_0.user_id 
    where
        u1_0.id=?
2026-01-05 23:47:38.261 DEBUG [http-nio-8080-exec-7] [9f3e7786-b621-4914-be0f-b95ad9074f39] org.hibernate.SQL                        : 
    insert 
    into
        payment_transactions
        (amount, client_id, created_at, entered_by_user_id, notes, status, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 23:47:38.263 DEBUG [http-nio-8080-exec-7] [9f3e7786-b621-4914-be0f-b95ad9074f39] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 23:47:38.265 DEBUG [http-nio-8080-exec-7] [9f3e7786-b621-4914-be0f-b95ad9074f39] org.hibernate.SQL                        : 
    select
        bc1_0.id,
        bc1_0.active,
        bc1_0.bonus_percentage,
        bc1_0.created_at,
        bc1_0.description,
        bc1_0.effective_from,
        bc1_0.effective_to,
        bc1_0.updated_at,
        bc1_0.version 
    from
        bonus_configurations bc1_0 
    where
        bc1_0.active=true 
        and (
            bc1_0.effective_to is null 
            or bc1_0.effective_to>?
        ) 
    order by
        bc1_0.effective_from desc
2026-01-05 23:47:38.267 DEBUG [http-nio-8080-exec-7] [9f3e7786-b621-4914-be0f-b95ad9074f39] org.hibernate.SQL                        : 
    insert 
    into
        bonus_events
        (bonus_amount, client_id, created_at, event_id, updated_at, version, event_type, id) 
    values
        (?, ?, ?, ?, ?, ?, 'GRANTED', default)
2026-01-05 23:47:38.269 DEBUG [http-nio-8080-exec-7] [9f3e7786-b621-4914-be0f-b95ad9074f39] org.hibernate.SQL                        : 
    insert 
    into
        bonus_granted
        (bonus_percentage, payment_amount, payment_transaction_id, id) 
    values
        (?, ?, ?, ?)
2026-01-05 23:47:38.270 DEBUG [http-nio-8080-exec-7] [9f3e7786-b621-4914-be0f-b95ad9074f39] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 23:48:09.836 DEBUG [http-nio-8080-exec-8] [6e2b1686-990a-4eb8-b1b6-c5d5ef471f57] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/payments
2026-01-05 23:48:09.865 DEBUG [http-nio-8080-exec-8] [6e2b1686-990a-4eb8-b1b6-c5d5ef471f57] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 23:48:09.876 DEBUG [http-nio-8080-exec-8] [6e2b1686-990a-4eb8-b1b6-c5d5ef471f57] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 23:48:09.891 DEBUG [http-nio-8080-exec-8] [6e2b1686-990a-4eb8-b1b6-c5d5ef471f57] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/payments
2026-01-05 23:48:09.930 DEBUG [http-nio-8080-exec-8] [6e2b1686-990a-4eb8-b1b6-c5d5ef471f57] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 23:48:09.935 DEBUG [http-nio-8080-exec-8] [6e2b1686-990a-4eb8-b1b6-c5d5ef471f57] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 23:48:09.937 DEBUG [http-nio-8080-exec-8] [6e2b1686-990a-4eb8-b1b6-c5d5ef471f57] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 23:48:09.938 DEBUG [http-nio-8080-exec-8] [6e2b1686-990a-4eb8-b1b6-c5d5ef471f57] org.hibernate.SQL                        : 
    select
        t1_0.client_id,
        t1_0.tag 
    from
        client_tags t1_0 
    where
        t1_0.client_id=?
2026-01-05 23:48:09.939 DEBUG [http-nio-8080-exec-8] [6e2b1686-990a-4eb8-b1b6-c5d5ef471f57] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        r1_0.user_id,
        r1_0.role,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    left join
        user_roles r1_0 
            on u1_0.id=r1_0.user_id 
    where
        u1_0.id=?
2026-01-05 23:48:09.946 DEBUG [http-nio-8080-exec-8] [6e2b1686-990a-4eb8-b1b6-c5d5ef471f57] org.hibernate.SQL                        : 
    insert 
    into
        payment_transactions
        (amount, client_id, created_at, entered_by_user_id, notes, status, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 23:48:09.948 DEBUG [http-nio-8080-exec-8] [6e2b1686-990a-4eb8-b1b6-c5d5ef471f57] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 23:48:09.949 DEBUG [http-nio-8080-exec-8] [6e2b1686-990a-4eb8-b1b6-c5d5ef471f57] org.hibernate.SQL                        : 
    select
        bc1_0.id,
        bc1_0.active,
        bc1_0.bonus_percentage,
        bc1_0.created_at,
        bc1_0.description,
        bc1_0.effective_from,
        bc1_0.effective_to,
        bc1_0.updated_at,
        bc1_0.version 
    from
        bonus_configurations bc1_0 
    where
        bc1_0.active=true 
        and (
            bc1_0.effective_to is null 
            or bc1_0.effective_to>?
        ) 
    order by
        bc1_0.effective_from desc
2026-01-05 23:48:09.951 DEBUG [http-nio-8080-exec-8] [6e2b1686-990a-4eb8-b1b6-c5d5ef471f57] org.hibernate.SQL                        : 
    insert 
    into
        bonus_events
        (bonus_amount, client_id, created_at, event_id, updated_at, version, event_type, id) 
    values
        (?, ?, ?, ?, ?, ?, 'GRANTED', default)
2026-01-05 23:48:09.952 DEBUG [http-nio-8080-exec-8] [6e2b1686-990a-4eb8-b1b6-c5d5ef471f57] org.hibernate.SQL                        : 
    insert 
    into
        bonus_granted
        (bonus_percentage, payment_amount, payment_transaction_id, id) 
    values
        (?, ?, ?, ?)
2026-01-05 23:48:09.953 DEBUG [http-nio-8080-exec-8] [6e2b1686-990a-4eb8-b1b6-c5d5ef471f57] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 23:48:14.141 DEBUG [http-nio-8080-exec-9] [b9c33763-8a2e-48e9-80a1-9536152e6eb9] o.s.security.web.FilterChainProxy        : Securing GET /api/v1/bonuses/client/bebf6b39-8b6d-4eaf-a1ae-e8b9d36589f2/balance
2026-01-05 23:48:14.145 DEBUG [http-nio-8080-exec-9] [b9c33763-8a2e-48e9-80a1-9536152e6eb9] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 23:48:14.146 DEBUG [http-nio-8080-exec-9] [b9c33763-8a2e-48e9-80a1-9536152e6eb9] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 23:48:14.149 DEBUG [http-nio-8080-exec-9] [b9c33763-8a2e-48e9-80a1-9536152e6eb9] o.s.security.web.FilterChainProxy        : Secured GET /api/v1/bonuses/client/bebf6b39-8b6d-4eaf-a1ae-e8b9d36589f2/balance
2026-01-05 23:48:14.151 DEBUG [http-nio-8080-exec-9] [b9c33763-8a2e-48e9-80a1-9536152e6eb9] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.BonusController.getClientBonusBalance(java.util.UUID); target is of class [com.westwood.controller.BonusController]
2026-01-05 23:48:14.151 DEBUG [http-nio-8080-exec-9] [b9c33763-8a2e-48e9-80a1-9536152e6eb9] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.BonusController.getClientBonusBalance(java.util.UUID); target is of class [com.westwood.controller.BonusController]
2026-01-05 23:48:14.154 DEBUG [http-nio-8080-exec-9] [b9c33763-8a2e-48e9-80a1-9536152e6eb9] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 23:48:14.156 DEBUG [http-nio-8080-exec-9] [b9c33763-8a2e-48e9-80a1-9536152e6eb9] org.hibernate.SQL                        : 
    select
        t1_0.client_id,
        t1_0.tag 
    from
        client_tags t1_0 
    where
        t1_0.client_id=?
2026-01-05 23:48:14.157 DEBUG [http-nio-8080-exec-9] [b9c33763-8a2e-48e9-80a1-9536152e6eb9] org.hibernate.SQL                        : 
    select
        be1_0.id,
        be1_0.event_type,
        be1_0.bonus_amount,
        be1_0.client_id,
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version,
        be1_0.created_at,
        be1_0.event_id,
        be1_0.updated_at,
        be1_0.version,
        be1_1.bonus_percentage,
        be1_1.payment_amount,
        be1_1.payment_transaction_id,
        be1_2.final_payment_amount,
        be1_2.original_payment_amount,
        be1_2.payment_transaction_id 
    from
        bonus_events be1_0 
    left join
        bonus_granted be1_1 
            on be1_0.id=be1_1.id 
    left join
        bonus_used be1_2 
            on be1_0.id=be1_2.id 
    left join
        clients c1_0 
            on c1_0.id=be1_0.client_id 
    where
        be1_0.client_id=? 
    order by
        be1_0.created_at
2026-01-05 23:48:24.058 DEBUG [http-nio-8080-exec-10] [00c24b7c-dfa7-4c96-a717-d702e743de76] o.s.security.web.FilterChainProxy        : Securing POST /api/v1/payments
2026-01-05 23:48:24.069 DEBUG [http-nio-8080-exec-10] [00c24b7c-dfa7-4c96-a717-d702e743de76] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 23:48:24.074 DEBUG [http-nio-8080-exec-10] [00c24b7c-dfa7-4c96-a717-d702e743de76] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 23:48:24.078 DEBUG [http-nio-8080-exec-10] [00c24b7c-dfa7-4c96-a717-d702e743de76] o.s.security.web.FilterChainProxy        : Secured POST /api/v1/payments
2026-01-05 23:48:24.115 DEBUG [http-nio-8080-exec-10] [00c24b7c-dfa7-4c96-a717-d702e743de76] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 23:48:24.116 DEBUG [http-nio-8080-exec-10] [00c24b7c-dfa7-4c96-a717-d702e743de76] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.PaymentController.createPayment(com.westwood.common.dto.CreatePaymentRequest); target is of class [com.westwood.controller.PaymentController]
2026-01-05 23:48:24.118 DEBUG [http-nio-8080-exec-10] [00c24b7c-dfa7-4c96-a717-d702e743de76] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 23:48:24.122 DEBUG [http-nio-8080-exec-10] [00c24b7c-dfa7-4c96-a717-d702e743de76] org.hibernate.SQL                        : 
    select
        t1_0.client_id,
        t1_0.tag 
    from
        client_tags t1_0 
    where
        t1_0.client_id=?
2026-01-05 23:48:24.123 DEBUG [http-nio-8080-exec-10] [00c24b7c-dfa7-4c96-a717-d702e743de76] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        r1_0.user_id,
        r1_0.role,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    left join
        user_roles r1_0 
            on u1_0.id=r1_0.user_id 
    where
        u1_0.id=?
2026-01-05 23:48:24.134 DEBUG [http-nio-8080-exec-10] [00c24b7c-dfa7-4c96-a717-d702e743de76] org.hibernate.SQL                        : 
    insert 
    into
        payment_transactions
        (amount, client_id, created_at, entered_by_user_id, notes, status, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 23:48:24.140 DEBUG [http-nio-8080-exec-10] [00c24b7c-dfa7-4c96-a717-d702e743de76] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 23:48:24.148 DEBUG [http-nio-8080-exec-10] [00c24b7c-dfa7-4c96-a717-d702e743de76] org.hibernate.SQL                        : 
    select
        bc1_0.id,
        bc1_0.active,
        bc1_0.bonus_percentage,
        bc1_0.created_at,
        bc1_0.description,
        bc1_0.effective_from,
        bc1_0.effective_to,
        bc1_0.updated_at,
        bc1_0.version 
    from
        bonus_configurations bc1_0 
    where
        bc1_0.active=true 
        and (
            bc1_0.effective_to is null 
            or bc1_0.effective_to>?
        ) 
    order by
        bc1_0.effective_from desc
2026-01-05 23:48:24.153 DEBUG [http-nio-8080-exec-10] [00c24b7c-dfa7-4c96-a717-d702e743de76] org.hibernate.SQL                        : 
    insert 
    into
        bonus_events
        (bonus_amount, client_id, created_at, event_id, updated_at, version, event_type, id) 
    values
        (?, ?, ?, ?, ?, ?, 'GRANTED', default)
2026-01-05 23:48:24.155 DEBUG [http-nio-8080-exec-10] [00c24b7c-dfa7-4c96-a717-d702e743de76] org.hibernate.SQL                        : 
    insert 
    into
        bonus_granted
        (bonus_percentage, payment_amount, payment_transaction_id, id) 
    values
        (?, ?, ?, ?)
2026-01-05 23:48:24.155 DEBUG [http-nio-8080-exec-10] [00c24b7c-dfa7-4c96-a717-d702e743de76] org.hibernate.SQL                        : 
    insert 
    into
        event_store
        (aggregate_id, aggregate_type, created_at, event_data, event_id, event_type, timestamp, updated_at, version, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2026-01-05 23:48:30.815 DEBUG [http-nio-8080-exec-2] [862aad42-9a6e-4577-96da-3d5c89ee7963] o.s.security.web.FilterChainProxy        : Securing GET /api/v1/bonuses/client/bebf6b39-8b6d-4eaf-a1ae-e8b9d36589f2/balance
2026-01-05 23:48:30.819 DEBUG [http-nio-8080-exec-2] [862aad42-9a6e-4577-96da-3d5c89ee7963] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 23:48:30.821 DEBUG [http-nio-8080-exec-2] [862aad42-9a6e-4577-96da-3d5c89ee7963] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 23:48:30.824 DEBUG [http-nio-8080-exec-2] [862aad42-9a6e-4577-96da-3d5c89ee7963] o.s.security.web.FilterChainProxy        : Secured GET /api/v1/bonuses/client/bebf6b39-8b6d-4eaf-a1ae-e8b9d36589f2/balance
2026-01-05 23:48:30.826 DEBUG [http-nio-8080-exec-2] [862aad42-9a6e-4577-96da-3d5c89ee7963] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.BonusController.getClientBonusBalance(java.util.UUID); target is of class [com.westwood.controller.BonusController]
2026-01-05 23:48:30.827 DEBUG [http-nio-8080-exec-2] [862aad42-9a6e-4577-96da-3d5c89ee7963] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.BonusController.getClientBonusBalance(java.util.UUID); target is of class [com.westwood.controller.BonusController]
2026-01-05 23:48:30.830 DEBUG [http-nio-8080-exec-2] [862aad42-9a6e-4577-96da-3d5c89ee7963] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 23:48:30.831 DEBUG [http-nio-8080-exec-2] [862aad42-9a6e-4577-96da-3d5c89ee7963] org.hibernate.SQL                        : 
    select
        t1_0.client_id,
        t1_0.tag 
    from
        client_tags t1_0 
    where
        t1_0.client_id=?
2026-01-05 23:48:30.836 DEBUG [http-nio-8080-exec-2] [862aad42-9a6e-4577-96da-3d5c89ee7963] org.hibernate.SQL                        : 
    select
        be1_0.id,
        be1_0.event_type,
        be1_0.bonus_amount,
        be1_0.client_id,
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version,
        be1_0.created_at,
        be1_0.event_id,
        be1_0.updated_at,
        be1_0.version,
        be1_1.bonus_percentage,
        be1_1.payment_amount,
        be1_1.payment_transaction_id,
        be1_2.final_payment_amount,
        be1_2.original_payment_amount,
        be1_2.payment_transaction_id 
    from
        bonus_events be1_0 
    left join
        bonus_granted be1_1 
            on be1_0.id=be1_1.id 
    left join
        bonus_used be1_2 
            on be1_0.id=be1_2.id 
    left join
        clients c1_0 
            on c1_0.id=be1_0.client_id 
    where
        be1_0.client_id=? 
    order by
        be1_0.created_at
2026-01-05 23:49:43.844 DEBUG [http-nio-8080-exec-3] [9ed3fbc3-0b7e-4d44-ab43-455ca9c9de8c] o.s.security.web.FilterChainProxy        : Securing GET /api/v1/clients/phone/+77021475451
2026-01-05 23:49:43.864 DEBUG [http-nio-8080-exec-3] [9ed3fbc3-0b7e-4d44-ab43-455ca9c9de8c] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 23:49:43.867 DEBUG [http-nio-8080-exec-3] [9ed3fbc3-0b7e-4d44-ab43-455ca9c9de8c] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 23:49:43.872 DEBUG [http-nio-8080-exec-3] [9ed3fbc3-0b7e-4d44-ab43-455ca9c9de8c] o.s.security.web.FilterChainProxy        : Secured GET /api/v1/clients/phone/+77021475451
2026-01-05 23:49:43.930 DEBUG [http-nio-8080-exec-3] [9ed3fbc3-0b7e-4d44-ab43-455ca9c9de8c] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.ClientController.getClientByPhone(java.lang.String); target is of class [com.westwood.controller.ClientController]
2026-01-05 23:49:43.934 DEBUG [http-nio-8080-exec-3] [9ed3fbc3-0b7e-4d44-ab43-455ca9c9de8c] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.ClientController.getClientByPhone(java.lang.String); target is of class [com.westwood.controller.ClientController]
2026-01-05 23:49:43.937 DEBUG [http-nio-8080-exec-3] [9ed3fbc3-0b7e-4d44-ab43-455ca9c9de8c] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.phone=?
2026-01-05 23:50:12.293 DEBUG [http-nio-8080-exec-5] [5feacafa-dbd4-4306-b1ce-362db7b682e6] o.s.security.web.FilterChainProxy        : Securing GET /api/v1/clients/phone/+77921475451
2026-01-05 23:50:12.325 DEBUG [http-nio-8080-exec-5] [5feacafa-dbd4-4306-b1ce-362db7b682e6] org.hibernate.SQL                        : 
    select
        u1_0.id,
        u1_0.account_status,
        u1_0.activation_token,
        u1_0.activation_token_expiry,
        u1_0.active,
        u1_0.created_at,
        u1_0.email,
        u1_0.first_name,
        u1_0.last_name,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username,
        u1_0.uuid,
        u1_0.version 
    from
        users u1_0 
    where
        u1_0.username=?
2026-01-05 23:50:12.467 DEBUG [http-nio-8080-exec-5] [5feacafa-dbd4-4306-b1ce-362db7b682e6] org.hibernate.SQL                        : 
    select
        r1_0.user_id,
        r1_0.role 
    from
        user_roles r1_0 
    where
        r1_0.user_id=?
2026-01-05 23:50:12.471 DEBUG [http-nio-8080-exec-5] [5feacafa-dbd4-4306-b1ce-362db7b682e6] o.s.security.web.FilterChainProxy        : Secured GET /api/v1/clients/phone/+77921475451
2026-01-05 23:50:12.473 DEBUG [http-nio-8080-exec-5] [5feacafa-dbd4-4306-b1ce-362db7b682e6] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.ClientController.getClientByPhone(java.lang.String); target is of class [com.westwood.controller.ClientController]
2026-01-05 23:50:12.474 DEBUG [http-nio-8080-exec-5] [5feacafa-dbd4-4306-b1ce-362db7b682e6] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public org.springframework.http.ResponseEntity com.westwood.controller.ClientController.getClientByPhone(java.lang.String); target is of class [com.westwood.controller.ClientController]
2026-01-05 23:50:12.476 DEBUG [http-nio-8080-exec-5] [5feacafa-dbd4-4306-b1ce-362db7b682e6] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.phone=?
2026-01-05 23:50:12.477 DEBUG [http-nio-8080-exec-5] [5feacafa-dbd4-4306-b1ce-362db7b682e6] org.hibernate.SQL                        : 
    select
        t1_0.client_id,
        t1_0.tag 
    from
        client_tags t1_0 
    where
        t1_0.client_id=?
2026-01-05 23:50:12.480 DEBUG [http-nio-8080-exec-5] [5feacafa-dbd4-4306-b1ce-362db7b682e6] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version 
    from
        clients c1_0 
    where
        c1_0.uuid=?
2026-01-05 23:50:12.500 DEBUG [http-nio-8080-exec-5] [5feacafa-dbd4-4306-b1ce-362db7b682e6] org.hibernate.SQL                        : 
    select
        be1_0.id,
        be1_0.event_type,
        be1_0.bonus_amount,
        be1_0.client_id,
        c1_0.id,
        c1_0.client_type,
        c1_0.created_at,
        c1_0.name,
        c1_0.notes,
        c1_0.phone,
        c1_0.surname,
        c1_0.updated_at,
        c1_0.uuid,
        c1_0.version,
        be1_0.created_at,
        be1_0.event_id,
        be1_0.updated_at,
        be1_0.version,
        be1_1.bonus_percentage,
        be1_1.payment_amount,
        be1_1.payment_transaction_id,
        be1_2.final_payment_amount,
        be1_2.original_payment_amount,
        be1_2.payment_transaction_id 
    from
        bonus_events be1_0 
    left join
        bonus_granted be1_1 
            on be1_0.id=be1_1.id 
    left join
        bonus_used be1_2 
            on be1_0.id=be1_2.id 
    left join
        clients c1_0 
            on c1_0.id=be1_0.client_id 
    where
        be1_0.client_id=? 
    order by
        be1_0.created_at
