{
  "version": 3,
  "sources": ["src/app/features/auth/pages/reset-password-page/reset-password-page.component.ts"],
  "sourcesContent": ["import { Component, OnDestroy, OnInit, inject } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormBuilder, FormGroup, Validators, ReactiveFormsModule, AbstractControl, ValidationErrors } from '@angular/forms';\nimport { ActivatedRoute, RouterModule } from '@angular/router';\nimport { Store } from '@ngrx/store';\nimport { Observable, Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\nimport { resetPassword, clearError } from '../../../../core/store/auth/auth.actions';\nimport { selectAuthError, selectIsLoading } from '../../../../core/store/auth/auth.selectors';\nimport { AlertComponent } from '../../../../shared/components/alert/alert.component';\nimport { InputComponent } from '../../../../shared/components/input/input.component';\nimport { ButtonComponent } from '../../../../shared/components/button/button.component';\nimport { AuthPromoPanelComponent } from '../../../../shared/components/auth-promo-panel/auth-promo-panel.component';\nimport { authMobileStyles } from '../../../../shared/styles/auth-mobile.styles';\n\n@Component({\n  selector: 'app-reset-password-page',\n  standalone: true,\n  imports: [\n    CommonModule,\n    ReactiveFormsModule,\n    RouterModule,\n    AlertComponent,\n    InputComponent,\n    ButtonComponent,\n    AuthPromoPanelComponent\n  ],\n  template: `\n    <div class=\"reset-password-page auth-page\">\n      <!-- Left Promotional Panel -->\n      <app-auth-promo-panel class=\"promo-panel-desktop\"></app-auth-promo-panel>\n\n      <!-- Right Reset Password Form Panel -->\n      <div class=\"form-panel\">\n        <div class=\"form-content\">\n          <div class=\"form-header\">\n            <h2 class=\"brand-name\">WestWood</h2>\n            <h3 class=\"welcome-title\">Смена пароля</h3>\n          </div>\n\n          <app-alert\n            *ngIf=\"errorMessage\"\n            type=\"error\"\n            [title]=\"'Ошибка смены пароля'\"\n            [dismissible]=\"true\"\n            (dismissed)=\"errorMessage = ''\"\n            class=\"error-alert\">\n            {{ errorMessage }}\n          </app-alert>\n\n          <app-alert\n            *ngIf=\"successMessage\"\n            type=\"success\"\n            [title]=\"'Успешно'\"\n            [dismissible]=\"true\"\n            (dismissed)=\"successMessage = ''\"\n            class=\"success-alert\">\n            {{ successMessage }}\n          </app-alert>\n\n          <form [formGroup]=\"resetPasswordForm\" (ngSubmit)=\"onSubmit()\" class=\"reset-password-form auth-form\">\n            <app-input\n              id=\"password\"\n              label=\"Новый пароль\"\n              type=\"password\"\n              placeholder=\"Введите новый пароль\"\n              formControlName=\"password\"\n              [errorMessage]=\"getErrorMessage('password')\"\n              [required]=\"true\"\n              [showPasswordToggle]=\"true\">\n            </app-input>\n\n            <app-input\n              id=\"confirmPassword\"\n              label=\"Подтвердите пароль\"\n              type=\"password\"\n              placeholder=\"Подтвердите новый пароль\"\n              formControlName=\"confirmPassword\"\n              [errorMessage]=\"getErrorMessage('confirmPassword')\"\n              [required]=\"true\"\n              [showPasswordToggle]=\"true\">\n            </app-input>\n\n            <app-button\n              buttonType=\"primary\"\n              type=\"submit\"\n              [disabled]=\"resetPasswordForm.invalid\"\n              [loading]=\"isLoading\"\n              class=\"submit-button\">\n              Сменить пароль\n            </app-button>\n          </form>\n\n          <div class=\"form-footer\">\n            <span>© 2026 WestWood. Все права защищены.</span>\n          </div>\n        </div>\n      </div>\n    </div>\n  `,\n  styles: [`\n    .reset-password-page {\n      display: flex;\n      min-height: 100vh;\n      height: 100vh;\n      background: #F5F6F8;\n    }\n\n    /* Right Form Panel */\n    .form-panel {\n      flex: 0 0 45%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      padding: 3rem;\n      background: #ffffff;\n    }\n\n    .form-content {\n      width: 100%;\n      max-width: 360px;\n      animation: slideUp 0.5s ease-out;\n    }\n\n    @keyframes slideUp {\n      from {\n        opacity: 0;\n        transform: translateY(30px);\n      }\n      to {\n        opacity: 1;\n        transform: translateY(0);\n      }\n    }\n\n    .form-header {\n      margin-bottom: 2rem;\n    }\n\n    .brand-name {\n      font-size: 1.75rem;\n      font-weight: 700;\n      color: #1a202c;\n      margin: 0 0 0.75rem 0;\n      letter-spacing: -0.02em;\n    }\n\n    .welcome-title {\n      font-size: 2rem;\n      font-weight: 700;\n      color: #1a202c;\n      margin: 0;\n    }\n\n    .error-alert,\n    .success-alert {\n      margin-bottom: 1.5rem;\n      animation: shake 0.5s ease-out;\n    }\n\n    @keyframes shake {\n      0%, 100% { transform: translateX(0); }\n      25% { transform: translateX(-10px); }\n      75% { transform: translateX(10px); }\n    }\n\n    .reset-password-form {\n      display: flex;\n      flex-direction: column;\n      gap: 1rem;\n    }\n\n    .submit-button {\n      width: 100%;\n      margin-top: 0.25rem;\n    }\n\n    :host ::ng-deep .submit-button button {\n      width: 100%;\n      padding: 0.875rem 1.5rem !important;\n      font-size: 1rem !important;\n      font-weight: 600 !important;\n      border-radius: 4px !important;\n      background-color: #0F0F10 !important;\n      color: white !important;\n      transition: all 0.2s ease !important;\n    }\n\n    ${authMobileStyles}\n  `]\n})\nexport class ResetPasswordPageComponent implements OnInit, OnDestroy {\n  private fb = inject(FormBuilder);\n  private route = inject(ActivatedRoute);\n  private store = inject(Store);\n  private destroy$ = new Subject<void>();\n\n  resetPasswordForm: FormGroup;\n  isLoading = false;\n  errorMessage = '';\n  successMessage = '';\n  resetToken: string | null = null;\n\n  constructor() {\n    this.resetPasswordForm = this.fb.group({\n      password: ['', [Validators.required, Validators.minLength(6)]],\n      confirmPassword: ['', [Validators.required]]\n    }, { validators: this.passwordMatchValidator });\n  }\n\n  ngOnInit(): void {\n    // Clear any existing errors when entering the page\n    this.store.dispatch(clearError());\n\n    // Get token from query parameters\n    this.resetToken = this.route.snapshot.queryParams['token'];\n    \n    if (!this.resetToken) {\n      this.errorMessage = 'Токен сброса пароля не найден. Пожалуйста, используйте ссылку из письма.';\n    }\n\n    // Subscribe to auth state changes\n    this.store.select(selectIsLoading).pipe(\n      takeUntil(this.destroy$)\n    ).subscribe(isLoading => {\n      this.isLoading = isLoading;\n    });\n\n    this.store.select(selectAuthError).pipe(\n      takeUntil(this.destroy$)\n    ).subscribe(error => {\n      if (error) {\n        this.errorMessage = error;\n        this.successMessage = '';\n      }\n    });\n  }\n\n  ngOnDestroy(): void {\n    this.destroy$.next();\n    this.destroy$.complete();\n  }\n\n  passwordMatchValidator(control: AbstractControl): ValidationErrors | null {\n    const password = control.get('password');\n    const confirmPassword = control.get('confirmPassword');\n    \n    if (password && confirmPassword && password.value !== confirmPassword.value) {\n      confirmPassword.setErrors({ passwordMismatch: true });\n      return { passwordMismatch: true };\n    }\n    \n    if (confirmPassword && confirmPassword.errors && confirmPassword.errors['passwordMismatch'] && password && password.value === confirmPassword.value) {\n      confirmPassword.setErrors(null);\n    }\n    \n    return null;\n  }\n\n  onSubmit(): void {\n    if (this.resetPasswordForm.valid && this.resetToken) {\n      this.errorMessage = '';\n      this.successMessage = '';\n      \n      const formValue = this.resetPasswordForm.value;\n      const resetData = {\n        token: this.resetToken,\n        password: formValue.password\n      };\n\n      console.log('[ResetPasswordPage] Resetting password with token:', this.resetToken);\n\n      // Dispatch action - effect will handle API call, state update, and navigation\n      this.store.dispatch(resetPassword({ data: resetData }));\n    } else if (!this.resetToken) {\n      this.errorMessage = 'Токен сброса пароля не найден. Пожалуйста, используйте ссылку из письма.';\n    }\n  }\n\n  getErrorMessage(controlName: string): string {\n    const control = this.resetPasswordForm.get(controlName);\n    if (control?.errors && control.touched) {\n      if (control.errors['required']) {\n        return 'Это поле обязательно для заполнения';\n      }\n      if (control.errors['minlength']) {\n        return `Минимальная длина: ${control.errors['minlength'].requiredLength} символов`;\n      }\n      if (control.errors['passwordMismatch']) {\n        return 'Пароли не совпадают';\n      }\n    }\n    return '';\n  }\n}\n"],
  "mappings": "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",
  "names": []
}
