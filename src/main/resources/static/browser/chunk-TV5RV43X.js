import{a as J}from"./chunk-R6PMAZSB.js";import{a as K}from"./chunk-A4EUNQZ7.js";import{a as X}from"./chunk-PXRPPFZK.js";import{a as Q}from"./chunk-QA7ABRFW.js";import"./chunk-3B24VZJ2.js";import{e as V,g as H,m as U,n as j,o as G,u as q}from"./chunk-OGICRJHM.js";import{$ as y,Aa as T,Ca as n,Da as i,Db as $,Ea as g,Fa as F,Ga as R,Gb as Y,Ia as D,Ja as b,Ka as x,Sa as o,T as C,Ta as h,Ua as s,Z as O,_ as E,aa as M,bb as v,cb as B,db as w,gb as A,k as P,ma as a,mb as L,nb as z,pa as I,tb as W,u as S,ua as f,ub as N,xa as k,ya as p,za as _}from"./chunk-SDVY3Z22.js";function Z(l,d){if(l&1&&(n(0,"option",16),o(1),i()),l&2){let e=d.$implicit;p("value",e.id),a(),h(e.name)}}function ee(l,d){l&1&&(n(0,"div",17),g(1,"app-loader",18),i()),l&2&&(a(),p("visible",!0)("overlay",!1))}function te(l,d){if(l&1&&(n(0,"span"),o(1),i()),l&2){let e=d.$implicit;a(),h(e)}}function ne(l,d){if(l&1&&g(0,"span",73),l&2){let e=d.index;_("top",e/4*100,"%")}}function ie(l,d){if(l&1&&(n(0,"div",74)(1,"span",32),o(2,"Retention rate"),i(),n(3,"span",33),o(4),i()()),l&2){let e=x(2);a(4),s("",e.formatPct(e.report.retentionRatePercent),"%")}}function oe(l,d){if(l&1&&(n(0,"div",74)(1,"span",32),o(2,"Conversion Rate"),i(),n(3,"span",33),o(4),i(),n(5,"span",32),o(6,"CAC"),i(),n(7,"span",33),o(8),i()()),l&2){let e=x(2);a(4),s("",e.formatPct(e.report.conversionRatePercent),"%"),a(4),s("",e.formatMoney(e.report.cac)," \u20B8")}}function re(l,d){if(l&1&&(n(0,"option",16),o(1),i()),l&2){let e=d.$implicit;p("value",e),a(),h(e)}}function ae(l,d){if(l&1&&(n(0,"span"),o(1),i()),l&2){let e=d.$implicit;a(),h(e)}}function le(l,d){if(l&1&&g(0,"span",94),l&2){let e=d.index;_("top",e/4*100,"%")}}function ue(l,d){if(l&1){let e=D();n(0,"div",95)(1,"div",96)(2,"div",97),b("click",function(){let r=O(e).$implicit,u=x(4);return E(u.selectMonth(r.yearMonth))}),n(3,"div",98)(4,"div",99),o(5),i(),n(6,"div",100),o(7),i(),n(8,"div",100),o(9),i(),n(10,"div",100),o(11),i()()(),n(12,"div",101),b("click",function(){let r=O(e).$implicit,u=x(4);return E(u.selectMonth(r.yearMonth))}),n(13,"div",98)(14,"div",99),o(15),i(),n(16,"div",100),o(17),i(),n(18,"div",100),o(19),i(),n(20,"div",100),o(21),i()()(),n(22,"div",102),b("click",function(){let r=O(e).$implicit,u=x(4);return E(u.selectMonth(r.yearMonth))}),n(23,"div",98)(24,"div",99),o(25),i(),n(26,"div",100),o(27),i(),n(28,"div",100),o(29),i(),n(30,"div",100),o(31),i()()()(),n(32,"div",103),o(33),i()()}if(l&2){let e,t,r,u,c=d.$implicit,m=x(4);a(),T("selected",m.isMonthSelected(c)),a(),_("height",m.monthlyChartMax?c.avgCheckWithBonus/m.monthlyChartMax*100:0,"%"),a(3),h(c.month),a(2),s("\u0412\u044B\u0440\u0443\u0447\u043A\u0430: ",m.formatMoneyShort((e=c.revenue)!==null&&e!==void 0?e:0),""),a(2),s("\u0421\u0440\u0435\u0434\u043D\u0438\u0439 \u0447\u0435\u043A \u0441 \u0431\u043E\u043D\u0443\u0441\u043E\u043C: ",m.formatMoneyShort(c.avgCheckWithBonus),""),a(2),s("\u0421\u0440\u0435\u0434\u043D\u0438\u0439 \u0447\u0435\u043A \u0431\u0435\u0437 \u0431\u043E\u043D\u0443\u0441\u043E\u0432: ",m.formatMoneyShort(c.avgCheckWithoutBonus),""),a(),_("height",m.monthlyChartMax?c.avgCheckWithoutBonus/m.monthlyChartMax*100:0,"%"),a(3),h(c.month),a(2),s("\u0412\u044B\u0440\u0443\u0447\u043A\u0430: ",m.formatMoneyShort((t=c.revenue)!==null&&t!==void 0?t:0),""),a(2),s("\u0421\u0440\u0435\u0434\u043D\u0438\u0439 \u0447\u0435\u043A \u0441 \u0431\u043E\u043D\u0443\u0441\u043E\u043C: ",m.formatMoneyShort(c.avgCheckWithBonus),""),a(2),s("\u0421\u0440\u0435\u0434\u043D\u0438\u0439 \u0447\u0435\u043A \u0431\u0435\u0437 \u0431\u043E\u043D\u0443\u0441\u043E\u0432: ",m.formatMoneyShort(c.avgCheckWithoutBonus),""),a(),_("height",m.monthlyRevenueMax?((r=c.revenue)!==null&&r!==void 0?r:0)/m.monthlyRevenueMax*100:0,"%"),a(3),h(c.month),a(2),s("\u0412\u044B\u0440\u0443\u0447\u043A\u0430: ",m.formatMoneyShort((u=c.revenue)!==null&&u!==void 0?u:0),""),a(2),s("\u0421\u0440\u0435\u0434\u043D\u0438\u0439 \u0447\u0435\u043A \u0441 \u0431\u043E\u043D\u0443\u0441\u043E\u043C: ",m.formatMoneyShort(c.avgCheckWithBonus),""),a(2),s("\u0421\u0440\u0435\u0434\u043D\u0438\u0439 \u0447\u0435\u043A \u0431\u0435\u0437 \u0431\u043E\u043D\u0443\u0441\u043E\u0432: ",m.formatMoneyShort(c.avgCheckWithoutBonus),""),a(2),h(c.month)}}function ce(l,d){if(l&1&&(n(0,"span"),o(1),i()),l&2){let e=d.$implicit;a(),h(e)}}function se(l,d){if(l&1&&(n(0,"div",83)(1,"div",84)(2,"div",85),f(3,ae,2,1,"span",51),i(),n(4,"div",86)(5,"div",87),f(6,le,1,2,"span",88),i(),n(7,"div",89),f(8,ue,34,21,"div",90),i()(),n(9,"div",91),f(10,ce,2,1,"span",51),i()(),n(11,"div",92)(12,"span",60),o(13,"\u0421\u0440\u0435\u0434\u043D\u0438\u0439 \u0447\u0435\u043A \u0441 \u0431\u043E\u043D\u0443\u0441\u043E\u043C"),i(),n(14,"span",61),o(15,"\u0421\u0440\u0435\u0434\u043D\u0438\u0439 \u0447\u0435\u043A \u0431\u0435\u0437 \u0431\u043E\u043D\u0443\u0441\u043E\u0432"),i(),n(16,"span",93),o(17,"\u0412\u044B\u0440\u0443\u0447\u043A\u0430 \u0437\u0430 \u043C\u0435\u0441\u044F\u0446"),i()()()),l&2){let e=x(3);a(3),p("ngForOf",e.getMonthlyLeftAxisLabels()),a(3),p("ngForOf",e.getMonthlyLeftAxisLabels()),a(2),p("ngForOf",e.monthlyChartData),a(2),p("ngForOf",e.getMonthlyRightAxisLabels())}}function pe(l,d){l&1&&(n(0,"div",104),g(1,"app-loader",105),i()),l&2&&(a(),p("visible",!0)("overlay",!1))}function de(l,d){if(l&1){let e=D();n(0,"section",75)(1,"div",76)(2,"div",77),y(),n(3,"svg",27),g(4,"path",67)(5,"path",68)(6,"path",69)(7,"path",70),i()(),M(),n(8,"h3",78),o(9,"\u0421\u0440\u0435\u0434\u043D\u0438\u0439 \u0447\u0435\u043A \u0438 \u0432\u044B\u0440\u0443\u0447\u043A\u0430 \u043F\u043E \u043C\u0435\u0441\u044F\u0446\u0430\u043C"),i(),n(10,"div",79)(11,"select",80),b("ngModelChange",function(r){O(e);let u=x(2);return E(u.onChartYearChange(r))}),f(12,re,2,2,"option",7),i()()(),f(13,se,18,4,"div",81)(14,pe,2,2,"div",82),i()}if(l&2){let e=x(2);a(11),p("ngModel",e.chartYear),a(),p("ngForOf",e.availableChartYears),a(),p("ngIf",!e.isMonthlyChartLoading),a(),p("ngIf",e.isMonthlyChartLoading)}}function me(l,d){if(l&1&&(F(0),n(1,"div",19)(2,"div",20)(3,"h2",21),o(4),i(),n(5,"p",22),o(6),i()(),n(7,"div",23)(8,"section",24)(9,"div",25)(10,"div",26),y(),n(11,"svg",27),g(12,"path",28),i()(),M(),n(13,"h3",29),o(14,"\u0422\u0440\u0430\u043D\u0437\u0430\u043A\u0446\u0438\u0438"),i()(),n(15,"div",30)(16,"div",31)(17,"span",32),o(18,"\u041A\u043E\u043B-\u0432\u043E \u0442\u0440\u0430\u043D\u0437\u0430\u043A\u0446\u0438\u0439"),i(),n(19,"span",33),o(20),v(21,"number"),i()(),n(22,"div",31)(23,"span",32),o(24,"\u0421\u0440\u0435\u0434\u043D\u0438\u0439 \u0447\u0435\u043A \u0441 \u0431\u043E\u043D\u0443\u0441\u043E\u043C"),i(),n(25,"span",33),o(26),i()(),n(27,"div",31)(28,"span",32),o(29,"\u0421\u0440\u0435\u0434\u043D\u0438\u0439 \u0447\u0435\u043A \u0431\u0435\u0437 \u0431\u043E\u043D\u0443\u0441\u043E\u0432"),i(),n(30,"span",33),o(31),i()()()(),n(32,"div",34)(33,"h3",35),o(34,"\u041F\u0440\u043E\u0434\u0430\u0436\u0438"),i(),n(35,"div",36),y(),n(36,"svg",37),g(37,"circle",38)(38,"circle",39)(39,"circle",40),i()(),M(),n(40,"div",41)(41,"div",42),g(42,"span",43),n(43,"span",44),o(44,"\u0421 \u0431\u043E\u043D\u0443\u0441\u0430\u043C\u0438"),i(),n(45,"span",45),o(46),v(47,"number"),i(),n(48,"span",46),o(49),v(50,"number"),i()(),n(51,"div",42),g(52,"span",47),n(53,"span",44),o(54,"\u0411\u0435\u0437 \u0431\u043E\u043D\u0443\u0441\u043E\u0432"),i(),n(55,"span",45),o(56),v(57,"number"),i(),n(58,"span",46),o(59),v(60,"number"),i()()()(),n(61,"div",48)(62,"h3",35),o(63,"\u0421\u0440\u0435\u0434\u043D\u0438\u0439 \u0447\u0435\u043A"),i(),n(64,"div",49)(65,"div",50),f(66,te,2,1,"span",51),i(),n(67,"div",52)(68,"div",53),f(69,ne,1,2,"span",54),i(),n(70,"div",55)(71,"div",56),g(72,"div",57),i(),n(73,"div",56),g(74,"div",58),i()()()(),n(75,"div",59)(76,"span",60),o(77,"\u0421 \u0431\u043E\u043D\u0443\u0441\u043E\u043C"),i(),n(78,"span",61),o(79,"\u0411\u0435\u0437 \u0431\u043E\u043D\u0443\u0441\u0430"),i()()(),n(80,"div",62)(81,"h3",35),o(82,"\u0412 \u043E\u0431\u043E\u0440\u043E\u0442\u0435 / \u041F\u043E\u0442\u0440\u0430\u0447\u0435\u043D\u043E"),i(),n(83,"div",36),y(),n(84,"svg",37),g(85,"circle",38)(86,"circle",39)(87,"circle",40),i()(),M(),n(88,"div",41)(89,"div",42),g(90,"span",43),n(91,"span",44),o(92,"\u0412 \u043E\u0431\u043E\u0440\u043E\u0442\u0435"),i(),n(93,"span",45),o(94),v(95,"number"),i(),n(96,"span",46),o(97),i()(),n(98,"div",42),g(99,"span",47),n(100,"span",44),o(101,"\u041F\u043E\u0442\u0440\u0430\u0447\u0435\u043D\u043E"),i(),n(102,"span",45),o(103),v(104,"number"),i(),n(105,"span",46),o(106),i()()()()(),n(107,"div",63)(108,"section",24)(109,"div",25)(110,"div",64),y(),n(111,"svg",27),g(112,"path",65),i()(),M(),n(113,"h3",29),o(114,"\u0411\u043E\u043D\u0443\u0441\u044B"),i()(),n(115,"div",30)(116,"div",31)(117,"span",32),o(118,"\u0421\u0443\u043C\u043C\u0430 \u0432\u044B\u0434\u0435\u043B\u0435\u043D\u043D\u044B\u0445"),i(),n(119,"span",33),o(120),i()(),n(121,"div",31)(122,"span",32),o(123,"\u0412 \u043E\u0431\u043E\u0440\u043E\u0442\u0435"),i(),n(124,"span",33),o(125),i()(),n(126,"div",31)(127,"span",32),o(128,"\u0421\u0433\u043E\u0440\u0435\u0432\u0448\u0438\u0435"),i(),n(129,"span",33),o(130),i()(),n(131,"div",31)(132,"span",32),o(133,"\u041F\u043E\u0442\u0440\u0430\u0447\u0435\u043D\u043D\u044B\u0435"),i(),n(134,"span",33),o(135),i()()()(),n(136,"section",24)(137,"div",25)(138,"div",66),y(),n(139,"svg",27),g(140,"path",67)(141,"path",68)(142,"path",69)(143,"path",70),i()(),M(),n(144,"h3",29),o(145,"\u042D\u0444\u0444\u0435\u043A\u0442\u0438\u0432\u043D\u043E\u0441\u0442\u044C"),i()(),n(146,"div",30)(147,"div",31)(148,"span",32),o(149,"Redemption rate"),i(),n(150,"span",33),o(151),i()(),n(152,"div",31)(153,"span",32),o(154,"Effective discount"),i(),n(155,"span",33),o(156),i()(),n(157,"div",31)(158,"span",32),o(159,"Burn rate"),i(),n(160,"span",33),o(161),i()(),n(162,"div",31)(163,"span",32),o(164,"AOV uplift"),i(),n(165,"span",33),o(166),i()(),n(167,"div",31)(168,"span",32),o(169,"Incremental revenue"),i(),n(170,"span",33),o(171),i()()(),f(172,ie,5,1,"div",71)(173,oe,9,2,"div",71),i(),f(174,de,15,4,"section",72),i()(),R()),l&2){let e,t=x();a(4),h(t.report.bonusTypeName),a(2),h(t.formatPeriod(t.report.periodFrom,t.report.periodTo)),a(14),h(B(21,37,t.displayTransactionCount)),a(6),s("",t.formatMoney(t.report.avgCheckWithBonus)," \u20B8"),a(5),s("",t.formatMoney(t.report.avgCheckWithoutBonus)," \u20B8"),a(7),k("stroke-dasharray",t.getDonutSalesDash()),a(),k("stroke-dasharray",t.getDonutSalesDash())("stroke-dashoffset",t.getDonutSalesOffset()),a(7),s("",w(47,39,t.donutSalesWithPercent,"1.0-0"),"%"),a(3),h(B(50,42,t.report.transactionCount)),a(7),s("",w(57,44,t.donutSalesWithoutPercent,"1.0-0"),"%"),a(3),h(B(60,47,(e=t.report.transactionCountWithoutBonus)!==null&&e!==void 0?e:0)),a(7),p("ngForOf",t.getAvgCheckAxisLabels()),a(3),p("ngForOf",t.getAvgCheckAxisLabels()),a(3),_("height",t.report.avgCheckWithBonus/t.maxAvgForBarRounded*100,"%"),a(2),_("height",t.report.avgCheckWithoutBonus/t.maxAvgForBarRounded*100,"%"),a(12),k("stroke-dasharray",t.getDonutBonusDash()),a(),k("stroke-dasharray",t.getDonutBonusSpentDash())("stroke-dashoffset",t.getDonutBonusOffset()),a(7),s("",w(95,49,t.donutBonusInCirculationPercent,"1.0-0"),"%"),a(3),s("",t.formatMoney(t.report.inCirculation)," \u20B8"),a(6),s("",w(104,52,100-t.donutBonusInCirculationPercent,"1.0-0"),"%"),a(3),s("",t.formatMoney(t.report.spentAmount)," \u20B8"),a(14),s("",t.formatMoney(t.report.totalGranted)," \u20B8"),a(5),s("",t.formatMoney(t.report.inCirculation)," \u20B8"),a(5),s("",t.formatMoney(t.report.burnedAmount)," \u20B8"),a(5),s("",t.formatMoney(t.report.spentAmount)," \u20B8"),a(16),s("",t.formatPct(t.report.redemptionRatePercent),"%"),a(5),s("",t.formatPct(t.report.effectiveDiscountPercent),"%"),a(5),s("",t.formatPct(t.report.burnRatePercent),"%"),a(5),s("",t.formatPct(t.report.aovUpliftPercent),"%"),a(5),s("",t.formatPct(t.report.incrementalRevenuePercent),"%"),a(),p("ngIf",t.showRetention),a(),p("ngIf",t.showReferral),a(),p("ngIf",t.monthlyChartData==null?null:t.monthlyChartData.length)}}function ge(l,d){l&1&&(n(0,"div",106)(1,"p"),o(2,"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0442\u0438\u043F \u0431\u043E\u043D\u0443\u0441\u0430 \u0434\u043B\u044F \u043F\u0440\u043E\u0441\u043C\u043E\u0442\u0440\u0430 \u043E\u0442\u0447\u0451\u0442\u0430."),i()())}function he(l,d){if(l&1&&(n(0,"div",107)(1,"p"),o(2),i()()),l&2){let e=x();a(2),h(e.errorMessage)}}var we=(()=>{class l{pageHeader=C(Q);bonusTypesService=C(J);analyticsService=C(K);cdr=C(A);router=C(Y);route=C($);bonusTypes=[];selectedBonusTypeId=null;period="1m";report=null;monthlyChartData=null;isLoading=!1;isMonthlyChartLoading=!1;errorMessage=null;selectedMonthForBar=null;chartYear=new Date().getFullYear();_initialLoadDone=!1;get showRetention(){if(!this.report)return!1;let e=this.getSelectedBonusType();return e!=null&&(e.type==="WELCOME"||e.type==="BIRTHDAY")}get showReferral(){let e=this.getSelectedBonusType();return e!=null&&e.type==="REFERRAL"}get displayTransactionCount(){return this.report?this.selectedBonusTypeId==null?this.report.transactionCount+(this.report.transactionCountWithoutBonus??0):this.report.transactionCount:0}getSelectedBonusType(){if(this.selectedBonusTypeId!=null)return this.bonusTypes.find(e=>e.id===this.selectedBonusTypeId)}ngOnInit(){this.pageHeader.setPageHeader("\u041E\u0442\u0447\u0451\u0442 \u043F\u043E \u0442\u0438\u043F\u0430\u043C \u0431\u043E\u043D\u0443\u0441\u043E\u0432",[{label:"\u0413\u043B\u0430\u0432\u043D\u0430\u044F",route:"/home"},{label:"\u041E\u0442\u0447\u0451\u0442 \u043F\u043E \u0442\u0438\u043F\u0430\u043C \u0431\u043E\u043D\u0443\u0441\u043E\u0432"}]),this.applyStateFromQueryParams(this.route.snapshot.queryParams),this.loadBonusTypes()}applyStateFromQueryParams(e){let t=e.period;t&&["1m","3m","6m","1y","all"].includes(t)&&(this.period=t);let r=e.bonusType;if(r!==void 0)if(r==="all"||r==="")this.selectedBonusTypeId=null;else{let m=Number(r);isNaN(m)||(this.selectedBonusTypeId=m)}let u=e.month;u&&/^\d{4}-\d{2}$/.test(u)&&(this.selectedMonthForBar=u);let c=e.year;if(c){let m=parseInt(c,10);!isNaN(m)&&m>=2e3&&m<=2100&&(this.chartYear=m)}}updateUrlFromState(){let e={period:this.period,bonusType:this.selectedBonusTypeId??"all",year:this.chartYear};this.selectedMonthForBar?e.month=this.selectedMonthForBar:e.month=null,this.router.navigate([],{relativeTo:this.route,queryParams:Object.fromEntries(Object.entries(e).filter(([,t])=>t!=null&&t!=="")),replaceUrl:!0})}loadBonusTypes(){this.bonusTypesService.getActiveBonusTypes().pipe(S(()=>P([]))).subscribe(e=>{if(this.bonusTypes=e,!this._initialLoadDone){if(this._initialLoadDone=!0,this.selectedBonusTypeId=this.selectedBonusTypeId??null,this.selectedMonthForBar){let[t,r]=this.selectedMonthForBar.split("-").map(Number),u=new Date(t,r-1,1,0,0,0),c=new Date(t,r,0,23,59,59);this.loadReportForRange(this.toLocalISOString(u,"00:00:00"),this.toLocalISOString(c,"23:59:59"))}else this.loadReport();this.loadMonthlyChartData()}this.cdr.markForCheck()})}onBonusTypeChange(e){let t=e===""||e==="all"?null:Number(e);this.selectedBonusTypeId=t,this.updateUrlFromState(),this.loadReport(),this.loadMonthlyChartData()}onPeriodChange(e){this.period=e,this.updateUrlFromState(),this.loadReport()}onChartYearChange(e){let t=typeof e=="string"?parseInt(e,10):e;isNaN(t)||(this.chartYear=t,this.updateUrlFromState(),this.loadMonthlyChartData())}get availableChartYears(){let e=new Date().getFullYear(),t=[];for(let r=e;r>=e-5;r--)t.push(r);return t}selectMonth(e){this.selectedMonthForBar=e,this.updateUrlFromState();let[t,r]=e.split("-").map(Number),u=new Date(t,r-1,1,0,0,0),c=new Date(t,r,0,23,59,59);this.loadReportForRange(this.toLocalISOString(u,"00:00:00"),this.toLocalISOString(c,"23:59:59"))}loadReportForRange(e,t){this.isLoading=!0,this.errorMessage=null,this.analyticsService.getBonusTypeReport(this.selectedBonusTypeId,e,t).pipe(S(r=>(this.errorMessage=r?.error?.message||"\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u043E\u0442\u0447\u0451\u0442",P(null)))).subscribe(r=>{this.report=r??null,this.isLoading=!1,this.cdr.markForCheck()})}getPeriodRange(){let e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59),r;switch(this.period){case"3m":r=new Date(e.getFullYear(),e.getMonth()-3,1,0,0,0);break;case"6m":r=new Date(e.getFullYear(),e.getMonth()-6,1,0,0,0);break;case"1y":r=new Date(e.getFullYear()-1,e.getMonth(),1,0,0,0);break;case"all":r=new Date(2e3,0,1,0,0,0);break;default:r=new Date(e.getFullYear(),e.getMonth(),1,0,0,0)}return{from:this.toLocalISOString(r,"00:00:00"),to:this.toLocalISOString(t,"23:59:59")}}toLocalISOString(e,t){let r=e.getFullYear(),u=String(e.getMonth()+1).padStart(2,"0"),c=String(e.getDate()).padStart(2,"0");return`${r}-${u}-${c}T${t}`}loadReport(){this.isLoading=!0,this.errorMessage=null,this.selectedMonthForBar=null,this.updateUrlFromState();let{from:e,to:t}=this.getPeriodRange();this.analyticsService.getBonusTypeReport(this.selectedBonusTypeId,e,t).pipe(S(r=>(this.errorMessage=r?.error?.message||"\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u043E\u0442\u0447\u0451\u0442",P(null)))).subscribe(r=>{this.report=r??null,this.isLoading=!1,this.cdr.markForCheck()})}loadMonthlyChartData(){this.isMonthlyChartLoading=!0;let e=`${this.chartYear}-01-01T00:00:00`,t=`${this.chartYear}-12-31T23:59:59`;this.analyticsService.getBonusTypeReport(this.selectedBonusTypeId,e,t).pipe(S(()=>P(null))).subscribe(r=>{this.monthlyChartData=r?.monthlyData??null,this.isMonthlyChartLoading=!1,this.cdr.markForCheck()})}get donutSalesWithPercent(){if(!this.report)return 0;let e=this.report.transactionCount+(this.report.transactionCountWithoutBonus??0);return e===0?0:this.report.transactionCount/e*100}get donutSalesWithoutPercent(){if(!this.report)return 100-this.donutSalesWithPercent;let e=this.report.transactionCount+(this.report.transactionCountWithoutBonus??0);return e===0?100:(this.report.transactionCountWithoutBonus??0)/e*100}getDonutSalesDash(){let e=2*Math.PI*40;return`${this.donutSalesWithPercent/100*e} ${e}`}getDonutSalesOffset(){let e=2*Math.PI*40;return-(this.donutSalesWithPercent/100*e)}get donutBonusInCirculationPercent(){if(!this.report)return 0;let e=Number(this.report.inCirculation)+Number(this.report.spentAmount);return e===0?0:Number(this.report.inCirculation)/e*100}getDonutBonusDash(){let e=2*Math.PI*40;return`${this.donutBonusInCirculationPercent/100*e} ${e}`}getDonutBonusSpentDash(){let e=2*Math.PI*40;return`${(100-this.donutBonusInCirculationPercent)/100*e} ${e}`}getDonutBonusOffset(){let e=2*Math.PI*40;return-(this.donutBonusInCirculationPercent/100*e)}get maxAvgForBar(){return this.report?Math.max(Number(this.report.avgCheckWithBonus)||0,Number(this.report.avgCheckWithoutBonus)||0,1):100}get maxAvgForBarRounded(){return this.niceRoundMax(this.maxAvgForBar)||100}getAvgCheckAxisLabels(){let e=this.maxAvgForBarRounded||100,t=[];for(let r=4;r>=0;r--){let u=Math.round(e*r/4);t.push(this.formatYAxisValue(u)+" \u20B8")}return t}niceRoundMax(e){if(e<=0)return 100;let t=Math.pow(10,Math.floor(Math.log10(e))),r=e/t,u=r<=1?1:r<=2?2:r<=5?5:10;return Math.ceil(u*t/1e3)*1e3||100}get monthlyChartMax(){if(!this.monthlyChartData?.length)return 100;let e=0;for(let t of this.monthlyChartData)e=Math.max(e,t.avgCheckWithBonus??0,t.avgCheckWithoutBonus??0);return this.niceRoundMax(e)||100}get monthlyRevenueMax(){if(!this.monthlyChartData?.length)return 1;let e=0;for(let t of this.monthlyChartData)e=Math.max(e,t.revenue??0);return this.niceRoundMax(e)||1}getMonthlyLeftAxisLabels(){let e=this.monthlyChartMax||100,t=[];for(let r=4;r>=0;r--){let u=Math.round(e*r/4);t.push(this.formatYAxisValue(u)+" \u20B8")}return t}getMonthlyRightAxisLabels(){let e=this.monthlyRevenueMax||1,t=[];for(let r=4;r>=0;r--){let u=Math.round(e*r/4);t.push(this.formatYAxisValue(u)+" \u20B8")}return t}formatYAxisValue(e){if(e>=1e6){let t=e/1e6;return`${(t%1===0?`${t}`:t.toFixed(1)).replace(".",",")} \u043C\u043B\u043D`}if(e>=1e3){let t=e/1e3;return`${(t%1===0?`${t}`:t.toFixed(1)).replace(".",",")} \u0442\u044B\u0441`}return e.toLocaleString("ru-RU")}formatMoney(e){return e==null||isNaN(e)?"0":e.toLocaleString("ru-RU",{minimumFractionDigits:0,maximumFractionDigits:0})}formatMoneyShort(e){if(e==null||isNaN(e))return"0";if(e>=1e6){let t=e/1e6;return(t%1===0?t:t.toFixed(1))+" \u043C\u043B\u043D \u20B8"}if(e>=1e3){let t=e/1e3;return(t%1===0?t:t.toFixed(1))+" \u0442\u044B\u0441 \u20B8"}return e.toLocaleString("ru-RU")+" \u20B8"}formatPct(e){return e==null||isNaN(e)?"\u2014":e.toFixed(1)}formatPeriod(e,t){if(!e||!t)return"";let r=new Date(e),u=new Date(t);return`${r.toLocaleDateString("ru-RU")} \u2014 ${u.toLocaleDateString("ru-RU")}`}isMonthSelected(e){return this.selectedMonthForBar===e.yearMonth}static \u0275fac=function(t){return new(t||l)};static \u0275cmp=I({type:l,selectors:[["app-bonus-type-report-page"]],decls:28,vars:7,consts:[[1,"report-page"],[1,"report-header"],[1,"report-controls"],[1,"control-group"],[1,"control-label"],[1,"control-select",3,"ngModelChange","ngModel"],["value","all"],[3,"value",4,"ngFor","ngForOf"],["value","1m"],["value","3m"],["value","6m"],["value","1y"],["class","page-loading-container",4,"ngIf"],[4,"ngIf"],["class","report-empty",4,"ngIf"],["class","report-error",4,"ngIf"],[3,"value"],[1,"page-loading-container"],["type","logo","size","large",3,"visible","overlay"],[1,"report-content"],[1,"report-title-row"],[1,"report-title"],[1,"report-period"],[1,"report-card-groups","report-row-one"],[1,"report-card-group"],[1,"card-group-header"],[1,"card-group-icon","card-group-icon-transactions"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","1.5"],["d","M12 2v20M17 5H9.5a3.5 3.5 0 000 7h5a3.5 3.5 0 010 7H6"],[1,"card-group-title"],[1,"metric-list"],[1,"metric-row"],[1,"metric-label"],[1,"metric-value"],[1,"report-chart-card","donut-chart-card"],[1,"chart-title"],[1,"donut-container"],["viewBox","0 0 100 100","preserveAspectRatio","xMidYMid meet",1,"donut-chart"],["cx","50","cy","50","r","40","fill","none","stroke","#94a3b8","stroke-width","16"],["cx","50","cy","50","r","40","fill","none","stroke","#22c55e","stroke-width","16","stroke-dashoffset","0","transform","rotate(-90 50 50)"],["cx","50","cy","50","r","40","fill","none","stroke","#94a3b8","stroke-width","16","transform","rotate(-90 50 50)"],[1,"donut-legend","donut-legend-right"],[1,"legend-item"],[1,"legend-color","loyalty"],[1,"legend-label"],[1,"legend-value"],[1,"legend-count"],[1,"legend-color","non-loyalty"],[1,"report-chart-card","avg-check-chart-card"],[1,"avg-check-chart-inner"],[1,"avg-check-y-axis"],[4,"ngFor","ngForOf"],[1,"avg-check-chart-area"],["aria-hidden","true",1,"avg-check-grid"],["class","avg-check-grid-line",3,"top",4,"ngFor","ngForOf"],[1,"avg-check-bars-row"],[1,"avg-check-bar-track"],[1,"avg-check-bar-fill","with-bonus"],[1,"avg-check-bar-fill","without-bonus"],[1,"avg-check-legend-inline"],[1,"leg","green"],[1,"leg","grey"],[1,"report-chart-card","donut-chart-card","donut-in-circulation"],[1,"report-card-groups","report-row-two"],[1,"card-group-icon","card-group-icon-bonus"],["d","M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"],[1,"card-group-icon","card-group-icon-kpi"],["d","M3 3v18h18"],["d","M18 17V9"],["d","M13 17V5"],["d","M8 17v-3"],["class","block-extra",4,"ngIf"],["class","report-block monthly-block report-monthly-inline",4,"ngIf"],[1,"avg-check-grid-line"],[1,"block-extra"],[1,"report-block","monthly-block","report-monthly-inline"],[1,"block-header"],[1,"block-icon","block-icon-chart"],[1,"block-title"],[1,"month-chart-year-select"],[1,"control-select","year-select",3,"ngModelChange","ngModel"],["class","monthly-chart",4,"ngIf"],["class","monthly-chart-loading",4,"ngIf"],[1,"monthly-chart"],[1,"monthly-chart-inner"],[1,"monthly-y-axis-left"],[1,"monthly-chart-area"],["aria-hidden","true",1,"monthly-chart-grid"],["class","monthly-grid-line",3,"top",4,"ngFor","ngForOf"],[1,"monthly-bars"],["class","month-cell",4,"ngFor","ngForOf"],[1,"monthly-y-axis-right"],[1,"monthly-legend"],[1,"leg","blue"],[1,"monthly-grid-line"],[1,"month-cell"],[1,"month-bars-group"],[1,"month-bar-clickable","with-bonus",3,"click"],[1,"month-bar-tooltip"],[1,"tooltip-title"],[1,"tooltip-row"],[1,"month-bar-clickable","without-bonus",3,"click"],[1,"month-bar-clickable","revenue",3,"click"],[1,"month-label"],[1,"monthly-chart-loading"],["type","logo","size","small",3,"visible","overlay"],[1,"report-empty"],[1,"report-error"]],template:function(t,r){if(t&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),o(5,"\u0422\u0438\u043F \u0431\u043E\u043D\u0443\u0441\u0430"),i(),n(6,"select",5),b("ngModelChange",function(c){return r.onBonusTypeChange(c)}),n(7,"option",6),o(8,"\u041E\u0431\u0449\u0430\u044F \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043A\u0430"),i(),f(9,Z,2,2,"option",7),i()(),n(10,"div",3)(11,"label",4),o(12,"\u041F\u0435\u0440\u0438\u043E\u0434"),i(),n(13,"select",5),b("ngModelChange",function(c){return r.onPeriodChange(c)}),n(14,"option",8),o(15,"\u0417\u0430 \u043C\u0435\u0441\u044F\u0446"),i(),n(16,"option",9),o(17,"\u0417\u0430 3 \u043C\u0435\u0441\u044F\u0446\u0430"),i(),n(18,"option",10),o(19,"\u0417\u0430 6 \u043C\u0435\u0441\u044F\u0446\u0435\u0432"),i(),n(20,"option",11),o(21,"\u0417\u0430 \u0433\u043E\u0434"),i(),n(22,"option",6),o(23,"\u0417\u0430 \u0432\u0441\u0435 \u0432\u0440\u0435\u043C\u044F"),i()()()()(),f(24,ee,2,2,"div",12)(25,me,175,55,"ng-container",13)(26,ge,3,0,"div",14)(27,he,3,1,"div",15),i()),t&2){let u;a(6),p("ngModel",(u=r.selectedBonusTypeId)!==null&&u!==void 0?u:"all"),a(3),p("ngForOf",r.bonusTypes),a(4),p("ngModel",r.period),a(11),p("ngIf",r.isLoading),a(),p("ngIf",!r.isLoading&&r.report),a(),p("ngIf",!r.isLoading&&!r.report&&!r.errorMessage),a(),p("ngIf",r.errorMessage)}},dependencies:[N,L,z,W,q,j,G,U,V,H,X],styles:['.report-page[_ngcontent-%COMP%]{padding:0 2rem;width:100%;max-width:none}@media (max-width: 768px){.report-page[_ngcontent-%COMP%]{padding:0 1rem}}.report-header[_ngcontent-%COMP%]{margin-bottom:1.25rem}.report-controls[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1.25rem;align-items:flex-end}.control-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.35rem}.control-label[_ngcontent-%COMP%]{font-size:.7rem;font-weight:600;color:#64748b;text-transform:uppercase;letter-spacing:.04em}.control-select[_ngcontent-%COMP%]{min-width:200px;padding:.5rem .75rem;font-size:.875rem;border:1px solid #e2e8f0;border-radius:10px;background:#fff;color:#0f172a;cursor:pointer}.control-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#22c55e;box-shadow:0 0 0 2px #22c55e1a}.page-loading-container[_ngcontent-%COMP%]{min-height:200px;display:flex;align-items:center;justify-content:center}.report-title-row[_ngcontent-%COMP%]{display:flex;align-items:baseline;gap:1rem;margin-bottom:1.25rem;flex-wrap:wrap}.report-period[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:#0f172a;margin:0}.report-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:700;color:#0f172a;margin:0}.report-card-groups[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:1rem;margin-bottom:1.25rem}.report-row-one[_ngcontent-%COMP%]{flex-wrap:nowrap}.report-row-one[_ngcontent-%COMP%]   .report-card-group[_ngcontent-%COMP%], .report-row-one[_ngcontent-%COMP%]   .report-chart-card[_ngcontent-%COMP%]{flex:1;min-width:0;max-width:none}.report-row-one[_ngcontent-%COMP%]   .report-chart-card[_ngcontent-%COMP%]{width:auto}.report-row-two[_ngcontent-%COMP%]{flex-wrap:nowrap;align-items:stretch}.report-row-two[_ngcontent-%COMP%]   .report-card-group[_ngcontent-%COMP%]{flex:0 1 280px;min-width:0}.report-row-two[_ngcontent-%COMP%]   .report-block.monthly-block.report-monthly-inline[_ngcontent-%COMP%]{flex:1;min-width:0;margin-bottom:0}@media (max-width: 1024px){.report-card-groups[_ngcontent-%COMP%]{flex-wrap:wrap}.report-row-one[_ngcontent-%COMP%]   .report-card-group[_ngcontent-%COMP%], .report-row-one[_ngcontent-%COMP%]   .report-chart-card[_ngcontent-%COMP%]{flex:1 1 200px}.report-row-two[_ngcontent-%COMP%]   .report-block.monthly-block[_ngcontent-%COMP%]{flex:1 1 100%}}.report-card-group[_ngcontent-%COMP%]{flex:1;min-width:0;background:#fff;border-radius:14px;padding:1rem 1.25rem;border:1px solid #e5e7eb;box-shadow:0 1px 3px #0000000d}.report-card-group[_ngcontent-%COMP%]   .card-group-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-bottom:.75rem;padding-bottom:.5rem;border-bottom:1px solid #f1f5f9}.report-card-group[_ngcontent-%COMP%]   .card-group-icon[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:8px;display:flex;align-items:center;justify-content:center;flex-shrink:0}.report-card-group[_ngcontent-%COMP%]   .card-group-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:18px;height:18px}.card-group-icon-transactions[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dcfce7,#bbf7d0);color:#15803d}.card-group-icon-bonus[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fef3c7,#fde68a);color:#b45309}.card-group-icon-kpi[_ngcontent-%COMP%]{background:linear-gradient(135deg,#e0e7ff,#c7d2fe);color:#4338ca}.report-card-group[_ngcontent-%COMP%]   .card-group-title[_ngcontent-%COMP%]{font-size:.8125rem;font-weight:700;color:#0f172a;margin:0}.report-card-group[_ngcontent-%COMP%]   .metric-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.35rem}.report-card-group[_ngcontent-%COMP%]   .metric-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:baseline;gap:.5rem;font-size:.8125rem}.report-card-group[_ngcontent-%COMP%]   .metric-label[_ngcontent-%COMP%]{color:#64748b;flex-shrink:0}.report-card-group[_ngcontent-%COMP%]   .metric-value[_ngcontent-%COMP%]{font-weight:600;font-size:.9375rem;color:#0f172a}.report-card-group[_ngcontent-%COMP%]   .block-extra[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.75rem;margin-top:.5rem;padding-top:.5rem;border-top:1px solid #f1f5f9;font-size:.8125rem}.report-chart-card[_ngcontent-%COMP%]{background:#fff;border-radius:14px;padding:1rem 1.25rem;border:1px solid #e5e7eb;box-shadow:0 1px 3px #0000000d;display:flex;flex-direction:column;min-width:0}.report-chart-card[_ngcontent-%COMP%]   .chart-title[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600;color:#0f172a;margin:0 0 .75rem}.report-chart-card[_ngcontent-%COMP%]   .donut-container[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center;min-height:160px}.report-chart-card[_ngcontent-%COMP%]   .donut-chart[_ngcontent-%COMP%]{width:140px;height:140px;display:block}.donut-legend-right[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.4rem;padding-top:.5rem;font-size:.8125rem}.donut-legend-right[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;flex-wrap:wrap}.donut-legend-right[_ngcontent-%COMP%]   .legend-color[_ngcontent-%COMP%]{width:10px;height:10px;border-radius:2px;flex-shrink:0}.donut-legend-right[_ngcontent-%COMP%]   .legend-color.loyalty[_ngcontent-%COMP%]{background:#22c55e}.donut-legend-right[_ngcontent-%COMP%]   .legend-color.non-loyalty[_ngcontent-%COMP%]{background:#94a3b8}.donut-legend-right[_ngcontent-%COMP%]   .legend-label[_ngcontent-%COMP%]{color:#64748b;flex-shrink:0}.donut-legend-right[_ngcontent-%COMP%]   .legend-value[_ngcontent-%COMP%]{font-weight:700;font-size:.9375rem;color:#0f172a}.donut-legend-right[_ngcontent-%COMP%]   .legend-count[_ngcontent-%COMP%]{margin-left:auto;font-size:.8125rem;color:#64748b;font-weight:500}.avg-check-chart-card[_ngcontent-%COMP%]{min-height:220px}.avg-check-chart-inner[_ngcontent-%COMP%]{display:flex;flex:1;min-height:180px;align-items:stretch}.avg-check-y-axis[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;height:160px;padding-right:.5rem;font-size:.65rem;font-weight:600;color:#94a3b8;text-align:right;flex-shrink:0}.avg-check-chart-area[_ngcontent-%COMP%]{flex:1;min-width:0;position:relative;height:160px}.avg-check-grid[_ngcontent-%COMP%]{position:absolute;left:0;right:0;top:0;height:160px;pointer-events:none}.avg-check-grid-line[_ngcontent-%COMP%]{position:absolute;left:0;right:0;height:1px;background:#e2e8f0;opacity:.5}.avg-check-grid-line[_ngcontent-%COMP%]:nth-child(1){top:0}.avg-check-grid-line[_ngcontent-%COMP%]:nth-child(2){top:25%}.avg-check-grid-line[_ngcontent-%COMP%]:nth-child(3){top:50%}.avg-check-grid-line[_ngcontent-%COMP%]:nth-child(4){top:75%}.avg-check-grid-line[_ngcontent-%COMP%]:nth-child(5){top:100%}.avg-check-bars-row[_ngcontent-%COMP%]{position:relative;z-index:1;display:flex;align-items:flex-end;gap:8px;height:160px;padding:0 .5rem}.avg-check-bar-track[_ngcontent-%COMP%]{flex:1;max-width:48px;height:100%;display:flex;align-items:flex-end;border-radius:4px 4px 0 0;overflow:hidden}.avg-check-bar-fill[_ngcontent-%COMP%]{width:100%;border-radius:4px 4px 0 0;min-height:4px;transition:height .3s ease}.avg-check-bar-fill.with-bonus[_ngcontent-%COMP%]{background:#22c55e}.avg-check-bar-fill.without-bonus[_ngcontent-%COMP%]{background:#94a3b8}.avg-check-legend-inline[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-top:.5rem;padding-top:.5rem;border-top:1px solid #f1f5f9;font-size:.75rem;color:#64748b}.avg-check-legend-inline[_ngcontent-%COMP%]   .leg.green[_ngcontent-%COMP%]:before{content:"";display:inline-block;width:10px;height:10px;border-radius:2px;background:#22c55e;margin-right:.35rem;vertical-align:middle}.avg-check-legend-inline[_ngcontent-%COMP%]   .leg.grey[_ngcontent-%COMP%]:before{content:"";display:inline-block;width:10px;height:10px;border-radius:2px;background:#94a3b8;margin-right:.35rem;vertical-align:middle}.donut-in-circulation[_ngcontent-%COMP%]   .donut-container[_ngcontent-%COMP%]{min-height:140px}.donut-in-circulation[_ngcontent-%COMP%]   .donut-chart[_ngcontent-%COMP%]{width:120px;height:120px}.report-block[_ngcontent-%COMP%]{background:#fff;border:1px solid #e5e7eb;border-radius:14px;margin-bottom:1.25rem;overflow:visible;box-shadow:0 1px 3px #0000000a}.block-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:1rem 1.25rem;border-bottom:1px solid #f1f5f9}.block-icon[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:10px;display:flex;align-items:center;justify-content:center;flex-shrink:0}.block-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px}.block-icon-chart[_ngcontent-%COMP%]{background:linear-gradient(135deg,#e0e7ff,#c7d2fe);color:#4338ca}.block-title[_ngcontent-%COMP%]{font-size:.9375rem;font-weight:700;color:#0f172a;margin:0;flex:1}.month-chart-year-select[_ngcontent-%COMP%]{flex-shrink:0}.year-select[_ngcontent-%COMP%]{min-width:90px;padding:.35rem .5rem;font-size:.8125rem}.monthly-chart[_ngcontent-%COMP%]{padding:1rem 1.25rem;width:100%}.monthly-chart-inner[_ngcontent-%COMP%]{display:flex;width:100%;min-height:280px}.monthly-y-axis-left[_ngcontent-%COMP%]{flex-shrink:0;width:64px;display:flex;flex-direction:column;justify-content:space-between;padding-right:.5rem;font-size:.65rem;font-weight:600;color:#94a3b8;text-align:right}.monthly-chart-area[_ngcontent-%COMP%]{flex:1;min-width:0;position:relative;display:flex;flex-direction:column}.monthly-chart-grid[_ngcontent-%COMP%]{position:absolute;left:0;right:0;top:0;height:200px;pointer-events:none}.monthly-grid-line[_ngcontent-%COMP%]{position:absolute;left:0;right:0;height:1px;background:#e2e8f0;opacity:.5}.monthly-grid-line[_ngcontent-%COMP%]:nth-child(1){top:0}.monthly-grid-line[_ngcontent-%COMP%]:nth-child(2){top:25%}.monthly-grid-line[_ngcontent-%COMP%]:nth-child(3){top:50%}.monthly-grid-line[_ngcontent-%COMP%]:nth-child(4){top:75%}.monthly-grid-line[_ngcontent-%COMP%]:nth-child(5){top:100%}.monthly-bars[_ngcontent-%COMP%]{display:flex;align-items:flex-end;gap:2px;flex:1;min-height:200px;padding:.5rem 0 1rem;position:relative;z-index:1}.month-cell[_ngcontent-%COMP%]{flex:1;min-width:0;display:flex;flex-direction:column;align-items:center;gap:.35rem;padding:.2rem}.month-cell[_ngcontent-%COMP%]   .month-label[_ngcontent-%COMP%]{font-size:.6rem;color:#64748b;text-align:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:100%;order:2}.month-bars-group[_ngcontent-%COMP%]{display:flex;gap:2px;align-items:flex-end;height:200px;width:100%;max-width:48px;order:1}.month-bar-clickable[_ngcontent-%COMP%]{flex:1;min-width:10px;border-radius:3px 3px 0 0;min-height:4px;transition:height .2s ease,opacity .2s;cursor:pointer;position:relative}.month-bars-group.selected[_ngcontent-%COMP%]   .month-bar-clickable.with-bonus[_ngcontent-%COMP%], .month-bars-group.selected[_ngcontent-%COMP%]   .month-bar-clickable.without-bonus[_ngcontent-%COMP%], .month-bars-group.selected[_ngcontent-%COMP%]   .month-bar-clickable.revenue[_ngcontent-%COMP%]{box-shadow:0 0 0 2px #00000026}.month-bar-clickable[_ngcontent-%COMP%]:hover{opacity:.9}.month-bar-clickable.with-bonus[_ngcontent-%COMP%]{background:#22c55e}.month-bar-clickable.without-bonus[_ngcontent-%COMP%]{background:#94a3b8}.month-bar-clickable.revenue[_ngcontent-%COMP%]{background:#3b82f6}.month-bar-tooltip[_ngcontent-%COMP%]{position:absolute;bottom:100%;left:50%;transform:translate(-50%) translateY(-6px);background:#1f2937;color:#fff;padding:.5rem .65rem;border-radius:8px;font-size:.7rem;white-space:nowrap;z-index:9999;opacity:0;pointer-events:none;transition:opacity .15s,transform .15s;box-shadow:0 4px 12px #0003}.month-bar-clickable[_ngcontent-%COMP%]:hover   .month-bar-tooltip[_ngcontent-%COMP%]{opacity:1;transform:translate(-50%) translateY(-4px)}.month-bar-tooltip[_ngcontent-%COMP%]:after{content:"";position:absolute;top:100%;left:50%;margin-left:-6px;border:6px solid transparent;border-top-color:#1f2937}.tooltip-title[_ngcontent-%COMP%]{font-weight:700;margin-bottom:.25rem;padding-bottom:.2rem;border-bottom:1px solid rgba(255,255,255,.2);font-size:.75rem}.tooltip-row[_ngcontent-%COMP%]{margin-top:.15rem;font-size:.7rem}.monthly-y-axis-right[_ngcontent-%COMP%]{flex-shrink:0;width:64px;display:flex;flex-direction:column;justify-content:space-between;padding-left:.5rem;font-size:.65rem;font-weight:600;color:#94a3b8;text-align:left}.monthly-legend[_ngcontent-%COMP%]{display:flex;gap:1.25rem;font-size:.7rem;margin-top:.75rem;padding-top:.5rem;border-top:1px solid #f1f5f9}.monthly-legend[_ngcontent-%COMP%]   .leg[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.35rem}.monthly-legend[_ngcontent-%COMP%]   .leg.green[_ngcontent-%COMP%]:before{content:"";width:10px;height:10px;border-radius:2px;background:#22c55e}.monthly-legend[_ngcontent-%COMP%]   .leg.grey[_ngcontent-%COMP%]:before{content:"";width:10px;height:10px;border-radius:2px;background:#94a3b8}.monthly-legend[_ngcontent-%COMP%]   .leg.blue[_ngcontent-%COMP%]:before{content:"";width:10px;height:10px;border-radius:2px;background:#3b82f6}.monthly-chart-loading[_ngcontent-%COMP%]{padding:2rem;display:flex;align-items:center;justify-content:center;min-height:200px}.report-empty[_ngcontent-%COMP%], .report-error[_ngcontent-%COMP%]{padding:1.5rem;text-align:center;font-size:.875rem;color:#64748b;background:#f8fafc;border-radius:14px;border:1px solid #e2e8f0}.report-error[_ngcontent-%COMP%]{color:#dc2626;background:#fef2f2;border-color:#fecaca}']})}return l})();export{we as BonusTypeReportPageComponent};
