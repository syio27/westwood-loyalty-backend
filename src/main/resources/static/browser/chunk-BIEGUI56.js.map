{
  "version": 3,
  "sources": ["src/app/core/services/clients.service.ts"],
  "sourcesContent": ["import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { environment } from '../../../environments/environment';\n\nexport interface ClientSearchRequest {\n  name?: string;\n  phone?: string;\n  email?: string;\n  lastVisitFrom?: string | null;\n  lastVisitTo?: string | null;\n  tags?: string[];\n  clientType?: 'INDIVIDUAL' | 'BUSINESS' | null;\n  sortBy?: 'name' | 'createdAt' | 'lastVisit';\n  sortDirection?: 'ASC' | 'DESC';\n  page?: number;\n  size?: number;\n}\n\nexport interface ClientSearchResult {\n  id: string;\n  name: string;\n  surname: string;\n  phone: string;\n  email: string | null;\n  clientType: 'INDIVIDUAL' | 'BUSINESS';\n  tags: string[];\n  totalSpent: number;\n  transactionCount: number;\n  bonusBalance: number;\n  bonusUsed: number;\n  lastVisit: string;\n  createdAt: string;\n}\n\nexport interface ClientSearchResponse {\n  content: ClientSearchResult[];\n  page: number;\n  size: number;\n  totalElements: number;\n  totalPages: number;\n  first: boolean;\n  last: boolean;\n}\n\nexport interface ClientDetails {\n  id: string;\n  name: string;\n  surname: string;\n  phone: string;\n  email: string | null;\n  clientType: 'INDIVIDUAL' | 'BUSINESS';\n  tags: string[];\n  notes: string | null;\n  dateOfBirth: string | null;\n  referrerId: string | null;\n  createdAt: string;\n}\n\nexport interface UpdateClientRequest {\n  phone?: string;\n  name?: string;\n  surname?: string | null;\n  dateOfBirth?: string | null;\n  notes?: string | null;\n  tags?: string[];\n  clientType?: 'INDIVIDUAL' | 'BUSINESS';\n  referrerId?: string | null;\n}\n\nexport interface UpdateClientNotesRequest {\n  notes: string;\n}\n\nexport interface UpdateClientTagsRequest {\n  tags: string[];\n}\n\nexport interface ClientByPhoneResponse {\n  clientId: string;\n  name: string;\n  surname: string;\n  comment: string | null;\n  tags: string[];\n  currentBonusBalance: number;\n  clientType: 'INDIVIDUAL' | 'BUSINESS';\n}\n\nexport interface CreateClientRequest {\n  phone: string;\n  name: string;\n  surname?: string;\n  dateOfBirth?: string | null;\n  notes?: string | null;\n  tags?: string[];\n  clientType: 'INDIVIDUAL' | 'BUSINESS';\n  referrerId?: string | null;\n  email?: string | null;\n}\n\nexport interface CreateClientResponse {\n  id: string;\n  name: string;\n  surname: string;\n  phone: string;\n  email: string | null;\n  clientType: 'INDIVIDUAL' | 'BUSINESS';\n  tags: string[];\n  notes: string | null;\n  dateOfBirth: string | null;\n  referrerId: string | null;\n  createdAt: string;\n}\n\nexport interface FrequentClientDto {\n  clientId: string;\n  phone: string;\n  name: string;\n  surname: string | null;\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ClientsService {\n  private readonly apiUrl = `${environment.apiUrl}/clients`;\n\n  constructor(private http: HttpClient) {}\n\n  /**\n   * Search clients with filters and pagination\n   */\n  searchClients(request: ClientSearchRequest): Observable<ClientSearchResponse> {\n    return this.http.post<ClientSearchResponse>(`${this.apiUrl}/search`, request);\n  }\n\n  /**\n   * Get all available tags\n   */\n  getTags(): Observable<string[]> {\n    return this.http.get<string[]>(`${this.apiUrl}/tags`);\n  }\n\n  /**\n   * Get client by ID\n   */\n  getClientById(clientId: string): Observable<ClientDetails> {\n    return this.http.get<ClientDetails>(`${this.apiUrl}/${clientId}`);\n  }\n\n  /**\n   * Update client information\n   */\n  updateClient(clientId: string, request: UpdateClientRequest): Observable<ClientDetails> {\n    const url = `${this.apiUrl}/${clientId}`;\n    console.log('=== UPDATE CLIENT REQUEST ===');\n    console.log('URL:', url);\n    console.log('Method: PUT');\n    console.log('Client ID:', clientId);\n    console.log('Full Request Payload:', JSON.stringify(request, null, 2));\n    console.log('Request Payload (object):', request);\n    console.log('============================');\n    return this.http.put<ClientDetails>(url, request);\n  }\n\n  /**\n   * Update client notes\n   */\n  updateClientNotes(clientId: string, request: UpdateClientNotesRequest): Observable<void> {\n    const url = `${this.apiUrl}/${clientId}/notes`;\n    console.log('=== UPDATE CLIENT NOTES REQUEST ===');\n    console.log('URL:', url);\n    console.log('Method: PUT');\n    console.log('Client ID:', clientId);\n    console.log('Full Request Payload:', JSON.stringify(request, null, 2));\n    console.log('Request Payload (object):', request);\n    console.log('===================================');\n    return this.http.put<void>(url, request);\n  }\n\n  /**\n   * Update client tags\n   */\n  updateClientTags(clientId: string, request: UpdateClientTagsRequest): Observable<void> {\n    const url = `${this.apiUrl}/${clientId}/tags`;\n    console.log('=== UPDATE CLIENT TAGS REQUEST ===');\n    console.log('URL:', url);\n    console.log('Method: PUT');\n    console.log('Client ID:', clientId);\n    console.log('Full Request Payload:', JSON.stringify(request, null, 2));\n    console.log('Request Payload (object):', request);\n    console.log('==================================');\n    return this.http.put<void>(url, request);\n  }\n\n  /**\n   * Get client by phone number\n   */\n  getClientByPhone(phoneNumber: string): Observable<ClientByPhoneResponse> {\n    return this.http.get<ClientByPhoneResponse>(`${this.apiUrl}/phone/${encodeURIComponent(phoneNumber)}`);\n  }\n\n  /**\n   * Create a new client\n   */\n  createClient(request: CreateClientRequest): Observable<CreateClientResponse> {\n    console.log('=== CREATE CLIENT REQUEST ===');\n    console.log('URL:', `${this.apiUrl}`);\n    console.log('Method: POST');\n    console.log('Full Request Payload:', JSON.stringify(request, null, 2));\n    console.log('Request Payload (object):', request);\n    console.log('============================');\n    return this.http.post<CreateClientResponse>(this.apiUrl, request);\n  }\n\n  /**\n   * Delete a client by ID\n   */\n  deleteClient(clientId: string): Observable<void> {\n    console.log('=== DELETE CLIENT REQUEST ===');\n    console.log('URL:', `${this.apiUrl}/${clientId}`);\n    console.log('Method: DELETE');\n    console.log('Client ID:', clientId);\n    console.log('============================');\n    return this.http.delete<void>(`${this.apiUrl}/${clientId}`);\n  }\n\n  /**\n   * Get frequent clients (most transactions)\n   */\n  getFrequentClients(limit: number = 5): Observable<FrequentClientDto[]> {\n    return this.http.get<FrequentClientDto[]>(`${this.apiUrl}/frequent?limit=${limit}`);\n  }\n\n  /**\n   * Search client by phone number for bonus management\n   * Returns full client details in a unified format\n   */\n  searchClientByPhone(phoneNumber: string): Observable<{\n    id: string;\n    firstName: string;\n    lastName: string;\n    phone: string;\n    email: string | null;\n    type: 'individual' | 'business';\n    tags: string[];\n  } | null> {\n    return new Observable(observer => {\n      this.getClientByPhone(phoneNumber).subscribe({\n        next: (response) => {\n          // Convert ClientByPhoneResponse to the expected format\n          observer.next({\n            id: response.clientId,\n            firstName: response.name,\n            lastName: response.surname,\n            phone: phoneNumber,\n            email: null,\n            type: response.clientType === 'BUSINESS' ? 'business' : 'individual',\n            tags: response.tags || []\n          });\n          observer.complete();\n        },\n        error: (err) => {\n          if (err.status === 404) {\n            observer.next(null);\n            observer.complete();\n          } else {\n            observer.error(err);\n          }\n        }\n      });\n    });\n  }\n}\n"],
  "mappings": "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",
  "names": []
}
