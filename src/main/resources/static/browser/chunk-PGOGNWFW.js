import{a as He}from"./chunk-GMWQYHRK.js";import"./chunk-XCAUQ3II.js";import{a as ne}from"./chunk-33IX4RCT.js";import{a as Ve,b as De}from"./chunk-34ECRXXJ.js";import{a as be}from"./chunk-EWHYOTGN.js";import{a as Le,b as Ae}from"./chunk-3B4WLWQ7.js";import{a as te}from"./chunk-QHVGAJNP.js";import{a as ze}from"./chunk-KYK7QIWN.js";import"./chunk-3B24VZJ2.js";import{a as ve}from"./chunk-KIMA7ZS2.js";import{c as Ce,d as xe,e as we,f as Me,g as ye,h as Te,k as Pe,l as Se,m as Ee,n as Oe,o as ke,s as Ie,t as Fe,u as ee,v as Be}from"./chunk-NBNKGI3X.js";import{n as he}from"./chunk-CIWT7YLH.js";import{a as _e}from"./chunk-CVPHXFUL.js";import{$ as M,$a as me,Aa as a,Ba as g,Ca as L,Da as A,Ea as se,Fa as I,Ga as w,Ha as d,Ia as q,Ja as F,Ka as le,La as pe,Ma as de,Na as G,Oa as l,Pa as h,Qa as S,Ra as ce,S as W,Ta as Q,Ua as Y,Va as K,Y as _,Z as b,_ as v,a as $,b as oe,da as z,hb as Z,ia as ae,ib as B,ja as re,jb as X,ka as r,kb as J,lb as ue,ma as R,mb as ge,na as E,ob as O,ra as f,ua as V,ub as fe,va as p,wa as N,xa as k,ya as D,za as o}from"./chunk-QQOXS2LP.js";var Ye=["*",[["","cardHeader",""]],[["","cardFooter",""]]],Ke=["*","[cardHeader]","[cardFooter]"];function Ze(i,m){i&1&&se(0)}function Xe(i,m){if(i&1&&(o(0,"h3"),l(1),a()),i&2){let e=d(2);r(),h(e.headerText)}}function Je(i,m){if(i&1&&(o(0,"div",6),f(1,Ze,1,0,"ng-container",7)(2,Xe,2,1,"h3",8),a()),i&2){let e=d(),t=G(6);r(),p("ngTemplateOutlet",t),r(),p("ngIf",!e.header)}}function et(i,m){i&1&&se(0)}function tt(i,m){if(i&1&&(o(0,"div",9),f(1,et,1,0,"ng-container",7),a()),i&2){d();let e=G(8);r(),p("ngTemplateOutlet",e)}}function nt(i,m){i&1&&F(0,1)}function it(i,m){i&1&&F(0,2)}var je=(()=>{class i{headerText="";showHeader=!1;footer=!1;showFooter=!1;hoverable=!1;shadow=!0;bordered=!1;header=!1;static \u0275fac=function(t){return new(t||i)};static \u0275cmp=E({type:i,selectors:[["app-card"]],inputs:{headerText:"headerText",showHeader:"showHeader",footer:"footer",showFooter:"showFooter",hoverable:"hoverable",shadow:"shadow",bordered:"bordered"},ngContentSelectors:Ke,decls:9,vars:8,consts:[["headerTemplate",""],["footerTemplate",""],[1,"card"],["class","card-header",4,"ngIf"],[1,"card-body"],["class","card-footer",4,"ngIf"],[1,"card-header"],[4,"ngTemplateOutlet"],[4,"ngIf"],[1,"card-footer"]],template:function(t,n){t&1&&(q(Ye),o(0,"div",2),f(1,Je,3,2,"div",3),o(2,"div",4),F(3),a(),f(4,tt,2,1,"div",5),a(),f(5,nt,1,0,"ng-template",null,0,me)(7,it,1,0,"ng-template",null,1,me)),t&2&&(k("hoverable",n.hoverable)("shadow",n.shadow)("bordered",n.bordered),r(),p("ngIf",n.header||n.showHeader),r(3),p("ngIf",n.footer||n.showFooter))},dependencies:[O,B,ge],styles:[".card[_ngcontent-%COMP%]{background:#fff;border-radius:8px;overflow:hidden;transition:all .3s ease}.card.shadow[_ngcontent-%COMP%]{box-shadow:0 2px 4px #0000001a}.card.bordered[_ngcontent-%COMP%]{border:1px solid #e2e8f0}.card.hoverable[_ngcontent-%COMP%]{cursor:pointer}.card.hoverable[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #00000026}.card-header[_ngcontent-%COMP%]{padding:1rem 1.5rem;border-bottom:1px solid #e2e8f0;background-color:#f8f9fa}.card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;font-weight:600;color:#1a202c}.card-body[_ngcontent-%COMP%]{padding:1.5rem}.card-footer[_ngcontent-%COMP%]{padding:1rem 1.5rem;border-top:1px solid #e2e8f0;background-color:#f8f9fa}[_nghost-%COMP%]     [cardHeader]{display:block}[_nghost-%COMP%]     [cardFooter]{display:block}"]})}return i})();var Ne=["*","*","*","*","*","*","*","*","*","*"];function ot(i,m){if(i&1&&(o(0,"h1"),F(1),a()),i&2){let e=d();D(e.getClasses())}}function at(i,m){if(i&1&&(o(0,"h2"),F(1,1),a()),i&2){let e=d();D(e.getClasses())}}function rt(i,m){if(i&1&&(o(0,"h3"),F(1,2),a()),i&2){let e=d();D(e.getClasses())}}function st(i,m){if(i&1&&(o(0,"h4"),F(1,3),a()),i&2){let e=d();D(e.getClasses())}}function lt(i,m){if(i&1&&(o(0,"h5"),F(1,4),a()),i&2){let e=d();D(e.getClasses())}}function pt(i,m){if(i&1&&(o(0,"h6"),F(1,5),a()),i&2){let e=d();D(e.getClasses())}}function dt(i,m){if(i&1&&(o(0,"p"),F(1,6),a()),i&2){let e=d();D(e.getClasses())}}function ct(i,m){if(i&1&&(o(0,"p"),F(1,7),a()),i&2){let e=d();D(e.getClasses())}}function mt(i,m){if(i&1&&(o(0,"span"),F(1,8),a()),i&2){let e=d();D(e.getClasses())}}function ut(i,m){if(i&1&&(o(0,"span"),F(1,9),a()),i&2){let e=d();D(e.getClasses())}}var We=(()=>{class i{variant="body1";noWrap=!1;bold=!1;medium=!1;muted=!1;getClasses(){let e=[this.variant];return this.noWrap&&e.push("no-wrap"),this.bold&&e.push("bold"),this.medium&&e.push("medium"),this.muted&&e.push("muted"),e.join(" ")}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=E({type:i,selectors:[["app-typography"]],inputs:{variant:"variant",noWrap:"noWrap",bold:"bold",medium:"medium",muted:"muted"},ngContentSelectors:Ne,decls:11,vars:11,consts:[[3,"ngSwitch"],[3,"class",4,"ngSwitchCase"]],template:function(t,n){t&1&&(q(Ne),L(0,0),f(1,ot,2,2,"h1",1)(2,at,2,2,"h2",1)(3,rt,2,2,"h3",1)(4,st,2,2,"h4",1)(5,lt,2,2,"h5",1)(6,pt,2,2,"h6",1)(7,dt,2,2,"p",1)(8,ct,2,2,"p",1)(9,mt,2,2,"span",1)(10,ut,2,2,"span",1),A()),t&2&&(p("ngSwitch",n.variant),r(),p("ngSwitchCase","h1"),r(),p("ngSwitchCase","h2"),r(),p("ngSwitchCase","h3"),r(),p("ngSwitchCase","h4"),r(),p("ngSwitchCase","h5"),r(),p("ngSwitchCase","h6"),r(),p("ngSwitchCase","body1"),r(),p("ngSwitchCase","body2"),r(),p("ngSwitchCase","caption"),r(),p("ngSwitchCase","overline"))},dependencies:[O,X,J],styles:["h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], h6[_ngcontent-%COMP%], p[_ngcontent-%COMP%], span[_ngcontent-%COMP%]{margin:0;padding:0}[_nghost-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:700;line-height:1.2}[_nghost-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;line-height:1.3}[_nghost-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:600;line-height:1.4}[_nghost-%COMP%]   h4[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;line-height:1.4}[_nghost-%COMP%]   h5[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;line-height:1.5}[_nghost-%COMP%]   h6[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;line-height:1.5}[_nghost-%COMP%]   p.body1[_ngcontent-%COMP%]{font-size:1rem;font-weight:400;line-height:1.6}[_nghost-%COMP%]   p.body2[_ngcontent-%COMP%]{font-size:.875rem;font-weight:400;line-height:1.6}[_nghost-%COMP%]   span.caption[_ngcontent-%COMP%]{font-size:.75rem;font-weight:400;line-height:1.5}[_nghost-%COMP%]   span.overline[_ngcontent-%COMP%]{font-size:.75rem;font-weight:600;line-height:1.5;text-transform:uppercase;letter-spacing:.1em}.no-wrap[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.bold[_ngcontent-%COMP%]{font-weight:700}.medium[_ngcontent-%COMP%]{font-weight:500}.muted[_ngcontent-%COMP%]{color:#64748b}"]})}return i})();var Re=(()=>{class i{orientation="horizontal";spaced=!1;static \u0275fac=function(t){return new(t||i)};static \u0275cmp=E({type:i,selectors:[["app-divider"]],inputs:{orientation:"orientation",spaced:"spaced"},decls:1,vars:4,consts:[[1,"divider"]],template:function(t,n){t&1&&g(0,"div",0),t&2&&(D(n.orientation),k("spaced",n.spaced))},dependencies:[O],styles:[".divider[_ngcontent-%COMP%]{background-color:#e2e8f0}.divider.horizontal[_ngcontent-%COMP%]{width:100%;height:1px}.divider.vertical[_ngcontent-%COMP%]{height:100%;width:1px}.divider.spaced.horizontal[_ngcontent-%COMP%]{margin:1rem 0}.divider.spaced.vertical[_ngcontent-%COMP%]{margin:0 1rem}"]})}return i})();function gt(i,m){if(i&1&&(v(),o(0,"svg",24),g(1,"path",25),a()),i&2){let e=d();k("read",e.isRead)}}function ft(i,m){if(i&1&&(v(),o(0,"svg",26),g(1,"path",25),a()),i&2){let e=d();k("read",e.isRead)}}function ht(i,m){i&1&&(o(0,"div",27)(1,"div",28),v(),o(2,"svg",5),g(3,"path",29),a()(),M(),o(4,"div",30),l(5,"\u0421\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u0435"),a(),o(6,"div",31),v(),o(7,"svg",5),g(8,"path",32),a()(),M(),o(9,"div",33),v(),o(10,"svg",5),g(11,"path",34),a()()())}var Ge=(()=>{class i{contactName="";avatarLetter="";message="";time="";status="\u043E\u043D\u043B\u0430\u0439\u043D";dateLabel="\u0421\u0435\u0433\u043E\u0434\u043D\u044F";outgoing=!0;showCheckmarks=!0;delivered=!0;isRead=!0;showInputBar=!0;darkFrame=!1;noShadow=!1;getAvatarLetter(){return this.avatarLetter?this.avatarLetter:this.contactName?this.contactName[0].toUpperCase():"?"}getCurrentTime(){return new Date().toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=E({type:i,selectors:[["app-whatsapp-preview"]],inputs:{contactName:"contactName",avatarLetter:"avatarLetter",message:"message",time:"time",status:"status",dateLabel:"dateLabel",outgoing:"outgoing",showCheckmarks:"showCheckmarks",delivered:"delivered",isRead:"isRead",showInputBar:"showInputBar",darkFrame:"darkFrame",noShadow:"noShadow"},decls:34,vars:15,consts:[[1,"phone-frame"],[1,"phone-notch"],[1,"phone-screen"],[1,"wa-header"],[1,"wa-back"],["viewBox","0 0 24 24","fill","none"],["d","M15 19l-7-7 7-7","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],[1,"wa-contact"],[1,"wa-avatar"],[1,"wa-info"],[1,"wa-name"],[1,"wa-status"],[1,"wa-actions"],["d","M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z","stroke","currentColor","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],["d","M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z","stroke","currentColor","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],["d","M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],[1,"wa-chat"],[1,"wa-date"],[1,"wa-bubble"],[1,"wa-meta"],[1,"wa-time"],["viewBox","0 0 24 24","fill","none","class","wa-check",3,"read",4,"ngIf"],["viewBox","0 0 24 24","fill","none","class","wa-check wa-check-second",3,"read",4,"ngIf"],["class","wa-input-bar",4,"ngIf"],["viewBox","0 0 24 24","fill","none",1,"wa-check"],["d","M5 13l4 4L19 7","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["viewBox","0 0 24 24","fill","none",1,"wa-check","wa-check-second"],[1,"wa-input-bar"],[1,"wa-emoji"],["d","M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z","stroke","currentColor","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],[1,"wa-input-field"],[1,"wa-attach"],["d","M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13","stroke","currentColor","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],[1,"wa-mic"],["d","M19 10v2a7 7 0 01-14 0v-2M12 19v4m-4 0h8M12 1a3 3 0 00-3 3v6a3 3 0 006 0V4a3 3 0 00-3-3z","stroke","currentColor","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"]],template:function(t,n){t&1&&(o(0,"div",0),g(1,"div",1),o(2,"div",2)(3,"div",3)(4,"div",4),v(),o(5,"svg",5),g(6,"path",6),a()(),M(),o(7,"div",7)(8,"div",8),l(9),a(),o(10,"div",9)(11,"span",10),l(12),a(),o(13,"span",11),l(14),a()()(),o(15,"div",12),v(),o(16,"svg",5),g(17,"path",13),a(),o(18,"svg",5),g(19,"path",14),a(),o(20,"svg",5),g(21,"path",15),a()()(),M(),o(22,"div",16)(23,"div",17),l(24),a(),o(25,"div",18)(26,"p"),l(27),a(),o(28,"div",19)(29,"span",20),l(30),a(),f(31,gt,2,2,"svg",21)(32,ft,2,2,"svg",22),a()()(),f(33,ht,12,0,"div",23),a()()),t&2&&(k("dark-frame",n.darkFrame)("no-shadow",n.noShadow),r(9),h(n.getAvatarLetter()),r(3),h(n.contactName||"\u041F\u043E\u043B\u0443\u0447\u0430\u0442\u0435\u043B\u044C"),r(2),h(n.status),r(10),h(n.dateLabel),r(),k("incoming",!n.outgoing),r(2),h(n.message||"\u0422\u0435\u043A\u0441\u0442 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u044F..."),r(3),h(n.time||n.getCurrentTime()),r(),p("ngIf",n.outgoing&&n.showCheckmarks),r(),p("ngIf",n.outgoing&&n.showCheckmarks&&n.delivered),r(),p("ngIf",n.showInputBar))},dependencies:[O,B],styles:[`.phone-frame[_ngcontent-%COMP%]{background:#1f2937;border-radius:32px;padding:8px;box-shadow:0 25px 50px -12px #00000040;display:flex;flex-direction:column;min-height:400px}.phone-frame.dark-frame[_ngcontent-%COMP%]{background:#0f172a}.phone-frame.no-shadow[_ngcontent-%COMP%]{box-shadow:none}.phone-notch[_ngcontent-%COMP%]{width:120px;height:24px;background:inherit;margin:0 auto 8px;border-radius:0 0 16px 16px}.phone-screen[_ngcontent-%COMP%]{flex:1;background:#e5ddd5;border-radius:24px;overflow:hidden;display:flex;flex-direction:column}.wa-header[_ngcontent-%COMP%]{background:#075e54;padding:.625rem .75rem;display:flex;align-items:center;gap:.5rem}.wa-back[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px;color:#fff}.wa-contact[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.625rem;flex:1}.wa-avatar[_ngcontent-%COMP%]{width:36px;height:36px;background:linear-gradient(135deg,#25d366,#128c7e);border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:600;font-size:.875rem}.wa-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.wa-name[_ngcontent-%COMP%]{color:#fff;font-weight:500;font-size:.9375rem;line-height:1.2}.wa-status[_ngcontent-%COMP%]{color:#ffffffb3;font-size:.75rem}.wa-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.wa-actions[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px;color:#fff}.wa-chat[_ngcontent-%COMP%]{flex:1;padding:.75rem;display:flex;flex-direction:column;overflow-y:auto;background-image:url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23c5c5c5' fill-opacity='0.1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")}.wa-date[_ngcontent-%COMP%]{text-align:center;font-size:.6875rem;color:#667781;background:#ffffffe6;padding:.25rem .75rem;border-radius:8px;margin:0 auto .75rem;box-shadow:0 1px .5px #0000001a}.wa-bubble[_ngcontent-%COMP%]{background:#dcf8c6;padding:.5rem .625rem;border-radius:8px 8px 0;max-width:85%;margin-left:auto;box-shadow:0 1px .5px #0000001a;position:relative}.wa-bubble.incoming[_ngcontent-%COMP%]{background:#fff;margin-left:0;margin-right:auto;border-radius:8px 8px 8px 0}.wa-bubble[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.875rem;line-height:1.4;color:#111b21;white-space:pre-wrap;word-break:break-word}.wa-meta[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;gap:.125rem;margin-top:.125rem}.wa-time[_ngcontent-%COMP%]{font-size:.6875rem;color:#667781}.wa-check[_ngcontent-%COMP%]{width:16px;height:16px;color:#667781;margin-left:-4px}.wa-check.read[_ngcontent-%COMP%]{color:#53bdeb}.wa-check-second[_ngcontent-%COMP%]{margin-left:-12px}.wa-input-bar[_ngcontent-%COMP%]{background:#f0f2f5;padding:.5rem .625rem;display:flex;align-items:center;gap:.5rem}.wa-emoji[_ngcontent-%COMP%], .wa-attach[_ngcontent-%COMP%]{color:#54656f;display:flex;align-items:center;justify-content:center}.wa-emoji[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .wa-attach[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:24px;height:24px}.wa-input-field[_ngcontent-%COMP%]{flex:1;background:#fff;padding:.5rem .875rem;border-radius:8px;font-size:.875rem;color:#667781}.wa-mic[_ngcontent-%COMP%]{width:40px;height:40px;background:#00a884;border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0}.wa-mic[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px;color:#fff}`]})}return i})();var Ue=(()=>{class i{recipientEmail="";message="";activationLink="https://westwood.app/activate?token=...";buttonText="Activate Account";expirationDays=7;senderName="Westwood Team";senderEmail="noreply@westwood.app";static \u0275fac=function(t){return new(t||i)};static \u0275cmp=E({type:i,selectors:[["app-email-preview"]],inputs:{recipientEmail:"recipientEmail",message:"message",activationLink:"activationLink",buttonText:"buttonText",expirationDays:"expirationDays",senderName:"senderName",senderEmail:"senderEmail"},decls:52,vars:8,consts:[[1,"email-frame"],[1,"browser-header"],[1,"browser-controls"],[1,"control","close"],[1,"control","minimize"],[1,"control","maximize"],[1,"browser-tabs"],[1,"tab","active"],["viewBox","0 0 24 24","fill","none"],["d","M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z","stroke","currentColor","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],[1,"email-client"],[1,"email-content"],[1,"sender-section"],[1,"sender-avatar"],["cx","12","cy","8","r","4","fill","currentColor"],["d","M4 20c0-4 4-6 8-6s8 2 8 6","fill","currentColor"],[1,"sender-details"],[1,"sender-row"],[1,"sender-name"],[1,"sender-email"],[1,"recipient-row"],[1,"to-label"],[1,"to-value"],["viewBox","0 0 24 24","fill","none",1,"dropdown-icon"],["d","M6 9l6 6 6-6","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],[1,"email-body-wrapper"],[1,"email-template"],[1,"email-banner"],[1,"banner-title"],[1,"email-body-content"],[1,"intro-text"],[1,"cta-container"],[1,"cta-button",3,"href"],[1,"alt-text"],[1,"link-box"],[1,"activation-link",3,"href"],[1,"notice"]],template:function(t,n){t&1&&(o(0,"div",0)(1,"div",1)(2,"div",2),g(3,"span",3)(4,"span",4)(5,"span",5),a(),o(6,"div",6)(7,"div",7),v(),o(8,"svg",8),g(9,"path",9),a(),M(),o(10,"span"),l(11,"\u041F\u0440\u0438\u0433\u043B\u0430\u0448\u0435\u043D\u0438\u0435 \u0432 Westwood - WestWood Team"),a()()()(),o(12,"div",10)(13,"div",11)(14,"div",12)(15,"div",13),v(),o(16,"svg",8),g(17,"circle",14)(18,"path",15),a()(),M(),o(19,"div",16)(20,"div",17)(21,"span",18),l(22),a(),o(23,"span",19),l(24),a()(),o(25,"div",20)(26,"span",21),l(27,"\u043A\u043E\u043C\u0443:"),a(),o(28,"span",22),l(29,"\u043C\u043D\u0435"),a(),v(),o(30,"svg",23),g(31,"path",24),a()()()(),M(),o(32,"div",25)(33,"div",26)(34,"div",27)(35,"h1",28),l(36,"Welcome to Westwood!"),a()(),o(37,"div",29)(38,"div",30),l(39),a(),o(40,"div",31)(41,"a",32),l(42),a()(),o(43,"p",33),l(44,"Or copy and paste this link into your browser:"),a(),o(45,"div",34)(46,"a",35),l(47),a()(),o(48,"p",36)(49,"strong"),l(50,"Important:"),a(),l(51),a()()()()()()()),t&2&&(r(22),h(n.senderName),r(2),S("<",n.senderEmail,">"),r(15),h(n.message||"You have been invited to join Westwood as a Manager. To get started, please activate your account by clicking the button below:"),r(2),p("href",n.activationLink,re),r(),S(" ",n.buttonText||"Activate Account"," "),r(4),p("href",n.activationLink,re),r(),S(" ",n.activationLink||"https://westwood.app/activate?token=..."," "),r(4),S(" This activation link will expire in ",n.expirationDays||7," days. If you didn't request this invitation, please ignore this email. "))},dependencies:[O],styles:[".email-frame[_ngcontent-%COMP%]{background:#1f2937;border-radius:12px;overflow:hidden;box-shadow:0 25px 50px -12px #00000040;display:flex;flex-direction:column;min-height:500px}.browser-header[_ngcontent-%COMP%]{background:#374151;padding:.5rem .75rem;display:flex;align-items:center;gap:1rem}.browser-controls[_ngcontent-%COMP%]{display:flex;gap:.5rem}.control[_ngcontent-%COMP%]{width:12px;height:12px;border-radius:50%}.control.close[_ngcontent-%COMP%]{background:#ef4444}.control.minimize[_ngcontent-%COMP%]{background:#fbbf24}.control.maximize[_ngcontent-%COMP%]{background:#22c55e}.browser-tabs[_ngcontent-%COMP%]{flex:1}.tab[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;background:#4b5563;padding:.375rem .75rem;border-radius:6px 6px 0 0;font-size:.75rem;color:#e5e7eb;max-width:280px}.tab[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:14px;height:14px;flex-shrink:0}.tab[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.email-client[_ngcontent-%COMP%]{flex:1;display:flex;background:#fff}.email-content[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;overflow:hidden;min-width:0}.sender-section[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:.875rem;padding:1rem;border-bottom:1px solid #e5e7eb;background:#fff}.sender-avatar[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:linear-gradient(135deg,#4caf50,#2e7d32);display:flex;align-items:center;justify-content:center;flex-shrink:0}.sender-avatar[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:24px;height:24px;color:#fff}.sender-details[_ngcontent-%COMP%]{flex:1;min-width:0}.sender-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.375rem;flex-wrap:wrap;margin-bottom:.25rem}.sender-name[_ngcontent-%COMP%]{font-size:.9375rem;font-weight:600;color:#1f2937}.sender-email[_ngcontent-%COMP%]{font-size:.8125rem;color:#6b7280}.recipient-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem;font-size:.8125rem;color:#6b7280}.to-label[_ngcontent-%COMP%]{color:#9ca3af}.to-value[_ngcontent-%COMP%]{color:#6b7280}.dropdown-icon[_ngcontent-%COMP%]{width:14px;height:14px;color:#9ca3af}.email-body-wrapper[_ngcontent-%COMP%]{flex:1;overflow-y:auto;background:#f5f5f5;padding:.5rem}.email-template[_ngcontent-%COMP%]{background:#f5f5f5;border-radius:8px;overflow:hidden}.email-banner[_ngcontent-%COMP%]{background:#4caf50;padding:1.75rem 1.5rem;text-align:center}.banner-title[_ngcontent-%COMP%]{color:#fff;font-size:1.375rem;font-weight:700;margin:0;letter-spacing:-.02em}.email-body-content[_ngcontent-%COMP%]{background:#fff;padding:1.5rem 1.25rem}.intro-text[_ngcontent-%COMP%]{font-size:.875rem;color:#333;line-height:1.6;margin:0 0 1.5rem;white-space:pre-wrap;word-break:break-word}.cta-container[_ngcontent-%COMP%]{text-align:center;margin:1.5rem 0}.cta-button[_ngcontent-%COMP%]{display:inline-block;background:#4caf50;color:#fff;font-size:.875rem;font-weight:600;padding:.75rem 1.5rem;border-radius:6px;text-decoration:none;transition:all .2s ease;box-shadow:0 2px 6px #4caf504d}.cta-button[_ngcontent-%COMP%]:hover{background:#43a047}.alt-text[_ngcontent-%COMP%]{font-size:.875rem;color:#333;margin:1.5rem 0 .75rem}.link-box[_ngcontent-%COMP%]{background:#e8f5e9;border-radius:6px;padding:.75rem;margin-bottom:1.25rem;word-break:break-all}.activation-link[_ngcontent-%COMP%]{color:#1565c0;font-size:.8125rem;text-decoration:underline;line-height:1.5}.notice[_ngcontent-%COMP%]{font-size:.875rem;color:#333;line-height:1.6;margin:0}.notice[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#111}"]})}return i})();var _t=["contentEditable"],bt=["messageContentEditable"];function Ct(i,m){if(i&1){let e=I();o(0,"button",53),w("click",function(n){_(e);let s=d().$implicit,c=d();return b(c.openPreview(s,n))}),v(),o(1,"svg",48),g(2,"path",54)(3,"path",55),a()()}}function xt(i,m){if(i&1){let e=I();o(0,"div",41),w("click",function(){let n=_(e).$implicit,s=d();return b(s.selectTemplate(n))}),o(1,"div",42)(2,"span",43),l(3),a()(),o(4,"p",44),l(5),a(),o(6,"div",45),f(7,Ct,4,0,"button",46),o(8,"button",47),w("click",function(n){let s=_(e).$implicit,c=d();return b(c.editTemplate(s,n))}),v(),o(9,"svg",48),g(10,"path",49)(11,"path",50),a()(),M(),o(12,"button",51),w("click",function(n){let s=_(e).$implicit,c=d();return b(c.deleteTemplate(s.id,n))}),v(),o(13,"svg",48),g(14,"path",52),a()()()()}if(i&2){let e=m.$implicit,t=d();r(3),h(e.name),r(2),h(t.getTemplatePreview(e.content)),r(2),p("ngIf",t.invitationType==="whatsapp")}}function wt(i,m){i&1&&(o(0,"div",56),v(),o(1,"svg",57),g(2,"path",58)(3,"path",59),a(),M(),o(4,"p",60),l(5,"\u041D\u0435\u0442 \u0448\u0430\u0431\u043B\u043E\u043D\u043E\u0432 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u0439"),a(),o(6,"p",61),l(7,"\u0421\u043E\u0437\u0434\u0430\u0439\u0442\u0435 \u043F\u0435\u0440\u0432\u044B\u0439 \u0448\u0430\u0431\u043B\u043E\u043D \u0434\u043B\u044F \u0431\u044B\u0441\u0442\u0440\u043E\u0439 \u043E\u0442\u043F\u0440\u0430\u0432\u043A\u0438"),a()())}function Mt(i,m){if(i&1){let e=I();o(0,"div",65),w("click",function(){_(e);let n=d(2);return b(n.toggleFormCollapse())}),o(1,"div",66),g(2,"div",67),o(3,"div",68)(4,"span",69),l(5),a(),o(6,"span",70),l(7),a()(),o(8,"button",71),v(),o(9,"svg",48),g(10,"path",23),a()()()()}if(i&2){let e=d(2);r(2),N("background",e.getIconGradient()),p("innerHTML",e.getSafeIconSvg(),ae),r(3),h(e.title),r(2),h(e.getCollapsedPreview()),r(2),k("rotated",!e.isFormCollapsed)}}function yt(i,m){if(i&1){let e=I();o(0,"app-alert",103),w("dismissed",function(){_(e);let n=d(3);return b(n.successMessage="")}),l(1),a()}if(i&2){let e=d(3);p("title","\u0423\u0441\u043F\u0435\u0448\u043D\u043E")("dismissible",!0),r(),S(" ",e.successMessage," ")}}function Tt(i,m){if(i&1){let e=I();o(0,"app-alert",104),w("dismissed",function(){_(e);let n=d(3);return b(n.errorMessage="")}),l(1),a()}if(i&2){let e=d(3);p("title","\u041E\u0448\u0438\u0431\u043A\u0430")("dismissible",!0),r(),S(" ",e.errorMessage," ")}}function Pt(i,m){i&1&&g(0,"app-input",105)}function St(i,m){if(i&1){let e=I();o(0,"button",111),w("click",function(){let n=_(e).$implicit,s=d(4);return b(s.selectMessageVariable(n))}),o(1,"span",112),l(2),a(),o(3,"span",113),l(4),a()()}if(i&2){let e=m.$implicit,t=d(4);k("highlighted",t.highlightedMessageVariableIndex===t.filteredMessageVariables.indexOf(e)),r(2),h(t.getVariableDisplayName(e.name)),r(2),h(e.description)}}function Et(i,m){if(i&1){let e=I();o(0,"div",106)(1,"div",107)(2,"span"),l(3,"\u041F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u044B\u0435"),a(),o(4,"button",108),w("click",function(){_(e);let n=d(3);return b(n.closeMessageVariablesDropdown())}),l(5,"\xD7"),a()(),o(6,"div",109),f(7,St,5,4,"button",110),a()()}if(i&2){let e=d(3);N("top",e.messageDropdownPosition.top,"px")("left",e.messageDropdownPosition.left,"px"),r(7),p("ngForOf",e.filteredMessageVariables)}}function Ot(i,m){i&1&&(v(),o(0,"svg",114),g(1,"path",115)(2,"path",116),a())}function kt(i,m){i&1&&(v(),o(0,"svg",117),g(1,"path",118),a())}function It(i,m){if(i&1&&g(0,"app-whatsapp-preview",119),i&2){let e=d(3);p("contactName",e.getPreviewContactName())("avatarLetter",e.getPreviewAvatarLetter())("message",e.getPreviewMessage())("showInputBar",!0)("noShadow",!0)}}function Ft(i,m){if(i&1&&g(0,"app-email-preview",120),i&2){let e=d(3);p("recipientEmail",e.getPreviewEmail())("message",e.getPreviewMessage())("activationLink","https://westwood.app/activate?token=xxx")("buttonText","Activate Account")("expirationDays",7)("senderEmail","noreply@westwood.app")}}function Vt(i,m){if(i&1){let e=I();o(0,"div",72)(1,"div",73),w("click",function(){_(e);let n=d(2);return b(n.toggleFormCollapse())}),o(2,"div",74),g(3,"div",75),o(4,"div",76)(5,"h2",77),l(6),a(),o(7,"p",78),l(8),a()()(),o(9,"button",79),v(),o(10,"svg",48),g(11,"path",23),a()()(),M(),o(12,"div",80)(13,"app-card",81),f(14,yt,2,3,"app-alert",82)(15,Tt,2,3,"app-alert",83),o(16,"form",84),w("ngSubmit",function(){_(e);let n=d(2);return b(n.onFormSubmit())}),f(17,Pt,1,0,"app-input",85),o(18,"div",86)(19,"div",87)(20,"app-typography",88),l(21),a(),o(22,"app-typography",89),l(23),a()(),o(24,"div",25)(25,"div",90,1),w("input",function(n){_(e);let s=d(2);return b(s.onMessageInput(n))})("keydown",function(n){_(e);let s=d(2);return b(s.onMessageKeydown(n))})("click",function(){_(e);let n=d(2);return b(n.onMessageClick())})("blur",function(n){_(e);let s=d(2);return b(s.onMessageBlur(n))}),a(),f(27,Et,8,5,"div",27),a()(),g(28,"app-divider",91),o(29,"app-button",92)(30,"span",93),L(31,30),f(32,Ot,3,0,"svg",94)(33,kt,2,0,"svg",95),A(),l(34),a()()()(),o(35,"div",96)(36,"div",97),v(),o(37,"svg",98),g(38,"path",54)(39,"path",55),a(),M(),o(40,"h3",99),l(41,"\u041F\u0440\u0435\u0434\u043F\u0440\u043E\u0441\u043C\u043E\u0442\u0440"),a()(),o(42,"p",100),l(43),a(),L(44,30),f(45,It,1,5,"app-whatsapp-preview",101)(46,Ft,1,6,"app-email-preview",102),A(),a()()()}if(i&2){let e=d(2);r(3),N("background",e.getIconGradient()),p("innerHTML",e.getSafeIconSvg(),ae),r(3),h(e.title),r(2),h(e.subtitle),r(5),p("shadow",!0),r(),p("ngIf",e.successMessage),r(),p("ngIf",e.errorMessage),r(),p("formGroup",e.form),r(),p("ngIf",e.invitationType==="email"),r(3),p("medium",!0),r(),S(" ",e.invitationType==="email"?"\u0422\u0435\u043A\u0441\u0442 \u043F\u0438\u0441\u044C\u043C\u0430":"\u0422\u0435\u043A\u0441\u0442 \u043F\u0440\u0438\u0433\u043B\u0430\u0448\u0435\u043D\u0438\u044F"," "),r(),p("muted",!0),r(),ce(" ",e.getMessageLength(),"/",e.invitationType==="email"?"1000":"500"," "),r(),V("data-type",e.invitationType),r(),V("data-type",e.invitationType)("placeholder",(e.invitationType==="email","\u041D\u0430\u043F\u0438\u0448\u0438\u0442\u0435 \u043F\u0435\u0440\u0441\u043E\u043D\u0430\u043B\u044C\u043D\u043E\u0435 \u043F\u0440\u0438\u0433\u043B\u0430\u0448\u0435\u043D\u0438\u0435...")),r(2),p("ngIf",e.showMessageVariablesDropdown),r(),p("spaced",!0),r(),p("buttonType",e.invitationType==="email"?"primary":"success")("disabled",e.form.invalid||e.isSending)("loading",e.isSending),r(2),p("ngSwitch",e.invitationType),r(),p("ngSwitchCase","whatsapp"),r(2),S(" ",e.isSending?e.invitationType==="email"?"\u041E\u0442\u043F\u0440\u0430\u0432\u043A\u0430...":"\u041E\u0442\u043A\u0440\u044B\u0432\u0430\u0435\u043C WhatsApp...":e.invitationType==="email"?"\u041E\u0442\u043F\u0440\u0430\u0432\u0438\u0442\u044C Email":"\u041E\u0442\u043F\u0440\u0430\u0432\u0438\u0442\u044C \u0432 WhatsApp"," "),r(3),N("color",e.iconColor),r(6),h(e.previewDescription),r(),p("ngSwitch",e.invitationType),r(),p("ngSwitchCase","whatsapp")}}function Dt(i,m){if(i&1&&(o(0,"div",62),f(1,Mt,11,7,"div",63)(2,Vt,47,31,"div",64),a()),i&2){let e=d();r(),p("ngIf",e.isFormCollapsed),r(),p("ngIf",!e.isFormCollapsed)}}function Bt(i,m){i&1&&(o(0,"option",121),l(1,"\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0442\u0438\u043F\u043E\u0432..."),a())}function zt(i,m){if(i&1&&(o(0,"option",122),l(1),a()),i&2){let e=m.$implicit;p("value",e.type),r(),S(" ",e.displayName," ")}}function Lt(i,m){if(i&1){let e=I();o(0,"div",15)(1,"label",16),l(2,"\u0422\u0435\u043C\u0430 \u043F\u0438\u0441\u044C\u043C\u0430"),a(),o(3,"input",123),K("ngModelChange",function(n){_(e);let s=d();return Y(s.newTemplate.subject,n)||(s.newTemplate.subject=n),b(n)}),a()()}if(i&2){let e=d();r(),V("data-type",e.invitationType),r(2),Q("ngModel",e.newTemplate.subject),V("data-type",e.invitationType)}}function At(i,m){if(i&1){let e=I();o(0,"button",111),w("click",function(){let n=_(e).$implicit,s=d(2);return b(s.selectVariable(n))}),o(1,"span",112),l(2),a(),o(3,"span",113),l(4),a()()}if(i&2){let e=m.$implicit,t=d(2);k("highlighted",t.highlightedVariableIndex===t.filteredVariables.indexOf(e)),r(2),h(t.getVariableDisplayName(e.name)),r(2),h(e.description)}}function Ht(i,m){if(i&1){let e=I();o(0,"div",106)(1,"div",107)(2,"span"),l(3,"\u041F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u044B\u0435"),a(),o(4,"button",108),w("click",function(){_(e);let n=d();return b(n.closeVariablesDropdown())}),l(5,"\xD7"),a()(),o(6,"div",109),f(7,At,5,4,"button",110),a()()}if(i&2){let e=d();N("top",e.dropdownPosition.top,"px")("left",e.dropdownPosition.left,"px"),r(7),p("ngForOf",e.filteredVariables)}}function jt(i,m){if(i&1&&g(0,"app-whatsapp-preview",124),i&2){let e=d();p("contactName","\u041F\u043E\u043B\u0443\u0447\u0430\u0442\u0435\u043B\u044C")("avatarLetter","\u041F")("message",e.newTemplate.content||"\u0422\u0435\u043A\u0441\u0442 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u044F...")("showInputBar",!0)("noShadow",!0)}}function Nt(i,m){if(i&1&&g(0,"app-email-preview",125),i&2){let e=d();p("recipientEmail","email@example.com")("message",e.newTemplate.content||"\u0422\u0435\u043A\u0441\u0442 \u043F\u0438\u0441\u044C\u043C\u0430...")("activationLink","https://westwood.app/activate?token=xxx")("buttonText","Activate Account")("expirationDays",7)("senderEmail","noreply@westwood.app")}}function Wt(i,m){if(i&1&&g(0,"app-whatsapp-preview",124),i&2){let e=d();p("contactName","\u041F\u043E\u043B\u0443\u0447\u0430\u0442\u0435\u043B\u044C")("avatarLetter","\u041F")("message",e.previewTemplate.content)("showInputBar",!0)("noShadow",!0)}}var $e=(()=>{class i{sanitizer;contentEditableRef;messageContentEditableRef;invitationType="whatsapp";form;title="\u041F\u0440\u0438\u0433\u043B\u0430\u0441\u0438 \u0434\u0440\u0443\u0433\u0430";subtitle="";iconSvg="";iconColor="#25D366";previewDescription="";messageTemplates=[];isSending=!1;successMessage="";errorMessage="";hideForm=!1;templateTypes=[];templateVariables=[];formSubmit=new z;templateSelected=new z;templateCreated=new z;templateUpdated=new z;templateDeleted=new z;isFormCollapsed=!1;showCreateTemplateModal=!1;showPreviewModal=!1;previewTemplate=null;editingTemplateId=null;newTemplate={id:"",name:"",type:"bonus_accrued",content:"",createdAt:new Date};showVariablesDropdown=!1;highlightedVariableIndex=0;dropdownPosition={top:0,left:0};currentBracePosition=-1;showMessageVariablesDropdown=!1;highlightedMessageVariableIndex=0;messageDropdownPosition={top:0,left:0};currentMessageBracePosition=-1;get availableVariables(){return this.templateVariables.length>0?this.templateVariables:[]}filteredVariables=[];filteredMessageVariables=[];constructor(e){this.sanitizer=e}ngAfterViewInit(){this.contentEditableRef&&this.updateContentEditable()}getSafeIconSvg(){return typeof this.iconSvg=="string"?this.sanitizer.bypassSecurityTrustHtml(this.iconSvg):this.iconSvg||this.sanitizer.bypassSecurityTrustHtml("")}toggleFormCollapse(){this.isFormCollapsed=!this.isFormCollapsed}getCollapsedPreview(){let e=this.form.get("message")?.value||"";return e?e.split(/\s+/).slice(0,8).join(" ")+(e.split(/\s+/).length>8?"...":""):"\u0422\u0435\u043A\u0441\u0442 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u044F \u043D\u0435 \u0432\u0432\u0435\u0434\u0451\u043D"}onFormSubmit(){this.formSubmit.emit()}getVariableDisplayName(e){return e.replace(/[{}]/g,"")}getTemplateTypeLabel(e){return!e||typeof e!="string"?e||"":e.split("_").map(t=>t.charAt(0)+t.slice(1).toLowerCase()).join(" ")}getTemplatePreview(e){return e.split(/\s+/).slice(0,10).join(" ")+(e.split(/\s+/).length>10?"...":"")}selectTemplate(e){this.form.patchValue({message:e.content}),this.invitationType==="email"&&e.subject&&this.form.patchValue({subject:e.subject}),this.templateSelected.emit(e),this.isFormCollapsed=!1,setTimeout(()=>{this.updateMessageContentEditable()},100)}openCreateTemplateModal(){let e=this.templateTypes.length>0?this.templateTypes[0].type:"";this.newTemplate={id:"",name:"",type:e,content:"",subject:this.invitationType==="email"?"":void 0,createdAt:new Date},this.editingTemplateId=null,this.closeVariablesDropdown(),setTimeout(()=>{this.showCreateTemplateModal=!0,setTimeout(()=>{this.updateContentEditable()},100)},0)}closeCreateTemplateModal(){this.showCreateTemplateModal=!1,this.editingTemplateId=null,this.closeVariablesDropdown()}saveTemplate(){if(this.contentEditableRef){let e=this.contentEditableRef.nativeElement;this.newTemplate.content=this.getPlainTextFromElement(e)}if(!(!this.newTemplate.name||!this.newTemplate.content)&&!(this.invitationType==="email"&&!this.newTemplate.subject)){if(this.editingTemplateId){let e=oe($({},this.newTemplate),{id:this.editingTemplateId});this.templateUpdated.emit(e)}else{let e=oe($({},this.newTemplate),{id:Date.now().toString(),createdAt:new Date});this.templateCreated.emit(e)}this.closeCreateTemplateModal()}}editTemplate(e,t){t.stopPropagation(),this.newTemplate=$({},e),this.editingTemplateId=e.id,this.showCreateTemplateModal=!0,this.closeVariablesDropdown(),setTimeout(()=>{this.updateContentEditable()},100)}deleteTemplate(e,t){t.stopPropagation(),this.templateDeleted.emit(e)}openPreview(e,t){t.stopPropagation(),this.previewTemplate=e,this.showPreviewModal=!0}closePreview(){this.showPreviewModal=!1,this.previewTemplate=null}getPreviewMessage(){return this.form.get("message")?.value||"\u0422\u0435\u043A\u0441\u0442 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u044F..."}getPreviewContactName(){return"\u041F\u043E\u043B\u0443\u0447\u0430\u0442\u0435\u043B\u044C"}getPreviewAvatarLetter(){return"\u041F"}getPreviewEmail(){return"email@example.com"}getIconGradient(){return this.invitationType==="email"?"linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)":"linear-gradient(135deg, #25D366 0%, #128C7E 100%)"}formatTimeout=null;isFormatting=!1;lastFormattedContent="";messageFormatTimeout=null;isMessageFormatting=!1;lastFormattedMessageContent="";onContentInput(e){let t=e.target,n=this.getPlainTextFromElement(t);if(this.newTemplate.content=n,this.isFormatting)return;this.formatTimeout&&clearTimeout(this.formatTimeout);let s=window.getSelection();if(s&&s.rangeCount>0){let u=s.getRangeAt(0),x=this.getTextBeforeCursor(t,u),y=x.lastIndexOf("{{");if(y!==-1){let C=x.substring(y+2);if(!C.includes("}}")){this.currentBracePosition=y,this.showVariablesDropdown=!0;let P=C.toLowerCase();this.filteredVariables=this.availableVariables.filter(T=>T.name.toLowerCase().includes(P)||T.description.toLowerCase().includes(P)),this.filteredVariables.length===0&&(this.filteredVariables=[...this.availableVariables]),this.highlightedVariableIndex=0,this.updateDropdownPosition(t,u),this.formatTimeout=setTimeout(()=>this.formatContentWithVariables(t),150);return}}}n.includes("{{")&&!n.match(/\{\{[^}]*$/)||this.closeVariablesDropdown(),n!==this.lastFormattedContent&&(this.formatTimeout=setTimeout(()=>this.formatContentWithVariables(t),200))}onContentKeydown(e){if(this.showVariablesDropdown){if(e.key==="ArrowDown")e.preventDefault(),this.highlightedVariableIndex=Math.min(this.highlightedVariableIndex+1,this.filteredVariables.length-1),this.scrollToHighlightedVariable();else if(e.key==="ArrowUp")e.preventDefault(),this.highlightedVariableIndex=Math.max(this.highlightedVariableIndex-1,0),this.scrollToHighlightedVariable();else if(e.key==="Enter")e.preventDefault(),this.filteredVariables[this.highlightedVariableIndex]&&this.selectVariable(this.filteredVariables[this.highlightedVariableIndex]);else if(e.key==="Escape")e.preventDefault(),this.closeVariablesDropdown();else if(e.key==="}"){let t=e.target,n=this.getPlainTextFromElement(t),s=window.getSelection();if(s&&s.rangeCount>0){let c=s.getRangeAt(0);this.getTextBeforeCursor(t,c).endsWith("}")&&(e.preventDefault(),this.closeVariablesDropdown())}}}}scrollToHighlightedVariable(){setTimeout(()=>{let e=document.querySelector(".variables-dropdown-list"),t=document.querySelector(".variable-option.highlighted");e&&t&&t.scrollIntoView({block:"nearest",behavior:"smooth"})},0)}updateMessageContentEditable(){if(this.messageContentEditableRef){let e=this.messageContentEditableRef.nativeElement;this.form.get("message")?.value||""?(this.isMessageFormatting=!1,this.lastFormattedMessageContent="",this.formatMessageWithVariables(e)):(e.innerHTML="",this.lastFormattedMessageContent="")}}onContentClick(){}onContentBlur(e){let t=e.relatedTarget;t&&!t.closest(".variables-dropdown")&&setTimeout(()=>{document.activeElement!==this.contentEditableRef?.nativeElement&&this.closeVariablesDropdown()},200)}updateDropdownPosition(e,t){let n=t.getBoundingClientRect(),s=e.getBoundingClientRect(),c=e.scrollTop||0,u=e.scrollLeft||0;this.dropdownPosition={top:n.bottom-s.top+c+5,left:n.left-s.left+u}}selectVariable(e){let t=this.contentEditableRef?.nativeElement||document.querySelector(".form-textarea-editable");if(!t)return;let n=window.getSelection();if(!n||n.rangeCount===0)return;let s=n.getRangeAt(0),c=this.getPlainTextFromElement(t),u=this.getTextBeforeCursor(t,s),x=u.lastIndexOf("{{");if(x===-1){this.closeVariablesDropdown();return}let y=this.getCursorPosition(t,s),C=u.substring(x+2),P=e.name.replace(/[{}]/g,""),T=c.substring(0,x+2),j=c.substring(y),ie=T+P+"}}"+j;this.newTemplate.content=ie,this.formatContentWithVariables(t),setTimeout(()=>{let Qe=x+2+e.name.length+2;this.setCursorPosition(t,Qe)},20),this.closeVariablesDropdown()}closeVariablesDropdown(){this.showVariablesDropdown=!1,this.highlightedVariableIndex=0,this.currentBracePosition=-1}getFormattedContent(){return this.newTemplate.content?this.newTemplate.content.replace(/\{(\w+)\}/g,'<span class="variable-tag">{$1}</span>'):""}formatContentWithVariables(e){if(this.isFormatting)return;this.isFormatting=!0;let t=this.newTemplate.content||this.getPlainTextFromElement(e);if(!t){e.innerHTML="",this.lastFormattedContent="",this.isFormatting=!1;return}if(t===this.lastFormattedContent){this.isFormatting=!1;return}let n=window.getSelection(),s=0,c=document.activeElement===e;if(n&&n.rangeCount>0&&c)try{let T=n.getRangeAt(0);s=this.getCursorPosition(e,T)}catch{s=t.length}let u=[],x=0,y=/\{\{([a-zA-Z_][a-zA-Z0-9_]*)\}\}/g,C;for(;(C=y.exec(t))!==null;){if(C.index>x){let T=t.substring(x,C.index);u.push(this.escapeHtml(T))}u.push(`<span class="variable-tag">{{${C[1]}}}</span>`),x=y.lastIndex}x<t.length&&u.push(this.escapeHtml(t.substring(x)));let P=u.length>0?u.join(""):this.escapeHtml(t);e.innerHTML!==P?(e.innerHTML=P,this.lastFormattedContent=t,n&&c&&s>=0?requestAnimationFrame(()=>{document.activeElement===e&&s<=t.length&&this.setCursorPosition(e,s),this.isFormatting=!1}):this.isFormatting=!1):(this.lastFormattedContent=t,this.isFormatting=!1)}getPlainTextFromElement(e){return e.innerText||e.textContent||""}getTextBeforeCursor(e,t){let n=this.getPlainTextFromElement(e),s=this.getCursorPosition(e,t);return n.substring(0,s)}getTextAfterCursor(e,t){let n=this.getPlainTextFromElement(e),s=this.getCursorPosition(e,t);return n.substring(s)}getCursorPosition(e,t){let n=t.cloneRange();n.selectNodeContents(e),n.setEnd(t.endContainer,t.endOffset);let s=document.createElement("div");return s.appendChild(n.cloneContents()),s.textContent?.length||0}setCursorPosition(e,t){let n=window.getSelection();if(!n)return;document.activeElement!==e&&e.focus();let s=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null),c=0,u=null,x=0,y;for(;y=s.nextNode();){let C=y.textContent?.length||0;if(c+C>=t){u=y,x=t-c;break}c+=C}if(!u){let C=this.getLastTextNode(e);if(C)u=C,x=C.textContent?.length||0;else{let P=document.createTextNode("");e.appendChild(P),u=P,x=0}}if(u)try{let C=document.createRange(),P=u.textContent?.length||0,T=Math.max(0,Math.min(x,P));C.setStart(u,T),C.collapse(!0),n.removeAllRanges(),n.addRange(C);let j=C.getBoundingClientRect();(j.top<0||j.bottom>window.innerHeight)&&u.parentElement?.scrollIntoView({block:"nearest",behavior:"smooth"})}catch(C){console.warn("Failed to set cursor position:",C),e.focus()}}getLastTextNode(e){let t=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null),n=null,s;for(;s=t.nextNode();)n=s;return n}escapeHtml(e){let t=document.createElement("div");return t.textContent=e,t.innerHTML}findTextNodeAtPosition(e,t){let n=0,s=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null),c;for(;c=s.nextNode();){let u=c.textContent?.length||0;if(n+u>=t)return c;n+=u}return null}getPlainTextContent(){return this.newTemplate.content||""}getPlainTextFromHtml(e){let t=document.createElement("div");return t.innerHTML=e,t.innerText||t.textContent||""}updateContentEditable(){if(this.contentEditableRef){let e=this.contentEditableRef.nativeElement;this.newTemplate.content?(this.isFormatting=!1,this.lastFormattedContent="",this.formatContentWithVariables(e)):(e.innerHTML="",this.lastFormattedContent="")}}getMessageLength(){return this.messageContentEditableRef?this.getPlainTextFromElement(this.messageContentEditableRef.nativeElement).length:this.form.get("message")?.value?.length||0}onMessageInput(e){let t=e.target,n=this.getPlainTextFromElement(t);if(this.form.patchValue({message:n}),this.isMessageFormatting)return;this.messageFormatTimeout&&clearTimeout(this.messageFormatTimeout);let s=window.getSelection();if(s&&s.rangeCount>0){let u=s.getRangeAt(0),x=this.getTextBeforeCursor(t,u),y=x.lastIndexOf("{{");if(y!==-1){let C=x.substring(y+2);if(!C.includes("}}")){this.currentMessageBracePosition=y,this.showMessageVariablesDropdown=!0;let P=C.toLowerCase();this.filteredMessageVariables=this.availableVariables.filter(T=>T.name.toLowerCase().includes(P)||T.description.toLowerCase().includes(P)),this.filteredMessageVariables.length===0&&(this.filteredMessageVariables=[...this.availableVariables]),this.highlightedMessageVariableIndex=0,this.updateMessageDropdownPosition(t,u),this.messageFormatTimeout=setTimeout(()=>this.formatMessageWithVariables(t),150);return}}}n.includes("{{")&&!n.match(/\{\{[^}]*$/)||this.closeMessageVariablesDropdown(),n!==this.lastFormattedMessageContent&&(this.messageFormatTimeout=setTimeout(()=>this.formatMessageWithVariables(t),200))}onMessageKeydown(e){if(this.showMessageVariablesDropdown){if(e.key==="ArrowDown")e.preventDefault(),this.highlightedMessageVariableIndex=Math.min(this.highlightedMessageVariableIndex+1,this.filteredMessageVariables.length-1),this.scrollToHighlightedMessageVariable();else if(e.key==="ArrowUp")e.preventDefault(),this.highlightedMessageVariableIndex=Math.max(this.highlightedMessageVariableIndex-1,0),this.scrollToHighlightedMessageVariable();else if(e.key==="Enter")e.preventDefault(),this.filteredMessageVariables[this.highlightedMessageVariableIndex]&&this.selectMessageVariable(this.filteredMessageVariables[this.highlightedMessageVariableIndex]);else if(e.key==="Escape")e.preventDefault(),this.closeMessageVariablesDropdown();else if(e.key==="}"){let t=e.target,n=window.getSelection();if(n&&n.rangeCount>0){let s=n.getRangeAt(0);this.getTextBeforeCursor(t,s).endsWith("}")&&(e.preventDefault(),this.closeMessageVariablesDropdown())}}}}onMessageClick(){}onMessageBlur(e){let t=e.relatedTarget;t&&!t.closest(".variables-dropdown")&&setTimeout(()=>{document.activeElement!==this.messageContentEditableRef?.nativeElement&&this.closeMessageVariablesDropdown()},200)}updateMessageDropdownPosition(e,t){let n=t.getBoundingClientRect(),s=e.getBoundingClientRect(),c=e.scrollTop||0,u=e.scrollLeft||0;this.messageDropdownPosition={top:n.bottom-s.top+c+5,left:n.left-s.left+u}}selectMessageVariable(e){let t=this.messageContentEditableRef?.nativeElement;if(!t)return;let n=window.getSelection();if(!n||n.rangeCount===0)return;let s=n.getRangeAt(0),c=this.getPlainTextFromElement(t),x=this.getTextBeforeCursor(t,s).lastIndexOf("{{");if(x===-1){this.closeMessageVariablesDropdown();return}let y=this.getCursorPosition(t,s),C=e.name.replace(/[{}]/g,""),P=c.substring(0,x+2),T=c.substring(y),j=P+C+"}}"+T;this.form.patchValue({message:j}),this.formatMessageWithVariables(t),setTimeout(()=>{let ie=x+2+e.name.length+2;this.setCursorPosition(t,ie)},20),this.closeMessageVariablesDropdown()}closeMessageVariablesDropdown(){this.showMessageVariablesDropdown=!1,this.highlightedMessageVariableIndex=0,this.currentMessageBracePosition=-1}formatMessageWithVariables(e){if(this.isMessageFormatting)return;this.isMessageFormatting=!0;let t=this.form.get("message")?.value||this.getPlainTextFromElement(e);if(!t){e.innerHTML="",this.lastFormattedMessageContent="",this.isMessageFormatting=!1;return}if(t===this.lastFormattedMessageContent){this.isMessageFormatting=!1;return}let n=window.getSelection(),s=0,c=document.activeElement===e;if(n&&n.rangeCount>0&&c)try{let T=n.getRangeAt(0);s=this.getCursorPosition(e,T)}catch{s=t.length}let u=[],x=0,y=/\{\{([a-zA-Z_][a-zA-Z0-9_]*)\}\}/g,C;for(;(C=y.exec(t))!==null;){if(C.index>x){let T=t.substring(x,C.index);u.push(this.escapeHtml(T))}u.push(`<span class="variable-tag">{{${C[1]}}}</span>`),x=y.lastIndex}x<t.length&&u.push(this.escapeHtml(t.substring(x)));let P=u.length>0?u.join(""):this.escapeHtml(t);e.innerHTML!==P?(e.innerHTML=P,this.lastFormattedMessageContent=t,n&&c&&s>=0?requestAnimationFrame(()=>{document.activeElement===e&&s<=t.length&&this.setCursorPosition(e,s),this.isMessageFormatting=!1}):this.isMessageFormatting=!1):(this.lastFormattedMessageContent=t,this.isMessageFormatting=!1)}scrollToHighlightedMessageVariable(){setTimeout(()=>{let e=document.querySelector(".variables-dropdown"),t=document.querySelector(".variable-option.highlighted");e&&t&&t.scrollIntoView({block:"nearest",behavior:"smooth"})},0)}static \u0275fac=function(t){return new(t||i)(R(fe))};static \u0275cmp=E({type:i,selectors:[["app-invitation-form"]],viewQuery:function(t,n){if(t&1&&(le(_t,5),le(bt,5)),t&2){let s;pe(s=de())&&(n.contentEditableRef=s.first),pe(s=de())&&(n.messageContentEditableRef=s.first)}},inputs:{invitationType:"invitationType",form:"form",title:"title",subtitle:"subtitle",iconSvg:"iconSvg",iconColor:"iconColor",previewDescription:"previewDescription",messageTemplates:"messageTemplates",isSending:"isSending",successMessage:"successMessage",errorMessage:"errorMessage",hideForm:"hideForm",templateTypes:"templateTypes",templateVariables:"templateVariables"},outputs:{formSubmit:"formSubmit",templateSelected:"templateSelected",templateCreated:"templateCreated",templateUpdated:"templateUpdated",templateDeleted:"templateDeleted"},decls:56,vars:32,consts:[["contentEditable",""],["messageContentEditable",""],[1,"invitation-form-wrapper"],[1,"templates-section"],[1,"templates-header"],[1,"templates-title"],["buttonType","primary","size","medium",3,"onClick"],["viewBox","0 0 24 24","fill","none",1,"btn-icon"],["d","M12 5v14M5 12h14","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],[1,"templates-grid"],["class","template-card",3,"click",4,"ngFor","ngForOf"],["class","template-card empty",4,"ngIf"],["class","collapsible-section",4,"ngIf"],["title","\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u043D\u043E\u0432\u044B\u0439 \u0432\u0438\u0434 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u044F","size","large",3,"closed","visibleChange","visible","showCloseButton","showFooter"],[1,"template-form"],[1,"form-group"],[1,"form-label"],["type","text","placeholder","\u041D\u0430\u043F\u0440\u0438\u043C\u0435\u0440: \u041F\u0440\u0438\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043D\u043D\u043E\u0435 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u0435",1,"form-input",3,"ngModelChange","ngModel"],[1,"type-dropdown-wrapper"],[1,"type-dropdown",3,"ngModelChange","ngModel","disabled"],["value","",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],["viewBox","0 0 24 24","fill","none",1,"dropdown-arrow"],["d","M6 9l6 6 6-6","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["class","form-group",4,"ngIf"],[1,"textarea-wrapper"],["contenteditable","true",1,"form-textarea-editable",3,"input","keydown","click","blur"],["class","variables-dropdown",3,"top","left",4,"ngIf"],[1,"char-count"],[1,"preview-box"],[3,"ngSwitch"],[3,"contactName","avatarLetter","message","showInputBar","noShadow",4,"ngSwitchCase"],[3,"recipientEmail","message","activationLink","buttonText","expirationDays","senderEmail",4,"ngSwitchDefault"],["modalFooter",""],[1,"modal-footer"],["buttonType","secondary","size","medium",3,"onClick"],["size","medium",3,"onClick","buttonType","disabled"],["title","\u041F\u0440\u0435\u0434\u043F\u0440\u043E\u0441\u043C\u043E\u0442\u0440 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u044F",3,"closed","visible","showCloseButton"],[1,"preview-content"],[1,"preview-description"],[3,"contactName","avatarLetter","message","showInputBar","noShadow",4,"ngIf"],[1,"template-card",3,"click"],[1,"template-header"],[1,"template-name"],[1,"template-preview"],[1,"template-actions"],["class","template-action-btn preview-btn","title","\u041F\u0440\u0435\u0434\u043F\u0440\u043E\u0441\u043C\u043E\u0442\u0440",3,"click",4,"ngIf"],["title","\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C",1,"template-action-btn",3,"click"],["viewBox","0 0 24 24","fill","none"],["d","M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7","stroke","currentColor","stroke-width","1.5"],["d","M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z","stroke","currentColor","stroke-width","1.5"],["title","\u0423\u0434\u0430\u043B\u0438\u0442\u044C",1,"template-action-btn",3,"click"],["d","M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2","stroke","currentColor","stroke-width","1.5"],["title","\u041F\u0440\u0435\u0434\u043F\u0440\u043E\u0441\u043C\u043E\u0442\u0440",1,"template-action-btn","preview-btn",3,"click"],["d","M15 12a3 3 0 11-6 0 3 3 0 016 0z","stroke","currentColor","stroke-width","1.5"],["d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z","stroke","currentColor","stroke-width","1.5"],[1,"template-card","empty"],["viewBox","0 0 24 24","fill","none",1,"empty-icon"],["d","M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z","stroke","currentColor","stroke-width","1.5"],["d","M14 2v6h6M16 13H8M16 17H8M10 9H8","stroke","currentColor","stroke-width","1.5"],[1,"empty-text"],[1,"empty-hint"],[1,"collapsible-section"],["class","collapsed-view",3,"click",4,"ngIf"],["class","expanded-view",4,"ngIf"],[1,"collapsed-view",3,"click"],[1,"collapsed-content"],[1,"collapsed-icon",3,"innerHTML"],[1,"collapsed-info"],[1,"collapsed-title"],[1,"collapsed-preview"],[1,"expand-btn"],[1,"expanded-view"],[1,"view-header",3,"click"],[1,"view-header-content"],[1,"icon-wrapper",3,"innerHTML"],[1,"header-text"],[1,"panel-title"],[1,"panel-subtitle"],[1,"collapse-btn"],[1,"expanded-content"],[1,"left-panel",3,"shadow"],["type","success","class","alert-spacing",3,"title","dismissible","dismissed",4,"ngIf"],["type","error","class","alert-spacing",3,"title","dismissible","dismissed",4,"ngIf"],[1,"form-content",3,"ngSubmit","formGroup"],["id","subject","label","\u0422\u0435\u043C\u0430 \u043F\u0438\u0441\u044C\u043C\u0430","type","text","placeholder","\u041F\u0440\u0438\u0433\u043B\u0430\u0448\u0435\u043D\u0438\u0435 \u0432 Westwood","formControlName","subject","prefix","\u{1F4CB}",4,"ngIf"],[1,"textarea-group"],[1,"label-row"],["variant","body2",3,"medium"],["variant","caption",3,"muted"],["contenteditable","true",1,"message-textarea-editable",3,"input","keydown","click","blur"],[3,"spaced"],["type","submit","size","large",1,"submit-btn",3,"buttonType","disabled","loading"],[1,"btn-content"],["viewBox","0 0 24 24","fill","none","class","wa-icon",4,"ngSwitchCase"],["viewBox","0 0 24 24","fill","none","class","email-icon",4,"ngSwitchDefault"],[1,"preview-section"],[1,"section-title"],["viewBox","0 0 24 24","fill","none",1,"title-icon"],[1,"section-heading"],[1,"section-description"],["class","preview-component",3,"contactName","avatarLetter","message","showInputBar","noShadow",4,"ngSwitchCase"],["class","preview-component",3,"recipientEmail","message","activationLink","buttonText","expirationDays","senderEmail",4,"ngSwitchDefault"],["type","success",1,"alert-spacing",3,"dismissed","title","dismissible"],["type","error",1,"alert-spacing",3,"dismissed","title","dismissible"],["id","subject","label","\u0422\u0435\u043C\u0430 \u043F\u0438\u0441\u044C\u043C\u0430","type","text","placeholder","\u041F\u0440\u0438\u0433\u043B\u0430\u0448\u0435\u043D\u0438\u0435 \u0432 Westwood","formControlName","subject","prefix","\u{1F4CB}"],[1,"variables-dropdown"],[1,"variables-dropdown-header"],["type","button",1,"variables-dropdown-close",3,"click"],[1,"variables-dropdown-list"],["type","button","class","variable-option",3,"highlighted","click",4,"ngFor","ngForOf"],["type","button",1,"variable-option",3,"click"],[1,"variable-name"],[1,"variable-desc"],["viewBox","0 0 24 24","fill","none",1,"wa-icon"],["d","M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347z","fill","currentColor"],["d","M12 2C6.477 2 2 6.477 2 12c0 1.89.525 3.66 1.438 5.168L2 22l4.832-1.438A9.955 9.955 0 0012 22c5.523 0 10-4.477 10-10S17.523 2 12 2z","fill","currentColor"],["viewBox","0 0 24 24","fill","none",1,"email-icon"],["d","M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],[1,"preview-component",3,"contactName","avatarLetter","message","showInputBar","noShadow"],[1,"preview-component",3,"recipientEmail","message","activationLink","buttonText","expirationDays","senderEmail"],["value",""],[3,"value"],["type","text","placeholder","\u041F\u0440\u0438\u0433\u043B\u0430\u0448\u0435\u043D\u0438\u0435 \u0432 Westwood",1,"form-input",3,"ngModelChange","ngModel"],[3,"contactName","avatarLetter","message","showInputBar","noShadow"],[3,"recipientEmail","message","activationLink","buttonText","expirationDays","senderEmail"]],template:function(t,n){if(t&1){let s=I();o(0,"div",2)(1,"div",3)(2,"div",4)(3,"h3",5),l(4,"\u0428\u0430\u0431\u043B\u043E\u043D\u044B \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u0439"),a(),o(5,"app-button",6),w("onClick",function(){return _(s),b(n.openCreateTemplateModal())}),v(),o(6,"svg",7),g(7,"path",8),a(),l(8," \u0421\u043E\u0437\u0434\u0430\u0442\u044C \u043D\u043E\u0432\u044B\u0439 \u0432\u0438\u0434 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u044F "),a()(),M(),o(9,"div",9),f(10,xt,15,3,"div",10)(11,wt,8,0,"div",11),a()(),f(12,Dt,3,2,"div",12),a(),o(13,"app-modal",13),w("closed",function(){return _(s),b(n.closeCreateTemplateModal())})("visibleChange",function(u){return _(s),b(n.showCreateTemplateModal=u)}),o(14,"div",14)(15,"div",15)(16,"label",16),l(17,"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u044F"),a(),o(18,"input",17),K("ngModelChange",function(u){return _(s),Y(n.newTemplate.name,u)||(n.newTemplate.name=u),b(u)}),a()(),o(19,"div",15)(20,"label",16),l(21,"\u0422\u0438\u043F \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u044F"),a(),o(22,"div",18)(23,"select",19),K("ngModelChange",function(u){return _(s),Y(n.newTemplate.type,u)||(n.newTemplate.type=u),b(u)}),f(24,Bt,2,0,"option",20)(25,zt,2,2,"option",21),a(),v(),o(26,"svg",22),g(27,"path",23),a()()(),f(28,Lt,4,3,"div",24),M(),o(29,"div",15)(30,"label",16),l(31,"\u041A\u043E\u043D\u0442\u0435\u043D\u0442 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u044F"),a(),o(32,"div",25)(33,"div",26,0),w("input",function(u){return _(s),b(n.onContentInput(u))})("keydown",function(u){return _(s),b(n.onContentKeydown(u))})("click",function(){return _(s),b(n.onContentClick())})("blur",function(u){return _(s),b(n.onContentBlur(u))}),a(),f(35,Ht,8,5,"div",27),a(),o(36,"div",28),l(37),a()(),o(38,"div",15)(39,"label",16),l(40,"\u041F\u0440\u0435\u0434\u043F\u0440\u043E\u0441\u043C\u043E\u0442\u0440"),a(),o(41,"div",29),L(42,30),f(43,jt,1,5,"app-whatsapp-preview",31)(44,Nt,1,6,"app-email-preview",32),A(),a()()(),L(45,33),o(46,"div",34)(47,"app-button",35),w("onClick",function(){return _(s),b(n.closeCreateTemplateModal())}),l(48," \u041E\u0442\u043C\u0435\u043D\u0430 "),a(),o(49,"app-button",36),w("onClick",function(){return _(s),b(n.saveTemplate())}),l(50," \u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u0448\u0430\u0431\u043B\u043E\u043D "),a()(),A(),a(),o(51,"app-modal",37),w("closed",function(){return _(s),b(n.closePreview())}),o(52,"div",38)(53,"p",39),l(54,"\u0422\u0430\u043A \u0431\u0443\u0434\u0435\u0442 \u0432\u044B\u0433\u043B\u044F\u0434\u0435\u0442\u044C \u0432\u0430\u0448\u0435 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u0435 \u0432 WhatsApp"),a(),f(55,Wt,1,5,"app-whatsapp-preview",40),a()()}t&2&&(r(10),p("ngForOf",n.messageTemplates),r(),p("ngIf",n.messageTemplates.length===0),r(),p("ngIf",!n.hideForm),r(),p("visible",n.showCreateTemplateModal)("showCloseButton",!0)("showFooter",!0),r(3),V("data-type",n.invitationType),r(2),Q("ngModel",n.newTemplate.name),V("data-type",n.invitationType),r(2),V("data-type",n.invitationType),r(3),Q("ngModel",n.newTemplate.type),p("disabled",n.templateTypes.length===0),V("data-type",n.invitationType),r(),p("ngIf",n.templateTypes.length===0),r(),p("ngForOf",n.templateTypes),r(3),p("ngIf",n.invitationType==="email"),r(2),V("data-type",n.invitationType),r(2),V("data-type",n.invitationType),r(),V("data-type",n.invitationType)("placeholder","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043A\u0441\u0442 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u044F..."),r(2),p("ngIf",n.showVariablesDropdown),r(2),ce("",n.getPlainTextContent().length,"/",n.invitationType==="email"?"1000":"500",""),r(2),V("data-type",n.invitationType),r(2),V("data-type",n.invitationType),r(),p("ngSwitch",n.invitationType),r(),p("ngSwitchCase","whatsapp"),r(6),p("buttonType",n.invitationType==="email"?"primary":"success")("disabled",!n.newTemplate.name||!n.newTemplate.content||n.invitationType==="email"&&!n.newTemplate.subject),r(2),p("visible",n.showPreviewModal)("showCloseButton",!0),r(4),p("ngIf",n.previewTemplate))},dependencies:[O,Z,B,X,J,ue,ee,Te,Oe,ke,Ce,Ee,we,Me,Pe,Se,Fe,ye,je,De,Be,We,Ve,Re,te,Ge,Ue],styles:['[_nghost-%COMP%]{display:block;width:100%}.collapsible-section[_ngcontent-%COMP%]{background:#fff;border-radius:24px;box-shadow:0 1px 3px #00000014;overflow:hidden;transition:all .3s ease}.collapsed-view[_ngcontent-%COMP%]{padding:1.25rem 1.5rem;cursor:pointer;transition:background .2s}.collapsed-view[_ngcontent-%COMP%]:hover{background:#f8fafc}.collapsed-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.collapsed-icon[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:12px;display:flex;align-items:center;justify-content:center;flex-shrink:0}.collapsed-icon[_ngcontent-%COMP%]     svg{width:20px;height:20px;color:#fff}.collapsed-icon[_ngcontent-%COMP%]     svg path{fill:#fff}.collapsed-info[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:.25rem;min-width:0}.collapsed-title[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;color:#1f2937}.collapsed-preview[_ngcontent-%COMP%]{font-size:.875rem;color:#64748b;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.expand-btn[_ngcontent-%COMP%]{background:none;border:none;padding:.5rem;cursor:pointer;color:#64748b;display:flex;align-items:center;justify-content:center;transition:transform .2s}.expand-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px;transition:transform .2s}.expand-btn[_ngcontent-%COMP%]   svg.rotated[_ngcontent-%COMP%]{transform:rotate(180deg)}.view-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:1.25rem 1.5rem;border-bottom:1px solid #f1f5f9;cursor:pointer;transition:background .2s}.view-header[_ngcontent-%COMP%]:hover{background:#f8fafc}.view-header-content[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:1.25rem}.collapse-btn[_ngcontent-%COMP%]{background:none;border:none;padding:.5rem;cursor:pointer;color:#64748b;display:flex;align-items:center;justify-content:center}.collapse-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px}.expanded-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:2rem;padding:2rem}.icon-wrapper[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:16px;display:flex;align-items:center;justify-content:center;flex-shrink:0}.icon-wrapper[_ngcontent-%COMP%]     svg{width:28px;height:28px;color:#fff}.icon-wrapper[_ngcontent-%COMP%]     svg path{fill:#fff}.header-text[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.panel-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#0f172a;margin:0}.panel-subtitle[_ngcontent-%COMP%]{font-size:.9375rem;color:#64748b;margin:0}.alert-spacing[_ngcontent-%COMP%]{margin-bottom:1.5rem}.left-panel[_ngcontent-%COMP%]{display:flex;flex-direction:column;border-radius:24px!important}[_nghost-%COMP%]     .left-panel .card-body{display:flex;flex-direction:column;flex:1;padding:2rem!important}.form-content[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:1.25rem}.textarea-group[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column}.label-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem}.message-textarea[_ngcontent-%COMP%]{flex:1;width:100%;min-height:120px;padding:.875rem;border:1px solid #cbd5e1;border-radius:8px;font-size:.9375rem;font-family:inherit;resize:none;transition:all .2s ease;background-color:#fff;color:#1a202c;line-height:1.6}.message-textarea[_ngcontent-%COMP%]:focus{outline:none}.message-textarea[data-type=whatsapp][_ngcontent-%COMP%]:focus{border-color:#25d366;box-shadow:0 0 0 3px #25d36626}.message-textarea[data-type=email][_ngcontent-%COMP%]:focus{border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f626}.message-textarea[_ngcontent-%COMP%]::placeholder{color:#94a3b8}.message-textarea-editable[_ngcontent-%COMP%]{flex:1;width:100%;min-height:120px;padding:.875rem;border:1px solid #cbd5e1;border-radius:8px;font-size:.9375rem;font-family:inherit;background-color:#fff;color:#1a202c;line-height:1.6;outline:none;white-space:pre-wrap;word-wrap:break-word}.message-textarea-editable[_ngcontent-%COMP%]:empty:before{content:attr(placeholder);color:#94a3b8;pointer-events:none}.message-textarea-editable[_ngcontent-%COMP%]:focus{outline:none}.message-textarea-editable[data-type=whatsapp][_ngcontent-%COMP%]:focus{border-color:#25d366;box-shadow:0 0 0 3px #25d36626}.message-textarea-editable[data-type=email][_ngcontent-%COMP%]:focus{border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f626}.submit-btn[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]     .submit-btn button{width:100%;border-radius:12px!important;padding:1rem 1.5rem!important}[_nghost-%COMP%]     .submit-btn button:hover:not(:disabled){transform:translateY(-2px)}.btn-icon[_ngcontent-%COMP%]{width:18px;height:18px;flex-shrink:0;display:block}.wa-icon[_ngcontent-%COMP%], .email-icon[_ngcontent-%COMP%]{width:22px;height:22px}.preview-section[_ngcontent-%COMP%]{background:#fff;border-radius:24px;padding:1.5rem;box-shadow:0 1px 3px #0000000d;display:flex;flex-direction:column}.section-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.625rem;margin-bottom:.25rem}.title-icon[_ngcontent-%COMP%]{width:22px;height:22px}.section-heading[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:#1f2937;margin:0}.section-description[_ngcontent-%COMP%]{font-size:.875rem;color:#9ca3af;margin:0 0 1.25rem}.preview-component[_ngcontent-%COMP%]{flex:1;display:block}.templates-section[_ngcontent-%COMP%]{background:#fff;border-radius:24px;padding:1.5rem;box-shadow:0 1px 3px #00000014;margin-bottom:2rem}.templates-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem}.templates-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;color:#1f2937;margin:0}.templates-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:1rem}.template-card[_ngcontent-%COMP%]{background:#f8fafc;border:1.5px solid #e2e8f0;border-radius:16px;padding:1.25rem;cursor:pointer;transition:all .2s;position:relative}.template-card[_ngcontent-%COMP%]:hover{background:#f1f5f9;border-color:#25d366;transform:translateY(-2px);box-shadow:0 4px 12px #25d36626}.template-card.empty[_ngcontent-%COMP%]{text-align:center;padding:3rem 1.5rem;cursor:default;border-style:dashed}.template-card.empty[_ngcontent-%COMP%]:hover{transform:none;border-color:#e2e8f0}.template-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:.75rem}.template-name[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;color:#1f2937}.template-preview[_ngcontent-%COMP%]{font-size:.875rem;color:#64748b;line-height:1.5;margin:0 0 .75rem;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}.template-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;opacity:0;transition:opacity .2s}.template-card[_ngcontent-%COMP%]:hover   .template-actions[_ngcontent-%COMP%]{opacity:1}.template-action-btn[_ngcontent-%COMP%]{background:#fff;border:1px solid #e2e8f0;border-radius:8px;padding:.4rem;cursor:pointer;color:#64748b;display:flex;align-items:center;justify-content:center;transition:all .15s}.template-action-btn[_ngcontent-%COMP%]:hover{background:#f1f5f9;border-color:#cbd5e1;color:#1f2937}.template-action-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:16px;height:16px}.empty-icon[_ngcontent-%COMP%]{width:48px;height:48px;color:#d1d5db;margin:0 auto 1rem}.empty-text[_ngcontent-%COMP%]{font-size:.9375rem;color:#64748b;margin:0 0 .25rem;font-weight:500}.empty-hint[_ngcontent-%COMP%]{font-size:.8125rem;color:#94a3b8;margin:0}.template-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem;padding:.5rem 0}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.form-label[_ngcontent-%COMP%]{font-size:.9375rem;font-weight:600;color:#1f2937;display:flex;align-items:center;gap:.5rem}.form-label[_ngcontent-%COMP%]:before{content:"";width:3px;height:16px;border-radius:2px}.form-label[data-type=whatsapp][_ngcontent-%COMP%]:before{background:linear-gradient(135deg,#25d366,#128c7e)}.form-label[data-type=email][_ngcontent-%COMP%]:before{background:linear-gradient(135deg,#3b82f6,#1d4ed8)}.form-input[_ngcontent-%COMP%]{padding:.875rem 1.125rem;border:2px solid #e2e8f0;border-radius:12px;font-size:.9375rem;background:#fff;color:#1f2937;transition:all .2s;font-family:inherit}.form-input[_ngcontent-%COMP%]::placeholder{color:#94a3b8}.form-input[_ngcontent-%COMP%]:focus{outline:none;background:#f0fdf4;box-shadow:0 0 0 4px #25d3661a}.form-input[data-type=whatsapp][_ngcontent-%COMP%]:focus{border-color:#25d366;background:#f0fdf4;box-shadow:0 0 0 4px #25d3661a}.form-input[data-type=email][_ngcontent-%COMP%]:focus{border-color:#3b82f6;background:#eff6ff;box-shadow:0 0 0 4px #3b82f61a}.type-dropdown-wrapper[_ngcontent-%COMP%]{position:relative}.type-dropdown[_ngcontent-%COMP%]{width:100%;padding:.875rem 3rem .875rem 1.125rem;border:2px solid #e2e8f0;border-radius:12px;font-size:.9375rem;background:#fff;color:#1f2937;transition:all .2s;font-family:inherit;appearance:none;cursor:pointer}.type-dropdown[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 4px #25d3661a}.type-dropdown[data-type=whatsapp][_ngcontent-%COMP%]:focus{border-color:#25d366;background:#f0fdf4;box-shadow:0 0 0 4px #25d3661a}.type-dropdown[data-type=email][_ngcontent-%COMP%]:focus{border-color:#3b82f6;background:#eff6ff;box-shadow:0 0 0 4px #3b82f61a}.type-dropdown[_ngcontent-%COMP%]:hover{border-color:#cbd5e1}.dropdown-arrow[_ngcontent-%COMP%]{position:absolute;right:1rem;top:50%;transform:translateY(-50%);width:20px;height:20px;color:#64748b;pointer-events:none;transition:transform .2s}.type-dropdown[data-type=whatsapp][_ngcontent-%COMP%]:focus + .dropdown-arrow[_ngcontent-%COMP%]{color:#25d366}.type-dropdown[data-type=email][_ngcontent-%COMP%]:focus + .dropdown-arrow[_ngcontent-%COMP%]{color:#3b82f6}.textarea-wrapper[_ngcontent-%COMP%]{position:relative;width:100%}.form-textarea[_ngcontent-%COMP%]{width:100%;padding:1rem 1.125rem;border:2px solid #e2e8f0;border-radius:12px;font-size:.9375rem;font-family:inherit;resize:vertical;background:#fff;color:#1f2937;line-height:1.6;transition:all .2s;min-height:150px}.form-textarea[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 4px #25d3661a}.form-textarea[data-type=whatsapp][_ngcontent-%COMP%]:focus{border-color:#25d366;background:#f0fdf4;box-shadow:0 0 0 4px #25d3661a}.form-textarea[data-type=email][_ngcontent-%COMP%]:focus{border-color:#3b82f6;background:#eff6ff;box-shadow:0 0 0 4px #3b82f61a}.form-textarea-editable[_ngcontent-%COMP%]{width:100%;padding:1rem 1.125rem;border:2px solid #e2e8f0;border-radius:12px;font-size:.9375rem;font-family:inherit;background:#fff;color:#1f2937;line-height:1.6;transition:all .2s;min-height:150px;outline:none;white-space:pre-wrap;word-wrap:break-word}.form-textarea-editable[_ngcontent-%COMP%]:empty:before{content:attr(placeholder);color:#94a3b8;pointer-events:none}.form-textarea-editable[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 4px #25d3661a}.form-textarea-editable[data-type=whatsapp][_ngcontent-%COMP%]:focus{border-color:#25d366;background:#f0fdf4;box-shadow:0 0 0 4px #25d3661a}.form-textarea-editable[data-type=email][_ngcontent-%COMP%]:focus{border-color:#3b82f6;background:#eff6ff;box-shadow:0 0 0 4px #3b82f61a}.variable-tag[_ngcontent-%COMP%]{color:#16a34a!important;font-style:italic!important;font-weight:500!important;font-family:Courier New,Monaco,Menlo,Consolas,monospace!important;background:#22c55e14!important;padding:2px 6px!important;border-radius:4px!important;border:1px solid rgba(34,197,94,.2)!important;display:inline!important}[_nghost-%COMP%]     .variable-tag{color:#169ea3!important;font-style:italic!important;font-weight:500!important;font-family:Courier New,Monaco,Menlo,Consolas,monospace!important;background:#169ea333!important;padding:2px 6px!important;border-radius:4px!important;border:1px solid rgba(34,197,94,.2)!important;display:inline!important}.variables-dropdown[_ngcontent-%COMP%]{position:absolute;background:#fff;border:1px solid #e2e8f0;border-radius:12px;box-shadow:0 4px 12px #00000026;z-index:1000;min-width:280px;max-width:400px;max-height:300px;overflow:hidden;margin-top:4px}.variables-dropdown-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:10px 14px;background:#f8fafc;border-bottom:1px solid #e2e8f0;font-size:.8rem;font-weight:600;color:#64748b}.variables-dropdown-close[_ngcontent-%COMP%]{background:none;border:none;font-size:1.25rem;color:#94a3b8;cursor:pointer;padding:0;line-height:1;transition:color .15s}.variables-dropdown-close[_ngcontent-%COMP%]:hover{color:#64748b}.variables-dropdown-list[_ngcontent-%COMP%]{max-height:250px;overflow-y:auto;padding:4px}.variable-option[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px;width:100%;padding:10px 14px;background:transparent;border:none;text-align:left;cursor:pointer;transition:all .15s;border-radius:8px}.variable-option[_ngcontent-%COMP%]:hover, .variable-option.highlighted[_ngcontent-%COMP%]{background:#f0fdf4}.variable-name[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600;color:#16a34a;font-family:Courier New,monospace}.variable-desc[_ngcontent-%COMP%]{font-size:.75rem;color:#64748b}.char-count[_ngcontent-%COMP%]{font-size:.75rem;color:#94a3b8;text-align:right;margin-top:.25rem}.preview-box[_ngcontent-%COMP%]{border-radius:16px;padding:1.5rem;max-height:450px;overflow-y:auto}.preview-box[data-type=whatsapp][_ngcontent-%COMP%]{background:linear-gradient(135deg,#f0fdf4,#fff);border:2px solid #dcfce7;box-shadow:0 2px 8px #25d36614}.preview-box[data-type=email][_ngcontent-%COMP%]{background:linear-gradient(135deg,#eff6ff,#fff);border:2px solid #dbeafe;box-shadow:0 2px 8px #3b82f614}.modal-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.875rem;padding:1.25rem 0 0;border-top:2px solid #f1f5f9;margin-top:.5rem}[_nghost-%COMP%]     .modal-footer app-button button{padding:.75rem 1.5rem!important;font-weight:600!important;border-radius:10px!important}@media (max-width: 1024px){.expanded-content[_ngcontent-%COMP%]{grid-template-columns:1fr}.templates-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(240px,1fr))}}@media (max-width: 768px){.expanded-content[_ngcontent-%COMP%]{padding:1rem}.templates-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:1rem}.templates-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}[_nghost-%COMP%]     .left-panel .card-body{padding:1.5rem!important}}.preview-content[_ngcontent-%COMP%]{padding:.5rem 0}.preview-description[_ngcontent-%COMP%]{font-size:.875rem;color:#64748b;margin:0 0 1.5rem}']})}return i})();function Rt(i,m){i&1&&(v(),o(0,"svg",11),g(1,"path",18)(2,"path",19),a())}function Gt(i,m){i&1&&(v(),o(0,"svg",11),g(1,"path",20)(2,"path",21),a())}function Ut(i,m){if(i&1&&(o(0,"div",3)(1,"div",4),l(2,"\u0422\u0435\u043C\u0430 \u043F\u0438\u0441\u044C\u043C\u0430"),a(),o(3,"div",9),l(4),a()()),i&2){let e=d(2);r(4),h(e.message.subject)}}function $t(i,m){if(i&1&&(o(0,"div",3)(1,"div",4),l(2,"\u0428\u0430\u0431\u043B\u043E\u043D"),a(),o(3,"div",9)(4,"span",22),l(5),a()()()),i&2){let e=d(2);r(5),h(e.message.templateName)}}function qt(i,m){if(i&1&&(o(0,"div",3)(1,"div",4),l(2,"\u041E\u0442\u043F\u0440\u0430\u0432\u0438\u043B"),a(),o(3,"div",9)(4,"div",23),v(),o(5,"svg",11),g(6,"path",24)(7,"circle",25),a(),M(),o(8,"span"),l(9),a()()()()),i&2){let e=d(2);r(9),h(e.message.initiatedByUsername)}}function Qt(i,m){if(i&1&&(o(0,"div",2)(1,"div",3)(2,"div",4),l(3,"\u041F\u043E\u043B\u0443\u0447\u0430\u0442\u0435\u043B\u044C"),a(),o(4,"div",5)(5,"div",6),f(6,Rt,3,0,"svg",7)(7,Gt,3,0,"svg",7),a(),o(8,"span"),l(9),a()()(),f(10,Ut,5,1,"div",8),o(11,"div",3)(12,"div",4),l(13,"\u0412\u0440\u0435\u043C\u044F \u043E\u0442\u043F\u0440\u0430\u0432\u043A\u0438"),a(),o(14,"div",9)(15,"div",10),v(),o(16,"svg",11),g(17,"circle",12)(18,"path",13),a(),M(),o(19,"span"),l(20),a()()()(),o(21,"div",3)(22,"div",4),l(23,"\u0421\u0442\u0430\u0442\u0443\u0441"),a(),o(24,"div",9)(25,"app-badge",14),l(26),a()()(),f(27,$t,6,1,"div",8)(28,qt,10,1,"div",8),o(29,"div",15)(30,"div",4),l(31,"\u0421\u043E\u0434\u0435\u0440\u0436\u0430\u043D\u0438\u0435 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u044F"),a(),o(32,"div",16)(33,"pre",17),l(34),a()()()()),i&2){let e=d();r(5),k("whatsapp",e.message.type==="whatsapp")("email",e.message.type==="email"),r(),p("ngIf",e.message.type==="whatsapp"),r(),p("ngIf",e.message.type==="email"),r(2),h(e.message.recipient||"\u041D\u0435 \u0443\u043A\u0430\u0437\u0430\u043D"),r(),p("ngIf",e.message.type==="email"&&e.message.subject),r(10),h(e.formatDateTime(e.message.sentAt)),r(5),p("badgeType",e.getStatusBadgeType(e.message.status)),r(),S(" ",e.getStatusLabel(e.message.status)," "),r(),p("ngIf",e.message.templateName),r(),p("ngIf",e.message.initiatedByUsername),r(6),h(e.message.message)}}var qe=(()=>{class i{visible=!1;message=null;visibleChange=new z;getModalTitle(){return this.message?this.message.type==="whatsapp"?"\u0414\u0435\u0442\u0430\u043B\u0438 WhatsApp \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u044F":"\u0414\u0435\u0442\u0430\u043B\u0438 Email \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u044F":"\u0414\u0435\u0442\u0430\u043B\u0438 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u044F"}formatDateTime(e){let t=new Date(e),n=t.toLocaleDateString("ru-RU",{day:"2-digit",month:"long",year:"numeric"}),s=t.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"});return`${n} \u0432 ${s}`}getStatusBadgeType(e){switch(e){case"sent":return"success";case"pending":return"warning";case"failed":return"danger";default:return"success"}}getStatusLabel(e){switch(e){case"sent":return"\u041E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u043E";case"pending":return"\u041E\u0436\u0438\u0434\u0430\u0435\u0442";case"failed":return"\u041E\u0448\u0438\u0431\u043A\u0430";default:return e}}onClose(){this.visibleChange.emit(!1)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=E({type:i,selectors:[["app-message-details-modal"]],inputs:{visible:"visible",message:"message"},outputs:{visibleChange:"visibleChange"},decls:2,vars:4,consts:[[3,"visibleChange","visible","title","showCloseButton"],["class","message-details-content",4,"ngIf"],[1,"message-details-content"],[1,"detail-section"],[1,"detail-label"],[1,"detail-value","recipient-value"],[1,"recipient-icon"],["viewBox","0 0 24 24","fill","none",4,"ngIf"],["class","detail-section",4,"ngIf"],[1,"detail-value"],[1,"time-info"],["viewBox","0 0 24 24","fill","none"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","1.5"],["d","M12 6v6l4 2","stroke","currentColor","stroke-width","1.5","stroke-linecap","round"],["size","medium",3,"badgeType"],[1,"detail-section","message-section"],[1,"message-content"],[1,"message-text"],["d","M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347z","fill","currentColor"],["d","M12 2C6.477 2 2 6.477 2 12c0 1.89.525 3.66 1.438 5.168L2 22l4.832-1.438A9.955 9.955 0 0012 22c5.523 0 10-4.477 10-10S17.523 2 12 2z","fill","currentColor"],["d","M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z","stroke","currentColor","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],["d","M22 6l-10 7L2 6","stroke","currentColor","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],[1,"template-badge"],[1,"sender-info"],["d","M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2","stroke","currentColor","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],["cx","12","cy","7","r","4","stroke","currentColor","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"]],template:function(t,n){t&1&&(o(0,"app-modal",0),w("visibleChange",function(){return n.onClose()}),f(1,Qt,35,14,"div",1),a()),t&2&&(p("visible",n.visible)("title",n.getModalTitle())("showCloseButton",!0),r(),p("ngIf",n.message))},dependencies:[O,B,te,ne],styles:[".message-details-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem;padding:.5rem 0}.detail-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.detail-label[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600;color:#64748b;text-transform:uppercase;letter-spacing:.5px}.detail-value[_ngcontent-%COMP%]{font-size:.9375rem;color:#1f2937;font-weight:500}.recipient-value[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.recipient-icon[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:8px;display:flex;align-items:center;justify-content:center;flex-shrink:0}.recipient-icon.whatsapp[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dcfce7,#bbf7d0);color:#25d366}.recipient-icon.email[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dbeafe,#bfdbfe);color:#3b82f6}.recipient-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:18px;height:18px}.time-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.time-info[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:18px;height:18px;color:#64748b}.template-badge[_ngcontent-%COMP%]{display:inline-block;padding:.375rem .75rem;background:#f0fdf4;color:#16a34a;border-radius:8px;font-size:.875rem;font-weight:500}.sender-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.sender-info[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:18px;height:18px;color:#64748b;flex-shrink:0}.message-section[_ngcontent-%COMP%]{margin-top:.5rem}.message-content[_ngcontent-%COMP%]{background:#f8fafc;border:1px solid #e2e8f0;border-radius:12px;padding:1rem;max-height:400px;overflow-y:auto}.message-text[_ngcontent-%COMP%]{margin:0;font-size:.9375rem;line-height:1.6;color:#1f2937;white-space:pre-wrap;word-wrap:break-word;font-family:inherit}.message-content[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.message-content[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9;border-radius:3px}.message-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px}.message-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}"]})}return i})();function Yt(i,m){if(i&1&&(o(0,"app-badge",13),l(1),a()),i&2){let e=d();r(),S(" ",e.invitationHistory.length," ")}}function Kt(i,m){i&1&&(o(0,"div",14),v(),o(1,"svg",15),g(2,"path",16),a(),M(),o(3,"p",17),l(4,"\u0412\u044B \u0435\u0449\u0451 \u043D\u0438\u043A\u043E\u0433\u043E \u043D\u0435 \u043F\u0440\u0438\u0433\u043B\u0430\u0448\u0430\u043B\u0438"),a()())}function Zt(i,m){if(i&1&&(o(0,"span",35),l(1),a()),i&2){let e=d().$implicit;r(),S(" ",e.templateName," ")}}function Xt(i,m){i&1&&(o(0,"span",36),l(1,"\u2014"),a())}function Jt(i,m){if(i&1){let e=I();o(0,"tr")(1,"td")(2,"div",22),v(),o(3,"svg",23),g(4,"path",24),a(),M(),o(5,"span",25),l(6),a()()(),o(7,"td")(8,"span",26),l(9),a()(),o(10,"td"),f(11,Zt,2,1,"span",27)(12,Xt,2,0,"span",28),a(),o(13,"td")(14,"span",29),l(15),a()(),o(16,"td")(17,"app-badge",30),l(18),a()(),o(19,"td")(20,"div",31)(21,"app-icon-button",32),w("onClick",function(){let n=_(e).$implicit,s=d(2);return b(s.openMessageDetails(n))}),v(),o(22,"svg",23),g(23,"path",33)(24,"circle",34),a()()()()()}if(i&2){let e=m.$implicit,t=d(2);r(6),h(e.clientName||t.formatPhone(e.phone)),r(3),h(t.formatDate(e.createdAt||e.sentAt)),r(2),p("ngIf",e.templateName),r(),p("ngIf",!e.templateName),r(3),h(e.initiatedByUsername||"\u2014"),r(2),p("badgeType",t.getStatusBadgeType(e.status)),r(),S(" ",t.getStatusLabel(e.status)," ")}}function en(i,m){if(i&1&&(o(0,"app-paginated-table-wrapper",18,0)(2,"div",19)(3,"table",20)(4,"thead")(5,"tr")(6,"th"),l(7,"\u041F\u043E\u043B\u0443\u0447\u0430\u0442\u0435\u043B\u044C"),a(),o(8,"th"),l(9,"\u0412\u0440\u0435\u043C\u044F \u043E\u0442\u043F\u0440\u0430\u0432\u043A\u0438"),a(),o(10,"th"),l(11,"\u0428\u0430\u0431\u043B\u043E\u043D"),a(),o(12,"th"),l(13,"\u041E\u0442\u043F\u0440\u0430\u0432\u0438\u043B"),a(),o(14,"th"),l(15,"\u0421\u0442\u0430\u0442\u0443\u0441"),a(),o(16,"th"),l(17,"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u044F"),a()()(),o(18,"tbody"),f(19,Jt,25,7,"tr",21),a()()()()),i&2){let e=G(1),t=d();p("paginationEnabled",!0)("data",t.invitationHistory)("defaultPageSize",15),r(19),p("ngForOf",e.paginatedData)}}var oi=(()=>{class i{fb;store;user$;invitationForm;isSending=!1;successMessage="";errorMessage="";invitationHistory=[];messageTemplates=[];selectedTemplateId=null;showMessageDetailsModal=!1;selectedMessage=null;isLoading=!1;isLoadingTemplates=!1;templateTypes=[];templateVariables=[];whatsappIconSvg;pageHeaderService=W(ze);messageTemplatesService=W(Le);messagesService=W(Ae);toastService=W(ve);defaultMessage=`\u041F\u0440\u0438\u0432\u0435\u0442! \u{1F44B}

\u041F\u0440\u0438\u0433\u043B\u0430\u0448\u0430\u044E \u0442\u0435\u0431\u044F \u043F\u0440\u0438\u0441\u043E\u0435\u0434\u0438\u043D\u0438\u0442\u044C\u0441\u044F \u043A Westwood \u2014 \u044D\u0442\u043E \u043E\u0442\u043B\u0438\u0447\u043D\u0430\u044F \u043F\u043B\u0430\u0442\u0444\u043E\u0440\u043C\u0430 \u0434\u043B\u044F \u0440\u0430\u0437\u0432\u0438\u0442\u0438\u044F.

\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u0443\u0439\u0441\u044F \u043F\u043E \u0441\u0441\u044B\u043B\u043A\u0435:
https://westwood.app/register`;constructor(e,t){this.fb=e,this.store=t,this.user$=this.store.select(be),this.invitationForm=this.fb.group({message:[this.defaultMessage,[xe.required]]}),this.whatsappIconSvg=`
      <svg viewBox="0 0 24 24" fill="none">
        <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347z" fill="currentColor"/>
        <path d="M12 2C6.477 2 2 6.477 2 12c0 1.89.525 3.66 1.438 5.168L2 22l4.832-1.438A9.955 9.955 0 0012 22c5.523 0 10-4.477 10-10S17.523 2 12 2z" fill="currentColor"/>
      </svg>
    `}ngOnInit(){this.pageHeaderService.setPageHeader("WhatsApp \u043A\u043E\u043C\u043C\u0443\u043D\u0438\u043A\u0430\u0446\u0438\u044F",[{label:"\u0413\u043B\u0430\u0432\u043D\u0430\u044F",route:"/home"},{label:"\u041A\u043E\u043C\u043C\u0443\u043D\u0438\u043A\u0430\u0446\u0438\u044F"},{label:"WhatsApp"}]),this.loadHistory(),this.loadTemplates(),this.loadTemplateTypes(),this.loadTemplateVariables()}onSubmit(){if(this.invitationForm.valid){this.isSending=!0,this.errorMessage="",this.successMessage="";let e=this.invitationForm.get("message")?.value||"";setTimeout(()=>{try{let t=this.selectedTemplateId?this.messageTemplates.find(n=>n.id===this.selectedTemplateId):null;this.successMessage="\u0421\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u0435 \u0433\u043E\u0442\u043E\u0432\u043E \u043A \u043E\u0442\u043F\u0440\u0430\u0432\u043A\u0435",this.loadHistory(),this.invitationForm.patchValue({message:this.defaultMessage}),this.selectedTemplateId=null}catch{this.errorMessage="\u041F\u0440\u043E\u0438\u0437\u043E\u0448\u043B\u0430 \u043E\u0448\u0438\u0431\u043A\u0430"}this.isSending=!1},600)}}onTemplateSelected(e){this.selectedTemplateId=e.id}onTemplateCreated(e){let t={id:e.id,name:e.name,type:e.type,content:e.content,createdAt:e.createdAt?.toISOString()};this.messageTemplatesService.createTemplate({name:t.name,type:t.type,content:t.content}).subscribe({next:n=>{let s=this.mapApiTemplateToFrontend(n);this.messageTemplates.push(s),this.toastService.success("\u0428\u0430\u0431\u043B\u043E\u043D \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0441\u043E\u0437\u0434\u0430\u043D")},error:n=>{let s=n.error?.message||"\u041E\u0448\u0438\u0431\u043A\u0430 \u0441\u043E\u0437\u0434\u0430\u043D\u0438\u044F \u0448\u0430\u0431\u043B\u043E\u043D\u0430";this.toastService.error(s)}})}onTemplateUpdated(e){let t={id:e.id,name:e.name,type:e.type,content:e.content};this.messageTemplatesService.updateTemplate(e.id,{name:t.name,type:t.type,content:t.content}).subscribe({next:n=>{let s=this.mapApiTemplateToFrontend(n),c=this.messageTemplates.findIndex(u=>u.id===e.id);c!==-1&&(this.messageTemplates[c]=s),this.toastService.success("\u0428\u0430\u0431\u043B\u043E\u043D \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D")},error:n=>{let s=n.error?.message||"\u041E\u0448\u0438\u0431\u043A\u0430 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u044F \u0448\u0430\u0431\u043B\u043E\u043D\u0430";this.toastService.error(s)}})}onTemplateDeleted(e){this.messageTemplatesService.deleteTemplate(e).subscribe({next:()=>{this.messageTemplates=this.messageTemplates.filter(t=>t.id!==e),this.toastService.success("\u0428\u0430\u0431\u043B\u043E\u043D \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0443\u0434\u0430\u043B\u0435\u043D")},error:t=>{let n=t.error?.message||"\u041E\u0448\u0438\u0431\u043A\u0430 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u044F \u0448\u0430\u0431\u043B\u043E\u043D\u0430";this.toastService.error(n)}})}formatPhone(e){if(!e)return"\u041D\u0435 \u0443\u043A\u0430\u0437\u0430\u043D";let t=e.replace(/[^\d]/g,"");return t.length===11&&t.startsWith("7")?`+7 ${t.slice(1,4)} ${t.slice(4,7)}-${t.slice(7,9)}-${t.slice(9)}`:e}formatDate(e){if(!e)return"\u2014";let t=e instanceof Date?e:new Date(e);if(isNaN(t.getTime()))return"\u2014";let s=new Date().getTime()-t.getTime(),c=Math.floor(s/6e4),u=Math.floor(s/36e5);return c<1?"\u0422\u043E\u043B\u044C\u043A\u043E \u0447\u0442\u043E":c<60?`${c} \u043C\u0438\u043D \u043D\u0430\u0437\u0430\u0434`:u<24?`${u} \u0447 \u043D\u0430\u0437\u0430\u0434`:t.toLocaleDateString("ru-RU",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}getStatusBadgeType(e){switch(e){case"sent":return"success";case"pending":return"warning";case"failed":return"danger";default:return"success"}}getStatusLabel(e){switch(e){case"sent":return"\u041E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u043E";case"pending":return"\u041E\u0436\u0438\u0434\u0430\u0435\u0442";case"failed":return"\u041E\u0448\u0438\u0431\u043A\u0430";default:return e}}getTemplateTypeLabel(e){switch(e){case"bonus_accrued":return"\u041D\u0430\u0447\u0438\u0441\u043B\u0435\u043D\u0438\u0435 \u0431\u043E\u043D\u0443\u0441\u043E\u0432";case"bonus_expiration":return"\u0418\u0441\u0442\u0435\u0447\u0435\u043D\u0438\u0435 \u0431\u043E\u043D\u0443\u0441\u043E\u0432";default:return e}}openMessageDetails(e){this.selectedMessage={id:e.id,type:"whatsapp",recipient:e.clientName||e.phone,message:e.message,sentAt:e.createdAt||e.sentAt,status:e.status,templateName:e.templateName,initiatedByUsername:e.initiatedByUsername},this.showMessageDetailsModal=!0}resendInvitation(e,t){t&&t.stopPropagation(),this.invitationForm.patchValue({message:e.message}),window.scrollTo({top:0,behavior:"smooth"})}loadHistory(){this.isLoading=!0,this.messagesService.getMessagesByChannel("WHATSAPP").subscribe({next:e=>{this.invitationHistory=e.map(t=>this.mapMessageRecordToHistory(t)),this.isLoading=!1},error:e=>{let t=e.error?.message||"\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0438\u0441\u0442\u043E\u0440\u0438\u0438 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u0439";this.toastService.error(t),this.isLoading=!1,this.invitationHistory=[]}})}loadTemplates(){this.isLoadingTemplates=!0,this.messageTemplatesService.getAllTemplates().subscribe({next:e=>{this.messageTemplates=e.map(t=>this.mapApiTemplateToFrontend(t)),this.isLoadingTemplates=!1},error:e=>{let t=e.error?.message||"\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0448\u0430\u0431\u043B\u043E\u043D\u043E\u0432";this.toastService.error(t),this.isLoadingTemplates=!1,this.messageTemplates=[]}})}mapMessageRecordToHistory(e){return{id:e.id,phone:"",clientName:e.clientName,message:e.messageContent,sentAt:e.sentAt?new Date(e.sentAt):new Date,createdAt:e.createdAt?new Date(e.createdAt):void 0,status:this.mapMessageStatus(e.status),templateId:void 0,templateName:void 0,templateType:void 0,type:"whatsapp",initiatedByUsername:e.initiatedByUsername}}mapApiTemplateToFrontend(e){return{id:e.id,name:e.name,type:e.type,content:e.content,createdAt:e.createdAt?new Date(e.createdAt):new Date}}mapMessageStatus(e){let t=e.toLowerCase();return t==="sent"||t==="delivered"?"sent":t==="pending"||t==="sending"?"pending":t==="failed"||t==="error"?"failed":"sent"}loadTemplateTypes(){this.messageTemplatesService.getTemplateTypes().subscribe({next:e=>{this.templateTypes=e},error:e=>{let t=e.error?.message||"\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0442\u0438\u043F\u043E\u0432 \u0448\u0430\u0431\u043B\u043E\u043D\u043E\u0432";this.toastService.error(t),this.templateTypes=[]}})}loadTemplateVariables(){this.messageTemplatesService.getTemplateVariables().subscribe({next:e=>{this.templateVariables=e.map(t=>({name:`{{${t.name}}}`,description:t.description}))},error:e=>{let t=e.error?.message||"\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u044B\u0445 \u0448\u0430\u0431\u043B\u043E\u043D\u043E\u0432";this.toastService.error(t),this.templateVariables=[]}})}static \u0275fac=function(t){return new(t||i)(R(Ie),R(he))};static \u0275cmp=E({type:i,selectors:[["app-invitation-page"]],decls:14,vars:19,consts:[["paginatedTable",""],[1,"invitation-page"],[3,"formSubmit","templateSelected","templateCreated","templateUpdated","templateDeleted","invitationType","form","title","subtitle","iconSvg","iconColor","previewDescription","messageTemplates","isSending","successMessage","errorMessage","hideForm","templateTypes","templateVariables"],[1,"section-block","history-block"],[1,"section-title"],["viewBox","0 0 24 24","fill","none",1,"title-icon"],["d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z","stroke","currentColor","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],[1,"section-heading"],["badgeType","secondary","size","small","class","history-badge",4,"ngIf"],[1,"section-description"],["class","history-empty",4,"ngIf"],[3,"paginationEnabled","data","defaultPageSize",4,"ngIf"],[3,"visibleChange","visible","message"],["badgeType","secondary","size","small",1,"history-badge"],[1,"history-empty"],["viewBox","0 0 24 24","fill","none",1,"empty-icon"],["d","M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z","stroke","currentColor","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],[1,"empty-text"],[3,"paginationEnabled","data","defaultPageSize"],[1,"table-container"],[1,"history-table"],[4,"ngFor","ngForOf"],[1,"recipient-cell"],["viewBox","0 0 24 24","fill","none"],["d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z","stroke","currentColor","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],[1,"recipient-value"],[1,"time-value"],["class","template-name",4,"ngIf"],["class","no-template",4,"ngIf"],[1,"sender-value"],["size","small",3,"badgeType"],[1,"actions-cell"],["iconButtonType","ghost","size","small","tooltip","\u041F\u0440\u043E\u0441\u043C\u043E\u0442\u0440\u0435\u0442\u044C \u0434\u0435\u0442\u0430\u043B\u0438",3,"onClick"],["d","M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z","stroke","currentColor","stroke-width","1.5"],["cx","12","cy","12","r","3","stroke","currentColor","stroke-width","1.5"],[1,"template-name"],[1,"no-template"]],template:function(t,n){t&1&&(o(0,"div",1)(1,"app-invitation-form",2),w("formSubmit",function(){return n.onSubmit()})("templateSelected",function(c){return n.onTemplateSelected(c)})("templateCreated",function(c){return n.onTemplateCreated(c)})("templateUpdated",function(c){return n.onTemplateUpdated(c)})("templateDeleted",function(c){return n.onTemplateDeleted(c)}),a(),o(2,"div",3)(3,"div",4),v(),o(4,"svg",5),g(5,"path",6),a(),M(),o(6,"h3",7),l(7,"\u0418\u0441\u0442\u043E\u0440\u0438\u044F"),a(),f(8,Yt,2,1,"app-badge",8),a(),o(9,"p",9),l(10,"\u0418\u0441\u0442\u043E\u0440\u0438\u044F \u043E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u043D\u044B\u0445 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u0439"),a(),f(11,Kt,5,0,"div",10)(12,en,20,4,"app-paginated-table-wrapper",11),a(),o(13,"app-message-details-modal",12),w("visibleChange",function(c){return n.showMessageDetailsModal=c}),a()()),t&2&&(r(),p("invitationType","whatsapp")("form",n.invitationForm)("title","\u041F\u0440\u0438\u0433\u043B\u0430\u0441\u0438 \u0434\u0440\u0443\u0433\u0430")("subtitle","\u041E\u0442\u043F\u0440\u0430\u0432\u044C \u043F\u0440\u0438\u0433\u043B\u0430\u0448\u0435\u043D\u0438\u0435 \u0447\u0435\u0440\u0435\u0437 WhatsApp")("iconSvg",n.whatsappIconSvg)("iconColor","#25D366")("previewDescription","\u0422\u0430\u043A \u0431\u0443\u0434\u0435\u0442 \u0432\u044B\u0433\u043B\u044F\u0434\u0435\u0442\u044C \u0432\u0430\u0448\u0435 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u0435 \u0432 WhatsApp")("messageTemplates",n.messageTemplates)("isSending",n.isSending)("successMessage",n.successMessage)("errorMessage",n.errorMessage)("hideForm",!0)("templateTypes",n.templateTypes)("templateVariables",n.templateVariables),r(7),p("ngIf",n.invitationHistory.length),r(3),p("ngIf",n.invitationHistory.length===0),r(),p("ngIf",n.invitationHistory.length>0),r(),p("visible",n.showMessageDetailsModal)("message",n.selectedMessage))},dependencies:[O,Z,B,ee,ne,_e,$e,qe,He],styles:["[_nghost-%COMP%]{display:block;height:100%;margin:-2rem}.invitation-page[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem;min-height:calc(100vh - 64px - 4rem);padding:2rem;background:linear-gradient(180deg,#f0fdf4,#f8fafc 50% 100%)}.section-block[_ngcontent-%COMP%]{background:#fff;border-radius:24px;padding:1.5rem;box-shadow:0 1px 3px #0000000d}.section-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.625rem;margin-bottom:.25rem}.title-icon[_ngcontent-%COMP%]{width:22px;height:22px;color:#25d366}.section-heading[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:#1f2937;margin:0}.section-description[_ngcontent-%COMP%]{font-size:.875rem;color:#9ca3af;margin:0 0 1.25rem}.history-badge[_ngcontent-%COMP%]{margin-left:auto}.history-empty[_ngcontent-%COMP%]{text-align:center;padding:2.5rem 1rem}.empty-icon[_ngcontent-%COMP%]{width:56px;height:56px;color:#d1d5db;margin:0 auto 1rem;display:block}.empty-text[_ngcontent-%COMP%]{font-size:.875rem;color:#9ca3af;margin:0}.table-container[_ngcontent-%COMP%]{background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 1px 3px #0000000d}.history-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.history-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:#f8fafc}.history-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:1rem 1.5rem;text-align:left;font-size:.875rem;font-weight:600;color:#64748b;border-bottom:1px solid #e2e8f0}.history-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem 1.5rem;border-bottom:1px solid #f1f5f9}.history-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#f8fafc}.history-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:none}.recipient-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.recipient-cell[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px;color:#16a34a;flex-shrink:0}.recipient-value[_ngcontent-%COMP%]{font-size:.9375rem;font-weight:600;color:#1f2937}.time-value[_ngcontent-%COMP%]{font-size:.875rem;color:#64748b}.template-type-badge[_ngcontent-%COMP%]{display:inline-block;padding:.375rem .75rem;background:#f0fdf4;color:#16a34a;border-radius:8px;font-size:.875rem;font-weight:500}.template-name[_ngcontent-%COMP%]{font-size:.875rem;color:#475569;font-weight:500}.no-template[_ngcontent-%COMP%]{font-size:.875rem;color:#94a3b8;font-style:italic}.sender-value[_ngcontent-%COMP%]{font-size:.875rem;color:#475569;font-weight:500}.actions-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}@media (max-width: 768px){[_nghost-%COMP%]{margin:-1rem}.invitation-page[_ngcontent-%COMP%]{padding:1rem}}"]})}return i})();export{oi as InvitationPageComponent};
